<!DOCTYPE html>
<html lang="en" class="scroll-smooth transition-all max-h-screen">
  <head><meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, minimum-scale=1"
/>
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, maximum-scale=5"
/>
<meta name="author" content="Aditya Bagus Pratama" />
     


<title>Olist Churn Prediction</title>
<meta name="description" content="Customer Churn Prediction using Random Forest" />
<meta name="keywords" content='blog, ideal, hugo' />
<meta property="og:url" content="https://bytadit.me/projects/olist-churn-prediction/" />
<meta property="og:type" content="website" />
<meta property="og:title" content="Olist Churn Prediction" />
<meta property="og:description" content="Customer Churn Prediction using Random Forest" />
<meta property="og:image" content="/images/profile.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Olist Churn Prediction" />
<meta name="twitter:description" content="Customer Churn Prediction using Random Forest" />
<meta property="twitter:domain" content="https://bytadit.me/projects/olist-churn-prediction/" />
<meta property="twitter:url" content="https://bytadit.me/projects/olist-churn-prediction/" />
<meta name="twitter:image" content="/images/profile.png" />
<meta itemprop="name" content="Olist Churn Prediction">
<meta itemprop="description" content="Customer Churn Prediction using Random Forest"><meta itemprop="datePublished" content="2023-01-03T15:14:07+07:00" />
<meta itemprop="dateModified" content="2023-01-03T15:14:07+07:00" />
<meta itemprop="wordCount" content="23036">
<meta itemprop="keywords" content="" /> <meta property="og:title" content="Olist Churn Prediction" />
<meta property="og:description" content="Customer Churn Prediction using Random Forest" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bytadit.me/projects/olist-churn-prediction/" /><meta property="article:section" content="projects" />
<meta property="article:published_time" content="2023-01-03T15:14:07+07:00" />
<meta property="article:modified_time" content="2023-01-03T15:14:07+07:00" />
 <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Olist Churn Prediction"/>
<meta name="twitter:description" content="Customer Churn Prediction using Random Forest"/>

<link rel="canonical" href="https://bytadit.me/projects/olist-churn-prediction/" />



<link rel="icon" href="https://bytadit.me//img/logo.svg" />


<link
  rel="stylesheet"
  href="https://unpkg.com/flowbite@1.4.7/dist/flowbite.min.css"
/>
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
/>
  
<link
  rel="stylesheet"
  href="/css/output.min.52ce0dce96bfe36d1cb1ce10d30dd17702071931c95ef6bf0a861b541442ce88.css"
  integrity="sha256-Us4Nzpa/420csc4Q0w3RdwIHGTHJXva/CoYbVBRCzog="
/>


<script>
  
  if (
    localStorage.getItem("color-theme") === "dark" ||
    (!("color-theme" in localStorage) &&
      window.matchMedia("(prefers-color-scheme: dark)").matches)
  ) {
    document.documentElement.classList.add("dark");
  } else {
    document.documentElement.classList.remove("dark");
  }
</script>
<script src="https://www.google.com/recaptcha/api.js" async defer></script>


     <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.css" integrity="sha384-6LkG2wmY8FK9E0vU9OOr8UvLwsaqUg9SETfpq4uTCN1agNe8HRdE9ABlk+fVx6gZ" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.js" integrity="sha384-31El76TwmbHj4rF9DyLsygbq6xoIobG0W+jqXim+a3dU9W53tdH3A/ngRPxOzzaB" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
   
</head>
  <body class="dark:bg-stone-800 bg-white"><section
  class="sticky top-0 navigation bg-gray-100 border-b-2 border-gray-200 dark:border-neutral-800 dark:bg-stone-900 sm:py-1.5 z-10"
>
  <nav
    class="bg-gray-100 px-2 sm:px-4 py-1.5 dark:bg-stone-900 md:mx-12 lg:mx-24 transition-all"
    id="navbar"
  >
    <div
      class="container mx-auto md:px-6 flex flex-wrap items-center justify-between"
      id="nav-container"
    >
      
      <a href="https://bytadit.me/" class="flex md:hidden">
        <img class="h-8" src="/images/byt-logo-yell.svg" alt="site-logo" />

        <span
          class="self-center text-lg font-semibold whitespace-nowrap dark:text-white"
          >Bytadit</span
        >
      </a>
      
      <div class="flex md:order-3 px-5">
        
        <button
          id="theme-toggle"
          type="button"
          class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-stone-800 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-stone-800 rounded-full text-sm p-2.5 ml-3"
        >
          <svg
            id="theme-toggle-dark-icon"
            class="w-5 h-5 hidden"
            fill="currentColor"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
            ></path>
          </svg>
          <svg
            id="theme-toggle-light-icon"
            class="w-5 h-5 hidden"
            fill="currentColor"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
              fill-rule="evenodd"
              clip-rule="evenodd"
            ></path>
          </svg>
        </button>

        
        <button
          data-collapse-toggle="mobile-menu-4"
          type="button"
          class="md:hidden text-gray-500 hover:bg-gray-100focus:outline-none focus:ring-2 focus:ring-gray-200 rounded-full text-sm p-2 ml-3 inline-flex items-center dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-stone-800"
          aria-controls="mobile-menu-4"
          aria-expanded="false"
        >
          <span class="sr-only">Open main menu</span>
          <svg
            class="w-6 h-6"
            fill="currentColor"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
              clip-rule="evenodd"
            ></path>
          </svg>
          <svg
            class="hidden w-6 h-6"
            fill="currentColor"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
              clip-rule="evenodd"
            ></path>
          </svg>
        </button>
      </div>
      
      <div
        class="hidden md:flex items-center w-full md:w-auto md:order-2"
        id="mobile-menu-4"
      >
        
        <ul
          class="navbar-nav flex-col md:flex-row flex md:space-x-8 my-4 sm:mb-0 sm:mt-4 md:mt-0 md:text-md md:font-medium"
        >
          
          <li class="list">
            <a
              href="/#home"
              class="text-gray-800 hover:bg-gray-50 border-b border-gray-100 md:hover:bg-transparent md:border-0 block pl-3 pr-4 py-2 md:hover:underline md:hover:decoration-yellow-300 md:hover:decoration-4 md:p-0 md:dark:hover:text-white dark:text-gray-100 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700"
              > Home </a
            >
          </li>
          
          <li class="list">
            <a
              href="/projects/"
              class="text-gray-800 hover:bg-gray-50 border-b border-gray-100 md:hover:bg-transparent md:border-0 block pl-3 pr-4 py-2 md:hover:underline md:hover:decoration-yellow-300 md:hover:decoration-4 md:p-0 md:dark:hover:text-white dark:text-gray-100 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700"
              > Projects </a
            >
          </li>
          
          <li class="list">
            <a
              href="/posts/"
              class="text-gray-800 hover:bg-gray-50 border-b border-gray-100 md:hover:bg-transparent md:border-0 block pl-3 pr-4 py-2 md:hover:underline md:hover:decoration-yellow-300 md:hover:decoration-4 md:p-0 md:dark:hover:text-white dark:text-gray-100 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700"
              > Posts </a
            >
          </li>
          
          <li class="list">
            <a
              href="/#contact"
              class="text-gray-800 hover:bg-gray-50 border-b border-gray-100 md:hover:bg-transparent md:border-0 block pl-3 pr-4 py-2 md:hover:underline md:hover:decoration-yellow-300 md:hover:decoration-4 md:p-0 md:dark:hover:text-white dark:text-gray-100 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700"
              > Contact </a
            >
          </li>
          
          <li class="list">
            <a
              href="/about"
              class="text-gray-800 hover:bg-gray-50 border-b border-gray-100 md:hover:bg-transparent md:border-0 block pl-3 pr-4 py-2 md:hover:underline md:hover:decoration-yellow-300 md:hover:decoration-4 md:p-0 md:dark:hover:text-white dark:text-gray-100 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700"
              > About </a
            >
          </li>
          
        </ul>
      </div>
      
      <div
        class="hidden md:flex justify-between items-center w-full md:w-auto md:order-1"
        id="mobile-menu-4"
      >
        
        <a href="https://bytadit.me/" class="hidden md:flex mr-10">
          <img class="h-8" src="/images/byt-logo-yell.svg" alt="site-logo" />
          <span
            class="self-center text-lg font-semibold whitespace-nowrap dark:text-white"
            >Bytadit</span
          >
        </a>
      </div>
    </div>
  </nav>
</section>

    <main class="flex-1 mx-4">  <div class="p-2 mt-4 mb-8 md:mx-20 md:px-32 lg:px-40 lg:mx-28">
  <article
    class="relative prose max-w-none m-0 prose-slate dark:prose-invert prose-headings:font-sans prose-headings:tracking-tight prose-p:font-sans prose-ol:font-sans prose-ul:font-sans prose-pre:dark:border prose-pre:dark:border-slate-700"
  >
    <header class="not-prose my-8 lg:my-20">
      
      <h1
        class="text-center text-3xl md:text-4xl lg:text-5xl font-black mt-8 lg:mt-14 mb-6 lg leading-tight tracking-tight"
      >
        Olist Churn Prediction
      </h1>
      <div
        class="container mx-auto mb-2 flex flex-wrap items-center justify-center"
      >
        <div class="mb-4 mr-2 flex items-center justify-center gap-2 text-base">
          <span> by </span>
        </div>
        <div class="mb-4 mr-2 flex items-center justify-center gap-2 text-base">
          Aditya Bagus Pratama
        </div>
        <div class="mb-4 mr-2 flex items-center justify-center gap-2 text-base">
          <span> at </span>
        </div>
        <div class="mb-4 mr-2 flex items-center justify-center gap-2 text-base">
          <div class="flex items-center gap-2 text-base">
            3 January 2023
          </div>
        </div>
      </div>
    </header>
    
    <figure class="not-prose mb-2">
      
    </figure>
    <div class="leading-8 tracking-wide dark:prose-invert text-justify">
      <h1 id="customer-segmentation-and-churn-prediction">Customer Segmentation and Churn Prediction</h1>
<h3 id="by-aditya-bagus-pratama-ds03003">by Aditya Bagus Pratama (DS03003)</h3>
<h2 id="business-understanding">Business Understanding</h2>
<h3 id="problem">Problem</h3>
<p>Olist adalah department store terbesar di Brasil. Olist menghubungkan pedagang dan pelaku bisnis kecil (UMKM) dari seluruh Brasil ke pelanggan, sehingga pedagang tersebut dapat menjual produk mereka melalui Toko Olist dan mengirimkannya ke pelanggan melalui mitra logistik Olist. <br>
Berdasarkan data order pada tahun 2016-2018, Olist ingin mengetahui segmentasi pelanggan dan bagaimana pelanggan bisa dikelompokkan. Olist juga ingin mengetahui bagaimana probabilitas churn dari pelanggan. Olist perlu tahu hal ini, untuk menentukan strategi treatment customer yang tepat terutama untuk customer yang berpotensi churn, dikarenakan biaya yang dikeluarkan untuk menarik pelanggan baru, 5X lebih besar daripada biaya untuk mempertahankan pelanggan tetap.
<img src="https://baremetrics-wordpress.imgix.net/20180124053408/photo2.png" alt="acquisition-vs-retention-cost"></p>
<h3 id="goal">Goal</h3>
<ul>
<li>Mengidentifikasi segmen pelanggan berdasarkan nilai Resensi, Frequency, dan Monetary.</li>
<li>Memprediksi probabilitas churn pelanggan, sehingga Olist bisa memnentukan treatment dan strategi yang tepat untuk mempertahankan pelanggan tetap.</li>
</ul>
<h3 id="objectives">Objectives</h3>
<p>Membuat model machine learning untuk memprediksi dan mengklasifikasikan apakah pelanggan berpotensi churn atau tidak, serta melakukan segmentasi pelanggan dengan RFM Analysis dan Clustering dengan K-Means untuk mengelompokkan pelanggan berdasarkan karakteristik tertentu.</p>
<h2 id="data-requirement">Data Requirement</h2>
<p><a href="https://www.kaggle.com/datasets/olistbr/brazilian-ecommerce">Ollist Brazilian Ecommerce 2016-2018 Dataset</a></p>
<h2 id="data-understanding">Data Understanding</h2>
<h3 id="importing-libraries">Importing Libraries</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span> pip install matplotlib <span style="color:#f92672">--</span>upgrade
</span></span></code></pre></div><pre><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (3.5.3)
Requirement already satisfied: numpy&gt;=1.17 in /usr/local/lib/python3.7/dist-packages (from matplotlib) (1.21.6)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.7/dist-packages (from matplotlib) (7.1.2)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib) (1.4.4)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib) (0.11.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.7/dist-packages (from matplotlib) (4.38.0)
Requirement already satisfied: python-dateutil&gt;=2.7 in /usr/local/lib/python3.7/dist-packages (from matplotlib) (2.8.2)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.7/dist-packages (from matplotlib) (21.3)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib) (3.0.9)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from kiwisolver&gt;=1.0.1-&gt;matplotlib) (4.1.1)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.7-&gt;matplotlib) (1.15.0)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib 
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;matplotlib: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(matplotlib<span style="color:#f92672">.</span>__version__))
</span></span></code></pre></div><pre><code>matplotlib: 3.5.3
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span> pip install yellowbrick <span style="color:#f92672">--</span>user
</span></span></code></pre></div><pre><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: yellowbrick in /usr/local/lib/python3.7/dist-packages (1.5)
Requirement already satisfied: numpy&gt;=1.16.0 in /usr/local/lib/python3.7/dist-packages (from yellowbrick) (1.21.6)
Requirement already satisfied: matplotlib!=3.0.0,&gt;=2.0.2 in /usr/local/lib/python3.7/dist-packages (from yellowbrick) (3.5.3)
Requirement already satisfied: scipy&gt;=1.0.0 in /usr/local/lib/python3.7/dist-packages (from yellowbrick) (1.7.3)
Requirement already satisfied: scikit-learn&gt;=1.0.0 in /usr/local/lib/python3.7/dist-packages (from yellowbrick) (1.0.2)
Requirement already satisfied: cycler&gt;=0.10.0 in /usr/local/lib/python3.7/dist-packages (from yellowbrick) (0.11.0)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib!=3.0.0,&gt;=2.0.2-&gt;yellowbrick) (3.0.9)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.7/dist-packages (from matplotlib!=3.0.0,&gt;=2.0.2-&gt;yellowbrick) (21.3)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.7/dist-packages (from matplotlib!=3.0.0,&gt;=2.0.2-&gt;yellowbrick) (4.38.0)
Requirement already satisfied: python-dateutil&gt;=2.7 in /usr/local/lib/python3.7/dist-packages (from matplotlib!=3.0.0,&gt;=2.0.2-&gt;yellowbrick) (2.8.2)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.7/dist-packages (from matplotlib!=3.0.0,&gt;=2.0.2-&gt;yellowbrick) (7.1.2)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib!=3.0.0,&gt;=2.0.2-&gt;yellowbrick) (1.4.4)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from kiwisolver&gt;=1.0.1-&gt;matplotlib!=3.0.0,&gt;=2.0.2-&gt;yellowbrick) (4.1.1)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.7-&gt;matplotlib!=3.0.0,&gt;=2.0.2-&gt;yellowbrick) (1.15.0)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&gt;=1.0.0-&gt;yellowbrick) (1.2.0)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&gt;=1.0.0-&gt;yellowbrick) (3.1.0)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>pip install lifelines
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> lifelines
</span></span></code></pre></div><pre><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting lifelines
  Downloading lifelines-0.27.3-py3-none-any.whl (349 kB)
[K     |████████████████████████████████| 349 kB 36.5 MB/s 
[?25hRequirement already satisfied: numpy&gt;=1.14.0 in /usr/local/lib/python3.7/dist-packages (from lifelines) (1.21.6)
Collecting formulaic&gt;=0.2.2
  Downloading formulaic-0.5.2-py3-none-any.whl (77 kB)
[K     |████████████████████████████████| 77 kB 7.0 MB/s 
[?25hRequirement already satisfied: matplotlib&gt;=3.0 in /usr/local/lib/python3.7/dist-packages (from lifelines) (3.5.3)
Requirement already satisfied: pandas&gt;=1.0.0 in /usr/local/lib/python3.7/dist-packages (from lifelines) (1.3.5)
Requirement already satisfied: scipy&gt;=1.2.0 in /usr/local/lib/python3.7/dist-packages (from lifelines) (1.7.3)
Collecting autograd-gamma&gt;=0.3
  Downloading autograd-gamma-0.5.0.tar.gz (4.0 kB)
Requirement already satisfied: autograd&gt;=1.3 in /usr/local/lib/python3.7/dist-packages (from lifelines) (1.5)
Requirement already satisfied: future&gt;=0.15.2 in /usr/local/lib/python3.7/dist-packages (from autograd&gt;=1.3-&gt;lifelines) (0.16.0)
Requirement already satisfied: cached-property&gt;=1.3.0 in /usr/local/lib/python3.7/dist-packages (from formulaic&gt;=0.2.2-&gt;lifelines) (1.5.2)
Collecting interface-meta&gt;=1.2.0
  Downloading interface_meta-1.3.0-py3-none-any.whl (14 kB)
Requirement already satisfied: astor&gt;=0.8 in /usr/local/lib/python3.7/dist-packages (from formulaic&gt;=0.2.2-&gt;lifelines) (0.8.1)
Requirement already satisfied: wrapt&gt;=1.0 in /usr/local/lib/python3.7/dist-packages (from formulaic&gt;=0.2.2-&gt;lifelines) (1.14.1)
Collecting typing-extensions&gt;=4.2.0
  Downloading typing_extensions-4.4.0-py3-none-any.whl (26 kB)
Collecting graphlib-backport&gt;=1.0.0
  Downloading graphlib_backport-1.0.3-py3-none-any.whl (5.1 kB)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.0-&gt;lifelines) (1.4.4)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.0-&gt;lifelines) (4.38.0)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.0-&gt;lifelines) (7.1.2)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.0-&gt;lifelines) (21.3)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.0-&gt;lifelines) (3.0.9)
Requirement already satisfied: python-dateutil&gt;=2.7 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.0-&gt;lifelines) (2.8.2)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.0-&gt;lifelines) (0.11.0)
Requirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=1.0.0-&gt;lifelines) (2022.5)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.7-&gt;matplotlib&gt;=3.0-&gt;lifelines) (1.15.0)
Building wheels for collected packages: autograd-gamma
  Building wheel for autograd-gamma (setup.py) ... [?25l[?25hdone
  Created wheel for autograd-gamma: filename=autograd_gamma-0.5.0-py3-none-any.whl size=4048 sha256=5e1e2703587e194e2af9fde8e3365f73f4ada035dc2c6bf2c8d61872cbc7810f
  Stored in directory: /root/.cache/pip/wheels/9f/01/ee/1331593abb5725ff7d8c1333aee93a50a1c29d6ddda9665c9f
Successfully built autograd-gamma
Installing collected packages: typing-extensions, interface-meta, graphlib-backport, formulaic, autograd-gamma, lifelines
  Attempting uninstall: typing-extensions
    Found existing installation: typing-extensions 4.1.1
    Uninstalling typing-extensions-4.1.1:
      Successfully uninstalled typing-extensions-4.1.1
[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
thinc 8.1.5 requires typing-extensions&lt;4.2.0,&gt;=3.7.4.1; python_version &lt; &quot;3.8&quot;, but you have typing-extensions 4.4.0 which is incompatible.
spacy 3.4.2 requires typing-extensions&lt;4.2.0,&gt;=3.7.4; python_version &lt; &quot;3.8&quot;, but you have typing-extensions 4.4.0 which is incompatible.
confection 0.0.3 requires typing-extensions&lt;4.2.0,&gt;=3.7.4.1; python_version &lt; &quot;3.8&quot;, but you have typing-extensions 4.4.0 which is incompatible.[0m
Successfully installed autograd-gamma-0.5.0 formulaic-0.5.2 graphlib-backport-1.0.3 interface-meta-1.3.0 lifelines-0.27.3 typing-extensions-4.4.0
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span> pip install lifetimes
</span></span></code></pre></div><pre><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting lifetimes
  Downloading Lifetimes-0.11.3-py3-none-any.whl (584 kB)
[K     |████████████████████████████████| 584 kB 18.1 MB/s 
[?25hRequirement already satisfied: dill&gt;=0.2.6 in /usr/local/lib/python3.7/dist-packages (from lifetimes) (0.3.6)
Requirement already satisfied: pandas&gt;=0.24.0 in /usr/local/lib/python3.7/dist-packages (from lifetimes) (1.3.5)
Requirement already satisfied: scipy&gt;=1.0.0 in /usr/local/lib/python3.7/dist-packages (from lifetimes) (1.7.3)
Requirement already satisfied: autograd&gt;=1.2.0 in /usr/local/lib/python3.7/dist-packages (from lifetimes) (1.5)
Requirement already satisfied: numpy&gt;=1.10.0 in /usr/local/lib/python3.7/dist-packages (from lifetimes) (1.21.6)
Requirement already satisfied: future&gt;=0.15.2 in /usr/local/lib/python3.7/dist-packages (from autograd&gt;=1.2.0-&gt;lifetimes) (0.16.0)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=0.24.0-&gt;lifetimes) (2.8.2)
Requirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=0.24.0-&gt;lifetimes) (2022.5)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.7.3-&gt;pandas&gt;=0.24.0-&gt;lifetimes) (1.15.0)
Installing collected packages: lifetimes
Successfully installed lifetimes-0.11.3
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span> pip install eli5
</span></span></code></pre></div><pre><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting eli5
  Downloading eli5-0.13.0.tar.gz (216 kB)
[K     |████████████████████████████████| 216 kB 42.8 MB/s 
[?25hRequirement already satisfied: attrs&gt;17.1.0 in /usr/local/lib/python3.7/dist-packages (from eli5) (22.1.0)
Collecting jinja2&gt;=3.0.0
  Downloading Jinja2-3.1.2-py3-none-any.whl (133 kB)
[K     |████████████████████████████████| 133 kB 97.6 MB/s 
[?25hRequirement already satisfied: numpy&gt;=1.9.0 in /usr/local/lib/python3.7/dist-packages (from eli5) (1.21.6)
Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from eli5) (1.7.3)
Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from eli5) (1.15.0)
Requirement already satisfied: scikit-learn&gt;=0.20 in /usr/local/lib/python3.7/dist-packages (from eli5) (1.0.2)
Requirement already satisfied: graphviz in /usr/local/lib/python3.7/dist-packages (from eli5) (0.10.1)
Requirement already satisfied: tabulate&gt;=0.7.7 in /usr/local/lib/python3.7/dist-packages (from eli5) (0.8.10)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /usr/local/lib/python3.7/dist-packages (from jinja2&gt;=3.0.0-&gt;eli5) (2.0.1)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&gt;=0.20-&gt;eli5) (3.1.0)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&gt;=0.20-&gt;eli5) (1.2.0)
Building wheels for collected packages: eli5
  Building wheel for eli5 (setup.py) ... [?25l[?25hdone
  Created wheel for eli5: filename=eli5-0.13.0-py2.py3-none-any.whl size=107748 sha256=5a319d3183bd06641079541623ad8af09ac176effe73c7c018f9759265e53b21
  Stored in directory: /root/.cache/pip/wheels/cc/3c/96/3ead31a8e6c20fc0f1a707fde2e05d49a80b1b4b30096573be
Successfully built eli5
Installing collected packages: jinja2, eli5
  Attempting uninstall: jinja2
    Found existing installation: Jinja2 2.11.3
    Uninstalling Jinja2-2.11.3:
      Successfully uninstalled Jinja2-2.11.3
[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
spacy 3.4.2 requires typing-extensions&lt;4.2.0,&gt;=3.7.4; python_version &lt; &quot;3.8&quot;, but you have typing-extensions 4.4.0 which is incompatible.
flask 1.1.4 requires Jinja2&lt;3.0,&gt;=2.10.1, but you have jinja2 3.1.2 which is incompatible.[0m
Successfully installed eli5-0.13.0 jinja2-3.1.2
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span> pip install category_encoders
</span></span></code></pre></div><pre><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting category_encoders
  Downloading category_encoders-2.5.1.post0-py2.py3-none-any.whl (72 kB)
[K     |████████████████████████████████| 72 kB 916 kB/s 
[?25hRequirement already satisfied: numpy&gt;=1.14.0 in /usr/local/lib/python3.7/dist-packages (from category_encoders) (1.21.6)
Requirement already satisfied: statsmodels&gt;=0.9.0 in /usr/local/lib/python3.7/dist-packages (from category_encoders) (0.12.2)
Requirement already satisfied: scikit-learn&gt;=0.20.0 in /usr/local/lib/python3.7/dist-packages (from category_encoders) (1.0.2)
Requirement already satisfied: pandas&gt;=1.0.5 in /usr/local/lib/python3.7/dist-packages (from category_encoders) (1.3.5)
Requirement already satisfied: patsy&gt;=0.5.1 in /usr/local/lib/python3.7/dist-packages (from category_encoders) (0.5.3)
Requirement already satisfied: scipy&gt;=1.0.0 in /usr/local/lib/python3.7/dist-packages (from category_encoders) (1.7.3)
Requirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=1.0.5-&gt;category_encoders) (2022.5)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas&gt;=1.0.5-&gt;category_encoders) (2.8.2)
Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from patsy&gt;=0.5.1-&gt;category_encoders) (1.15.0)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&gt;=0.20.0-&gt;category_encoders) (1.2.0)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&gt;=0.20.0-&gt;category_encoders) (3.1.0)
Installing collected packages: category-encoders
Successfully installed category-encoders-2.5.1.post0
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span> pip install imblearn
</span></span></code></pre></div><pre><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: imblearn in /usr/local/lib/python3.7/dist-packages (0.0)
Requirement already satisfied: imbalanced-learn in /usr/local/lib/python3.7/dist-packages (from imblearn) (0.8.1)
Requirement already satisfied: numpy&gt;=1.13.3 in /usr/local/lib/python3.7/dist-packages (from imbalanced-learn-&gt;imblearn) (1.21.6)
Requirement already satisfied: scikit-learn&gt;=0.24 in /usr/local/lib/python3.7/dist-packages (from imbalanced-learn-&gt;imblearn) (1.0.2)
Requirement already satisfied: scipy&gt;=0.19.1 in /usr/local/lib/python3.7/dist-packages (from imbalanced-learn-&gt;imblearn) (1.7.3)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from imbalanced-learn-&gt;imblearn) (1.2.0)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&gt;=0.24-&gt;imbalanced-learn-&gt;imblearn) (3.1.0)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pip install kneed
</span></span></code></pre></div><pre><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting kneed
  Downloading kneed-0.8.1-py2.py3-none-any.whl (10 kB)
Requirement already satisfied: numpy&gt;=1.14.2 in /usr/local/lib/python3.7/dist-packages (from kneed) (1.21.6)
Requirement already satisfied: scipy&gt;=1.0.0 in /usr/local/lib/python3.7/dist-packages (from kneed) (1.7.3)
Installing collected packages: kneed
Successfully installed kneed-0.8.1
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>pip install squarify
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> squarify
</span></span></code></pre></div><pre><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting squarify
  Downloading squarify-0.4.3-py3-none-any.whl (4.3 kB)
Installing collected packages: squarify
Successfully installed squarify-0.4.3
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> lightgbm <span style="color:#66d9ef">as</span> lgb
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> scipy.stats <span style="color:#66d9ef">as</span> ss
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> statsmodels.api <span style="color:#66d9ef">as</span> sm
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> datetime <span style="color:#66d9ef">as</span> dt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> eli5
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.image <span style="color:#66d9ef">as</span> mpimg
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> warnings
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>set()
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> datetime, date
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy <span style="color:#f92672">import</span> stats
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.cluster <span style="color:#f92672">import</span> KMeans
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> StandardScaler
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> classification_report
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> GridSearchCV
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> RandomizedSearchCV
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> KFold
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> metrics
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> eli5.sklearn <span style="color:#f92672">import</span> PermutationImportance
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.tree <span style="color:#f92672">import</span> DecisionTreeClassifier
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.decomposition <span style="color:#f92672">import</span> PCA
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestClassifier
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> ensemble
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> xgboost <span style="color:#f92672">import</span> XGBClassifier
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.cluster <span style="color:#f92672">import</span> KMeans
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> yellowbrick.cluster <span style="color:#f92672">import</span> KElbowVisualizer
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn. metrics <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> imblearn.datasets <span style="color:#f92672">import</span> make_imbalance
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> statsmodels.tsa.seasonal <span style="color:#f92672">import</span> seasonal_decompose
</span></span><span style="display:flex;"><span>warnings<span style="color:#f92672">.</span>filterwarnings(<span style="color:#e6db74">&#34;ignore&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>set_option(<span style="color:#e6db74">&#39;display.max_columns&#39;</span>, <span style="color:#66d9ef">None</span>)
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>set_option(<span style="color:#e6db74">&#39;display.max_rows&#39;</span>, <span style="color:#ae81ff">50</span>)
</span></span></code></pre></div><h3 id="importing-data">Importing Data</h3>
<p>Persiapkan api kaggle yang didapat dari akun masing-masing</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span> pip install kaggle
</span></span></code></pre></div><pre><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: kaggle in /usr/local/lib/python3.7/dist-packages (1.5.12)
Requirement already satisfied: python-dateutil in /usr/local/lib/python3.7/dist-packages (from kaggle) (2.8.2)
Requirement already satisfied: certifi in /usr/local/lib/python3.7/dist-packages (from kaggle) (2022.9.24)
Requirement already satisfied: six&gt;=1.10 in /usr/local/lib/python3.7/dist-packages (from kaggle) (1.15.0)
Requirement already satisfied: tqdm in /usr/local/lib/python3.7/dist-packages (from kaggle) (4.64.1)
Requirement already satisfied: urllib3 in /usr/local/lib/python3.7/dist-packages (from kaggle) (1.24.3)
Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from kaggle) (2.23.0)
Requirement already satisfied: python-slugify in /usr/local/lib/python3.7/dist-packages (from kaggle) (6.1.2)
Requirement already satisfied: text-unidecode&gt;=1.3 in /usr/local/lib/python3.7/dist-packages (from python-slugify-&gt;kaggle) (1.3)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;kaggle) (2.10)
Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;kaggle) (3.0.4)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span> mkdir <span style="color:#f92672">~/.</span>kaggle
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span> cp kaggle<span style="color:#f92672">.</span>json <span style="color:#f92672">~/.</span>kaggle<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span> chmod <span style="color:#ae81ff">600</span> <span style="color:#f92672">~/.</span>kaggle<span style="color:#f92672">/</span>kaggle<span style="color:#f92672">.</span>json
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span> kaggle datasets download olistbr<span style="color:#f92672">/</span>brazilian<span style="color:#f92672">-</span>ecommerce<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span> unzip <span style="color:#f92672">/</span>content<span style="color:#f92672">/</span>brazilian<span style="color:#f92672">-</span>ecommerce<span style="color:#f92672">.</span>zip
</span></span></code></pre></div><pre><code>Downloading brazilian-ecommerce.zip to /content
 59% 25.0M/42.6M [00:00&lt;00:00, 135MB/s] 
100% 42.6M/42.6M [00:00&lt;00:00, 157MB/s]
Archive:  /content/brazilian-ecommerce.zip
  inflating: olist_customers_dataset.csv  
  inflating: olist_geolocation_dataset.csv  
  inflating: olist_order_items_dataset.csv  
  inflating: olist_order_payments_dataset.csv  
  inflating: olist_order_reviews_dataset.csv  
  inflating: olist_orders_dataset.csv  
  inflating: olist_products_dataset.csv  
  inflating: olist_sellers_dataset.csv  
  inflating: product_category_name_translation.csv  
</code></pre>
<p>buat variable untuk masing-masing data csv</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>raw_path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/content/&#39;</span>
</span></span><span style="display:flex;"><span>customers <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(raw_path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;olist_customers_dataset.csv&#39;</span>)
</span></span><span style="display:flex;"><span>geolocations <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(raw_path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;olist_geolocation_dataset.csv&#39;</span>)
</span></span><span style="display:flex;"><span>orders <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(raw_path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;olist_orders_dataset.csv&#39;</span>)
</span></span><span style="display:flex;"><span>order_items <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(raw_path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;olist_order_items_dataset.csv&#39;</span>)
</span></span><span style="display:flex;"><span>order_payments <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(raw_path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;olist_order_payments_dataset.csv&#39;</span>)
</span></span><span style="display:flex;"><span>order_reviews <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(raw_path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;olist_order_reviews_dataset.csv&#39;</span>)
</span></span><span style="display:flex;"><span>products <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(raw_path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;olist_products_dataset.csv&#39;</span>)
</span></span><span style="display:flex;"><span>sellers <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(raw_path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;olist_sellers_dataset.csv&#39;</span>)
</span></span><span style="display:flex;"><span>translate <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(raw_path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;product_category_name_translation.csv&#39;</span>)
</span></span></code></pre></div><h3 id="data-schema">Data Schema</h3>
<p>Data secara keseluruhan terbagi menjadi beberapa file csv, untuk memudahkan pemahaman dan organisasi data. Silakan lihat skema data berikut ini:</p>
<p><img src="https://i.imgur.com/HRhd2Y0.png" alt=""></p>
<p>Membuat function resumetable untuk memudahkan dalam memahami table</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">resumetable</span>(df):
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Dataset Shape: </span><span style="color:#e6db74">{</span>df<span style="color:#f92672">.</span>shape<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    summary <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(df<span style="color:#f92672">.</span>dtypes,columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;dtypes&#39;</span>])
</span></span><span style="display:flex;"><span>    summary <span style="color:#f92672">=</span> summary<span style="color:#f92672">.</span>reset_index()
</span></span><span style="display:flex;"><span>    summary[<span style="color:#e6db74">&#39;Name&#39;</span>] <span style="color:#f92672">=</span> summary[<span style="color:#e6db74">&#39;index&#39;</span>]
</span></span><span style="display:flex;"><span>    summary <span style="color:#f92672">=</span> summary[[<span style="color:#e6db74">&#39;Name&#39;</span>,<span style="color:#e6db74">&#39;dtypes&#39;</span>]]
</span></span><span style="display:flex;"><span>    summary[<span style="color:#e6db74">&#39;Missing&#39;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum()<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span>    summary[<span style="color:#e6db74">&#39;Uniques&#39;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>nunique()<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span>    summary[<span style="color:#e6db74">&#39;Missing Percentage&#39;</span>] <span style="color:#f92672">=</span> (df<span style="color:#f92672">.</span>isna()<span style="color:#f92672">.</span>sum()<span style="color:#f92672">.</span>values<span style="color:#f92672">/</span>len(df))
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># summary[&#39;index&#39;].drop()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> summary<span style="color:#f92672">.</span>sort_values([<span style="color:#e6db74">&#39;Missing Percentage&#39;</span>], ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#f92672">.</span>reset_index()
</span></span></code></pre></div><h3 id="customers-dataset">Customers Dataset</h3>
<p>Dataset/table customers memuat informasi mengenai customer dan lokasinya (zip_code, state, city). Dataset ini juga memiliki kolom &lsquo;customer_unique_id&rsquo;, dan customer_id. Kolom customer_unique_id merupakan data id customer yang unik (mewakili tiap customer), sedangkan customer_id merupakan kolom id customer yang berbeda di tiap order yang dilakukan. Hal ini memungkinkan terdapat banyak data customer_unique_id yang duplikat pada table customer ini, karena customer_unique_id bisa digunakan oleh beberapa customer_id (beberapa order oleh customer yang sama).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;jumlah customer :&#39;</span>, customers[<span style="color:#e6db74">&#39;customer_unique_id&#39;</span>]<span style="color:#f92672">.</span>duplicated()<span style="color:#f92672">.</span>sum())
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;jumlah customer terduplikat :&#39;</span>, customers[<span style="color:#e6db74">&#39;customer_id&#39;</span>]<span style="color:#f92672">.</span>duplicated()<span style="color:#f92672">.</span>sum())
</span></span></code></pre></div><pre><code>jumlah customer : 3345
jumlah customer terduplikat : 0
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>resumetable(customers)
</span></span></code></pre></div><pre><code>Dataset Shape: (99441, 5)
</code></pre>
  <div id="df-28c18b78-dd5f-464a-a6d6-cf35aa056b86">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Name</th>
      <th>dtypes</th>
      <th>Missing</th>
      <th>Uniques</th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>customer_id</td>
      <td>object</td>
      <td>0</td>
      <td>99441</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>customer_unique_id</td>
      <td>object</td>
      <td>0</td>
      <td>96096</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>customer_zip_code_prefix</td>
      <td>int64</td>
      <td>0</td>
      <td>14994</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>customer_city</td>
      <td>object</td>
      <td>0</td>
      <td>4119</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>customer_state</td>
      <td>object</td>
      <td>0</td>
      <td>27</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-28c18b78-dd5f-464a-a6d6-cf35aa056b86')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-28c18b78-dd5f-464a-a6d6-cf35aa056b86 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-28c18b78-dd5f-464a-a6d6-cf35aa056b86');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h3 id="geolocations-dataset">Geolocations Dataset</h3>
<p>Dataset/Table ini memuat informasi tentang zip codes, state, city yang ada di Brazil beserta latitude dan longitudenya.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>resumetable(geolocations)
</span></span></code></pre></div><pre><code>Dataset Shape: (1000163, 5)
</code></pre>
  <div id="df-e50431a9-be6f-49d4-a2b6-cf67f1c990c9">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Name</th>
      <th>dtypes</th>
      <th>Missing</th>
      <th>Uniques</th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>geolocation_zip_code_prefix</td>
      <td>int64</td>
      <td>0</td>
      <td>19015</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>geolocation_lat</td>
      <td>float64</td>
      <td>0</td>
      <td>717360</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>geolocation_lng</td>
      <td>float64</td>
      <td>0</td>
      <td>717613</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>geolocation_city</td>
      <td>object</td>
      <td>0</td>
      <td>8011</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>geolocation_state</td>
      <td>object</td>
      <td>0</td>
      <td>27</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e50431a9-be6f-49d4-a2b6-cf67f1c990c9')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-e50431a9-be6f-49d4-a2b6-cf67f1c990c9 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-e50431a9-be6f-49d4-a2b6-cf67f1c990c9');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h3 id="orders-dataset">Orders Dataset</h3>
<p>Ini adalah dataset utama, dimana memuat semua informasi tentang order</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>resumetable(orders)
</span></span></code></pre></div><pre><code>Dataset Shape: (99441, 8)
</code></pre>
  <div id="df-ef58f08c-04f8-4418-9250-48ff3a6e0015">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Name</th>
      <th>dtypes</th>
      <th>Missing</th>
      <th>Uniques</th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>order_delivered_customer_date</td>
      <td>object</td>
      <td>2965</td>
      <td>95664</td>
      <td>0.029817</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>order_delivered_carrier_date</td>
      <td>object</td>
      <td>1783</td>
      <td>81018</td>
      <td>0.017930</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>order_approved_at</td>
      <td>object</td>
      <td>160</td>
      <td>90733</td>
      <td>0.001609</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>order_id</td>
      <td>object</td>
      <td>0</td>
      <td>99441</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>customer_id</td>
      <td>object</td>
      <td>0</td>
      <td>99441</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>order_status</td>
      <td>object</td>
      <td>0</td>
      <td>8</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3</td>
      <td>order_purchase_timestamp</td>
      <td>object</td>
      <td>0</td>
      <td>98875</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>order_estimated_delivery_date</td>
      <td>object</td>
      <td>0</td>
      <td>459</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ef58f08c-04f8-4418-9250-48ff3a6e0015')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-ef58f08c-04f8-4418-9250-48ff3a6e0015 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-ef58f08c-04f8-4418-9250-48ff3a6e0015');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<ul>
<li><code>order_delivered_customer_date</code> adalah waktu pesanan sampai di customer</li>
<li><code>order_delivered_carrier_date</code> adalah waktu dimana order telah diteruskan seller dan diterima kurir</li>
<li><code>order_approved_at</code> adalah waktu dimana pesanan dari customer diterima oleh seller adn mulai diproses.</li>
<li><code>order_purchase_timestamp</code> adalah waktu dimana customer membuat pesanan</li>
<li><code>order_estimated_delivery_date</code> adalah waktu pesanan diperkirakan akan sampai di tangan customer sejak customer melakukan pemesanan</li>
<li><code>order_status</code> adalah status pengiriman, apakah dikirim, sampai, batal, dll</li>
</ul>
<p><em>order_status</em> memuat data status pengiriman sebagai berikut:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>orders[<span style="color:#e6db74">&#39;order_status&#39;</span>]<span style="color:#f92672">.</span>unique()
</span></span></code></pre></div><pre><code>array(['delivered', 'invoiced', 'shipped', 'processing', 'unavailable',
       'canceled', 'created', 'approved'], dtype=object)
</code></pre>
<h3 id="order-items-dataset">Order Items Dataset</h3>
<p>Dataset ini memuat informasi tentang barang yang dibeli pada tiap order.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>resumetable(order_items)
</span></span></code></pre></div><pre><code>Dataset Shape: (112650, 7)
</code></pre>
  <div id="df-82ff9c2a-1e61-4f86-b0dd-c76864ed3e80">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Name</th>
      <th>dtypes</th>
      <th>Missing</th>
      <th>Uniques</th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>order_id</td>
      <td>object</td>
      <td>0</td>
      <td>98666</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>order_item_id</td>
      <td>int64</td>
      <td>0</td>
      <td>21</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>product_id</td>
      <td>object</td>
      <td>0</td>
      <td>32951</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>seller_id</td>
      <td>object</td>
      <td>0</td>
      <td>3095</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>shipping_limit_date</td>
      <td>object</td>
      <td>0</td>
      <td>93318</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>price</td>
      <td>float64</td>
      <td>0</td>
      <td>5968</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>freight_value</td>
      <td>float64</td>
      <td>0</td>
      <td>6999</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-82ff9c2a-1e61-4f86-b0dd-c76864ed3e80')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-82ff9c2a-1e61-4f86-b0dd-c76864ed3e80 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-82ff9c2a-1e61-4f86-b0dd-c76864ed3e80');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<ul>
<li><code>shipping_limit_date</code> adalah batas waktu pengiriman, dimana seller harus memproses pesanan dan mengirimkan barang sebelum batas waktu tersebut.</li>
<li><code>price</code> adalah harga tiap item produk</li>
<li><code>freight_value</code> adalah nilai ongkos kirim, didapat berdasarkan berat barang, dan volume barang</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>order_items[[<span style="color:#e6db74">&#39;price&#39;</span>, <span style="color:#e6db74">&#39;freight_value&#39;</span>]]<span style="color:#f92672">.</span>describe()
</span></span></code></pre></div>  <div id="df-28b2d4e0-6c05-4484-85ab-f18a36c030c7">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>freight_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>112650.000000</td>
      <td>112650.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>120.653739</td>
      <td>19.990320</td>
    </tr>
    <tr>
      <th>std</th>
      <td>183.633928</td>
      <td>15.806405</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.850000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>39.900000</td>
      <td>13.080000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>74.990000</td>
      <td>16.260000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>134.900000</td>
      <td>21.150000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>6735.000000</td>
      <td>409.680000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-28b2d4e0-6c05-4484-85ab-f18a36c030c7')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-28b2d4e0-6c05-4484-85ab-f18a36c030c7 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-28b2d4e0-6c05-4484-85ab-f18a36c030c7');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h3 id="order-payments-dataset">Order Payments Dataset</h3>
<p>Tabel ini memuat data tentang pilihan pembayaran</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>resumetable(order_payments)
</span></span></code></pre></div><pre><code>Dataset Shape: (103886, 5)
</code></pre>
  <div id="df-6c249116-53e6-4e4b-9374-7c26f1fa483b">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Name</th>
      <th>dtypes</th>
      <th>Missing</th>
      <th>Uniques</th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>order_id</td>
      <td>object</td>
      <td>0</td>
      <td>99440</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>payment_sequential</td>
      <td>int64</td>
      <td>0</td>
      <td>29</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>payment_type</td>
      <td>object</td>
      <td>0</td>
      <td>5</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>payment_installments</td>
      <td>int64</td>
      <td>0</td>
      <td>24</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>payment_value</td>
      <td>float64</td>
      <td>0</td>
      <td>29077</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6c249116-53e6-4e4b-9374-7c26f1fa483b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-6c249116-53e6-4e4b-9374-7c26f1fa483b button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-6c249116-53e6-4e4b-9374-7c26f1fa483b');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>order_payments<span style="color:#f92672">.</span>describe()
</span></span></code></pre></div>  <div id="df-17ad4fd2-c96b-4a91-951c-8a34194a9583">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>payment_sequential</th>
      <th>payment_installments</th>
      <th>payment_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>103886.000000</td>
      <td>103886.000000</td>
      <td>103886.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.092679</td>
      <td>2.853349</td>
      <td>154.100380</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.706584</td>
      <td>2.687051</td>
      <td>217.494064</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>56.790000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.000000</td>
      <td>4.000000</td>
      <td>171.837500</td>
    </tr>
    <tr>
      <th>max</th>
      <td>29.000000</td>
      <td>24.000000</td>
      <td>13664.080000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-17ad4fd2-c96b-4a91-951c-8a34194a9583')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-17ad4fd2-c96b-4a91-951c-8a34194a9583 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-17ad4fd2-c96b-4a91-951c-8a34194a9583');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>order_payments[<span style="color:#e6db74">&#39;payment_type&#39;</span>]<span style="color:#f92672">.</span>unique()
</span></span></code></pre></div><pre><code>array(['credit_card', 'boleto', 'voucher', 'debit_card', 'not_defined'],
      dtype=object)
</code></pre>
<h3 id="order-reviews-dataset">Order Reviews Dataset</h3>
<p>Tabel ini memuat data tentang review yang dibuat oleh customers. Setelah customer membayar produk yang mereka order, maka seller akan segera mendapat notifikasi untuk segera memenuhi/menyetujui order. Ketika customer telah menerima produk, atau estimasi pengiriman sudah lewat maka customer mendapat survey kepuasan melalui email dimana customers dapat memberikan score kepuasan terhadap pengalaman order barang dan memberikan komentar/feedback.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>resumetable(order_reviews)
</span></span></code></pre></div><pre><code>Dataset Shape: (99224, 7)
</code></pre>
  <div id="df-d49d1a49-2c56-4a71-8931-1b75dd1c6501">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Name</th>
      <th>dtypes</th>
      <th>Missing</th>
      <th>Uniques</th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>review_comment_title</td>
      <td>object</td>
      <td>87656</td>
      <td>4527</td>
      <td>0.883415</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>review_comment_message</td>
      <td>object</td>
      <td>58247</td>
      <td>36159</td>
      <td>0.587025</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>review_id</td>
      <td>object</td>
      <td>0</td>
      <td>98410</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>order_id</td>
      <td>object</td>
      <td>0</td>
      <td>98673</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>review_score</td>
      <td>int64</td>
      <td>0</td>
      <td>5</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>review_creation_date</td>
      <td>object</td>
      <td>0</td>
      <td>636</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>review_answer_timestamp</td>
      <td>object</td>
      <td>0</td>
      <td>98248</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d49d1a49-2c56-4a71-8931-1b75dd1c6501')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-d49d1a49-2c56-4a71-8931-1b75dd1c6501 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-d49d1a49-2c56-4a71-8931-1b75dd1c6501');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<p>terdapat banyak customers yang tidak memberikan judul saat menulis komentar</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>order_reviews[<span style="color:#e6db74">&#39;review_score&#39;</span>]<span style="color:#f92672">.</span>unique()
</span></span></code></pre></div><pre><code>array([4, 5, 1, 3, 2])
</code></pre>
<p>customers dapat memberikan skor kepuasan mulai 1-5</p>
<h3 id="products-dataset">Products Dataset</h3>
<p>Tabel ini memuat data tentang produk-produk yang dijual di Olist.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>resumetable(products)
</span></span></code></pre></div><pre><code>Dataset Shape: (32951, 9)
</code></pre>
  <div id="df-8830912e-3d74-4318-aae9-958a131da003">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Name</th>
      <th>dtypes</th>
      <th>Missing</th>
      <th>Uniques</th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>product_category_name</td>
      <td>object</td>
      <td>610</td>
      <td>73</td>
      <td>0.018512</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>product_name_lenght</td>
      <td>float64</td>
      <td>610</td>
      <td>66</td>
      <td>0.018512</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>product_description_lenght</td>
      <td>float64</td>
      <td>610</td>
      <td>2960</td>
      <td>0.018512</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>product_photos_qty</td>
      <td>float64</td>
      <td>610</td>
      <td>19</td>
      <td>0.018512</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>product_weight_g</td>
      <td>float64</td>
      <td>2</td>
      <td>2204</td>
      <td>0.000061</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>product_length_cm</td>
      <td>float64</td>
      <td>2</td>
      <td>99</td>
      <td>0.000061</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>product_height_cm</td>
      <td>float64</td>
      <td>2</td>
      <td>102</td>
      <td>0.000061</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>product_width_cm</td>
      <td>float64</td>
      <td>2</td>
      <td>95</td>
      <td>0.000061</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>product_id</td>
      <td>object</td>
      <td>0</td>
      <td>32951</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-8830912e-3d74-4318-aae9-958a131da003')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-8830912e-3d74-4318-aae9-958a131da003 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-8830912e-3d74-4318-aae9-958a131da003');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<p>banyak kolom yang memilki missing value</p>
<h3 id="sellers-dataset">Sellers Dataset</h3>
<p>Table ini memuat data tentang seller yang memenuhi/telah melayani order di Olist. Mirip seperti data customer namun ini untuk seller dan tidak memiliki id tersendiri untuk tiap order</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>resumetable(sellers)
</span></span></code></pre></div><pre><code>Dataset Shape: (3095, 4)
</code></pre>
  <div id="df-6f6a13cb-ce84-4af3-a5ef-80315c2d25d1">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Name</th>
      <th>dtypes</th>
      <th>Missing</th>
      <th>Uniques</th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>seller_id</td>
      <td>object</td>
      <td>0</td>
      <td>3095</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>seller_zip_code_prefix</td>
      <td>int64</td>
      <td>0</td>
      <td>2246</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>seller_city</td>
      <td>object</td>
      <td>0</td>
      <td>611</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>seller_state</td>
      <td>object</td>
      <td>0</td>
      <td>23</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6f6a13cb-ce84-4af3-a5ef-80315c2d25d1')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-6f6a13cb-ce84-4af3-a5ef-80315c2d25d1 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-6f6a13cb-ce84-4af3-a5ef-80315c2d25d1');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h2 id="feature-engineering-phase-1">Feature Engineering Phase 1</h2>
<p>Feature Engineering Phase 1 dilakukan untuk menyiapkan datasset sebelum dilakukan proses Eksplorasi (EDA)</p>
<h4 id="missing-values-summary">Missing Values Summary</h4>
<p>Mendeteksi missing value pada dataset</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>null_data<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> orders, order_reviews, products:
</span></span><span style="display:flex;"><span>  i<span style="color:#f92672">=</span>i<span style="color:#f92672">.</span>isna()<span style="color:#f92672">.</span>sum()<span style="color:#f92672">.</span>reset_index()
</span></span><span style="display:flex;"><span>  i<span style="color:#f92672">=</span>i[i[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">!=</span><span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>  null_data<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>concat([null_data,i])
</span></span><span style="display:flex;"><span>null_data<span style="color:#f92672">=</span>null_data<span style="color:#f92672">.</span>reset_index()<span style="color:#f92672">.</span>drop(columns<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;level_0&#39;</span>)<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;index&#39;</span>:<span style="color:#e6db74">&#39;null_col&#39;</span>,<span style="color:#ae81ff">0</span>:<span style="color:#e6db74">&#39;null_qty&#39;</span>})
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">columns_check</span>(x):
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> x <span style="color:#f92672">in</span> order_reviews<span style="color:#f92672">.</span>columns:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;order_reviews&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> x <span style="color:#f92672">in</span> orders<span style="color:#f92672">.</span>columns:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;orders&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> x <span style="color:#f92672">in</span> products<span style="color:#f92672">.</span>columns:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;products&#39;</span>
</span></span><span style="display:flex;"><span>null_data[<span style="color:#e6db74">&#39;dataset&#39;</span>]<span style="color:#f92672">=</span>null_data[<span style="color:#e6db74">&#39;null_col&#39;</span>]<span style="color:#f92672">.</span>apply(columns_check)
</span></span><span style="display:flex;"><span>null_data<span style="color:#f92672">=</span>null_data<span style="color:#f92672">.</span>reindex(columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;dataset&#39;</span>,<span style="color:#e6db74">&#39;null_col&#39;</span>,<span style="color:#e6db74">&#39;null_qty&#39;</span>])
</span></span><span style="display:flex;"><span>null_data
</span></span></code></pre></div>  <div id="df-853aecc4-9c00-430c-9d9a-ba24f6f8c50a">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>null_col</th>
      <th>null_qty</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>orders</td>
      <td>order_approved_at</td>
      <td>160</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orders</td>
      <td>order_delivered_carrier_date</td>
      <td>1783</td>
    </tr>
    <tr>
      <th>2</th>
      <td>orders</td>
      <td>order_delivered_customer_date</td>
      <td>2965</td>
    </tr>
    <tr>
      <th>3</th>
      <td>order_reviews</td>
      <td>review_comment_title</td>
      <td>87656</td>
    </tr>
    <tr>
      <th>4</th>
      <td>order_reviews</td>
      <td>review_comment_message</td>
      <td>58247</td>
    </tr>
    <tr>
      <th>5</th>
      <td>products</td>
      <td>product_category_name</td>
      <td>610</td>
    </tr>
    <tr>
      <th>6</th>
      <td>products</td>
      <td>product_name_lenght</td>
      <td>610</td>
    </tr>
    <tr>
      <th>7</th>
      <td>products</td>
      <td>product_description_lenght</td>
      <td>610</td>
    </tr>
    <tr>
      <th>8</th>
      <td>products</td>
      <td>product_photos_qty</td>
      <td>610</td>
    </tr>
    <tr>
      <th>9</th>
      <td>products</td>
      <td>product_weight_g</td>
      <td>2</td>
    </tr>
    <tr>
      <th>10</th>
      <td>products</td>
      <td>product_length_cm</td>
      <td>2</td>
    </tr>
    <tr>
      <th>11</th>
      <td>products</td>
      <td>product_height_cm</td>
      <td>2</td>
    </tr>
    <tr>
      <th>12</th>
      <td>products</td>
      <td>product_width_cm</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-853aecc4-9c00-430c-9d9a-ba24f6f8c50a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-853aecc4-9c00-430c-9d9a-ba24f6f8c50a button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-853aecc4-9c00-430c-9d9a-ba24f6f8c50a');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h4 id="merging-and-creating-customer360-dataset">Merging and Creating Customer360 Dataset</h4>
<p>Kita perlu melakukan merging pada tables untuk memudahkan dalam melakukan exploratory dan menyiapkan dataset untuk modeling. Dataset hasil yang dihasilkan memiliki kriteria customer360, yakni memuat segala informasi aktivitas customer ketika berbisnis dengan Olist, terutama berkaitan dengan aktivitas transaksi.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Mengubah nama kolom supaya lebih ringkas</span>
</span></span><span style="display:flex;"><span>customers<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;customer_zip_code_prefix&#34;</span>: <span style="color:#e6db74">&#34;cust_zip_code&#34;</span>, <span style="color:#e6db74">&#34;customer_city&#34;</span>: <span style="color:#e6db74">&#34;cust_city&#34;</span>, <span style="color:#e6db74">&#34;customer_state&#34;</span>: <span style="color:#e6db74">&#34;cust_state&#34;</span>}, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>geolocations<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;geolocation_zip_code_prefix&#34;</span>: <span style="color:#e6db74">&#34;geo_zip_code&#34;</span>, <span style="color:#e6db74">&#34;geolocation_city&#34;</span>: <span style="color:#e6db74">&#34;geo_city&#34;</span>, <span style="color:#e6db74">&#34;geolocation_state&#34;</span>: <span style="color:#e6db74">&#34;geo_state&#34;</span>}, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>sellers<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;seller_zip_code_prefix&#34;</span>: <span style="color:#e6db74">&#34;sel_zip_code&#34;</span>, <span style="color:#e6db74">&#34;seller_city&#34;</span>: <span style="color:#e6db74">&#34;sel_city&#34;</span>, <span style="color:#e6db74">&#34;seller_state&#34;</span>: <span style="color:#e6db74">&#34;sel_state&#34;</span>}, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>list_col <span style="color:#f92672">=</span> [geolocations, customers, sellers]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> list_col:
</span></span><span style="display:flex;"><span>  print(i<span style="color:#f92672">.</span>columns)
</span></span></code></pre></div><pre><code>Index(['geo_zip_code', 'geolocation_lat', 'geolocation_lng', 'geo_city',
       'geo_state'],
      dtype='object')
Index(['customer_id', 'customer_unique_id', 'cust_zip_code', 'cust_city',
       'cust_state'],
      dtype='object')
Index(['seller_id', 'sel_zip_code', 'sel_city', 'sel_state'], dtype='object')
</code></pre>
<p>Creating Customer360 Dataset</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360 <span style="color:#f92672">=</span> orders<span style="color:#f92672">.</span>merge(order_items, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;left&#34;</span>, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;order_id&#39;</span>])
</span></span><span style="display:flex;"><span>cus360 <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>merge(order_payments, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;order_id&#39;</span>], validate<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;m:m&#39;</span>)
</span></span><span style="display:flex;"><span>cus360 <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>merge(order_reviews, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;order_id&#39;</span>])
</span></span><span style="display:flex;"><span>cus360 <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>merge(products, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;product_id&#39;</span>])
</span></span><span style="display:flex;"><span>cus360 <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>merge(customers, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;customer_id&#39;</span>])
</span></span><span style="display:flex;"><span>cus360 <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>merge(sellers, on<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;seller_id&#39;</span>])
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>resumetable(cus360)
</span></span></code></pre></div><pre><code>Dataset Shape: (117329, 39)
</code></pre>
  <div id="df-09404a4e-4e78-4d05-9a88-3918656aecf8">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Name</th>
      <th>dtypes</th>
      <th>Missing</th>
      <th>Uniques</th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20</td>
      <td>review_comment_title</td>
      <td>object</td>
      <td>103437</td>
      <td>4497</td>
      <td>0.881598</td>
    </tr>
    <tr>
      <th>1</th>
      <td>21</td>
      <td>review_comment_message</td>
      <td>object</td>
      <td>67650</td>
      <td>35691</td>
      <td>0.576584</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>order_delivered_customer_date</td>
      <td>object</td>
      <td>2471</td>
      <td>95021</td>
      <td>0.021060</td>
    </tr>
    <tr>
      <th>3</th>
      <td>24</td>
      <td>product_category_name</td>
      <td>object</td>
      <td>1695</td>
      <td>73</td>
      <td>0.014447</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25</td>
      <td>product_name_lenght</td>
      <td>float64</td>
      <td>1695</td>
      <td>66</td>
      <td>0.014447</td>
    </tr>
    <tr>
      <th>5</th>
      <td>26</td>
      <td>product_description_lenght</td>
      <td>float64</td>
      <td>1695</td>
      <td>2958</td>
      <td>0.014447</td>
    </tr>
    <tr>
      <th>6</th>
      <td>27</td>
      <td>product_photos_qty</td>
      <td>float64</td>
      <td>1695</td>
      <td>19</td>
      <td>0.014447</td>
    </tr>
    <tr>
      <th>7</th>
      <td>5</td>
      <td>order_delivered_carrier_date</td>
      <td>object</td>
      <td>1235</td>
      <td>80449</td>
      <td>0.010526</td>
    </tr>
    <tr>
      <th>8</th>
      <td>30</td>
      <td>product_height_cm</td>
      <td>float64</td>
      <td>20</td>
      <td>102</td>
      <td>0.000170</td>
    </tr>
    <tr>
      <th>9</th>
      <td>28</td>
      <td>product_weight_g</td>
      <td>float64</td>
      <td>20</td>
      <td>2200</td>
      <td>0.000170</td>
    </tr>
    <tr>
      <th>10</th>
      <td>29</td>
      <td>product_length_cm</td>
      <td>float64</td>
      <td>20</td>
      <td>99</td>
      <td>0.000170</td>
    </tr>
    <tr>
      <th>11</th>
      <td>31</td>
      <td>product_width_cm</td>
      <td>float64</td>
      <td>20</td>
      <td>95</td>
      <td>0.000170</td>
    </tr>
    <tr>
      <th>12</th>
      <td>4</td>
      <td>order_approved_at</td>
      <td>object</td>
      <td>15</td>
      <td>89533</td>
      <td>0.000128</td>
    </tr>
    <tr>
      <th>13</th>
      <td>22</td>
      <td>review_creation_date</td>
      <td>object</td>
      <td>0</td>
      <td>632</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>32</td>
      <td>customer_unique_id</td>
      <td>object</td>
      <td>0</td>
      <td>94720</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>33</td>
      <td>cust_zip_code</td>
      <td>int64</td>
      <td>0</td>
      <td>14955</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>34</td>
      <td>cust_city</td>
      <td>object</td>
      <td>0</td>
      <td>4108</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>17</th>
      <td>35</td>
      <td>cust_state</td>
      <td>object</td>
      <td>0</td>
      <td>27</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>18</th>
      <td>36</td>
      <td>sel_zip_code</td>
      <td>int64</td>
      <td>0</td>
      <td>2245</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>19</th>
      <td>23</td>
      <td>review_answer_timestamp</td>
      <td>object</td>
      <td>0</td>
      <td>97546</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>20</th>
      <td>37</td>
      <td>sel_city</td>
      <td>object</td>
      <td>0</td>
      <td>611</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0</td>
      <td>order_id</td>
      <td>object</td>
      <td>0</td>
      <td>97916</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>22</th>
      <td>19</td>
      <td>review_score</td>
      <td>int64</td>
      <td>0</td>
      <td>5</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1</td>
      <td>customer_id</td>
      <td>object</td>
      <td>0</td>
      <td>97916</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>24</th>
      <td>18</td>
      <td>review_id</td>
      <td>object</td>
      <td>0</td>
      <td>97708</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25</th>
      <td>17</td>
      <td>payment_value</td>
      <td>float64</td>
      <td>0</td>
      <td>28831</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>26</th>
      <td>16</td>
      <td>payment_installments</td>
      <td>int64</td>
      <td>0</td>
      <td>24</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>27</th>
      <td>15</td>
      <td>payment_type</td>
      <td>object</td>
      <td>0</td>
      <td>4</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>28</th>
      <td>14</td>
      <td>payment_sequential</td>
      <td>int64</td>
      <td>0</td>
      <td>29</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>29</th>
      <td>13</td>
      <td>freight_value</td>
      <td>float64</td>
      <td>0</td>
      <td>6976</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>30</th>
      <td>12</td>
      <td>price</td>
      <td>float64</td>
      <td>0</td>
      <td>5948</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>31</th>
      <td>11</td>
      <td>shipping_limit_date</td>
      <td>object</td>
      <td>0</td>
      <td>92642</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>32</th>
      <td>10</td>
      <td>seller_id</td>
      <td>object</td>
      <td>0</td>
      <td>3090</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>33</th>
      <td>9</td>
      <td>product_id</td>
      <td>object</td>
      <td>0</td>
      <td>32789</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>34</th>
      <td>8</td>
      <td>order_item_id</td>
      <td>float64</td>
      <td>0</td>
      <td>21</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>35</th>
      <td>7</td>
      <td>order_estimated_delivery_date</td>
      <td>object</td>
      <td>0</td>
      <td>449</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>36</th>
      <td>3</td>
      <td>order_purchase_timestamp</td>
      <td>object</td>
      <td>0</td>
      <td>97370</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2</td>
      <td>order_status</td>
      <td>object</td>
      <td>0</td>
      <td>7</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>38</th>
      <td>38</td>
      <td>sel_state</td>
      <td>object</td>
      <td>0</td>
      <td>23</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-09404a4e-4e78-4d05-9a88-3918656aecf8')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-09404a4e-4e78-4d05-9a88-3918656aecf8 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-09404a4e-4e78-4d05-9a88-3918656aecf8');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">1</span>)
</span></span></code></pre></div>  <div id="df-3c176547-6a74-404e-bb2c-87ba148e786e">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>customer_id</th>
      <th>order_status</th>
      <th>order_purchase_timestamp</th>
      <th>order_approved_at</th>
      <th>order_delivered_carrier_date</th>
      <th>order_delivered_customer_date</th>
      <th>order_estimated_delivery_date</th>
      <th>order_item_id</th>
      <th>product_id</th>
      <th>seller_id</th>
      <th>shipping_limit_date</th>
      <th>price</th>
      <th>freight_value</th>
      <th>payment_sequential</th>
      <th>payment_type</th>
      <th>payment_installments</th>
      <th>payment_value</th>
      <th>review_id</th>
      <th>review_score</th>
      <th>review_comment_title</th>
      <th>review_comment_message</th>
      <th>review_creation_date</th>
      <th>review_answer_timestamp</th>
      <th>product_category_name</th>
      <th>product_name_lenght</th>
      <th>product_description_lenght</th>
      <th>product_photos_qty</th>
      <th>product_weight_g</th>
      <th>product_length_cm</th>
      <th>product_height_cm</th>
      <th>product_width_cm</th>
      <th>customer_unique_id</th>
      <th>cust_zip_code</th>
      <th>cust_city</th>
      <th>cust_state</th>
      <th>sel_zip_code</th>
      <th>sel_city</th>
      <th>sel_state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>e481f51cbdc54678b7cc49136f2d6af7</td>
      <td>9ef432eb6251297304e76186b10a928d</td>
      <td>delivered</td>
      <td>2017-10-02 10:56:33</td>
      <td>2017-10-02 11:07:15</td>
      <td>2017-10-04 19:55:00</td>
      <td>2017-10-10 21:25:13</td>
      <td>2017-10-18 00:00:00</td>
      <td>1.0</td>
      <td>87285b34884572647811a353c7ac498a</td>
      <td>3504c0cb71d7fa48d967e0e4c94d59d9</td>
      <td>2017-10-06 11:07:15</td>
      <td>29.99</td>
      <td>8.72</td>
      <td>1</td>
      <td>credit_card</td>
      <td>1</td>
      <td>18.12</td>
      <td>a54f0611adc9ed256b57ede6b6eb5114</td>
      <td>4</td>
      <td>NaN</td>
      <td>Não testei o produto ainda, mas ele veio corre...</td>
      <td>2017-10-11 00:00:00</td>
      <td>2017-10-12 03:43:48</td>
      <td>utilidades_domesticas</td>
      <td>40.0</td>
      <td>268.0</td>
      <td>4.0</td>
      <td>500.0</td>
      <td>19.0</td>
      <td>8.0</td>
      <td>13.0</td>
      <td>7c396fd4830fd04220f754e42b4e5bff</td>
      <td>3149</td>
      <td>sao paulo</td>
      <td>SP</td>
      <td>9350</td>
      <td>maua</td>
      <td>SP</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-3c176547-6a74-404e-bb2c-87ba148e786e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-3c176547-6a74-404e-bb2c-87ba148e786e button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-3c176547-6a74-404e-bb2c-87ba148e786e');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h3 id="feature-engineering-date">Feature Engineering Date</h3>
<p>Nampak terdapat beberapa fitur yang menyatakan waktu. Fitur ini seharusnya memiliki tipe data datetime, namun ternyata masih berupa object, maka perlu kita ubah tipe datanya.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>to_date <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;review_answer_timestamp&#39;</span>, <span style="color:#e6db74">&#39;order_purchase_timestamp&#39;</span>, <span style="color:#e6db74">&#39;order_delivered_customer_date&#39;</span>, <span style="color:#e6db74">&#39;shipping_limit_date&#39;</span>, <span style="color:#e6db74">&#39;order_approved_at&#39;</span>, <span style="color:#e6db74">&#39;order_delivered_carrier_date&#39;</span>, <span style="color:#e6db74">&#39;review_creation_date&#39;</span>, <span style="color:#e6db74">&#39;order_estimated_delivery_date&#39;</span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360[to_date]<span style="color:#f92672">.</span>info()
</span></span></code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 117329 entries, 0 to 117328
Data columns (total 8 columns):
 #   Column                         Non-Null Count   Dtype 
---  ------                         --------------   ----- 
 0   review_answer_timestamp        117329 non-null  object
 1   order_purchase_timestamp       117329 non-null  object
 2   order_delivered_customer_date  114858 non-null  object
 3   shipping_limit_date            117329 non-null  object
 4   order_approved_at              117314 non-null  object
 5   order_delivered_carrier_date   116094 non-null  object
 6   review_creation_date           117329 non-null  object
 7   order_estimated_delivery_date  117329 non-null  object
dtypes: object(8)
memory usage: 8.1+ MB
</code></pre>
<h4 id="change-to-datetime">Change to Datetime</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> to_date:
</span></span><span style="display:flex;"><span>  cus360[i] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>to_datetime(cus360[i])
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360[to_date]<span style="color:#f92672">.</span>info()
</span></span></code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 117329 entries, 0 to 117328
Data columns (total 8 columns):
 #   Column                         Non-Null Count   Dtype         
---  ------                         --------------   -----         
 0   review_answer_timestamp        117329 non-null  datetime64[ns]
 1   order_purchase_timestamp       117329 non-null  datetime64[ns]
 2   order_delivered_customer_date  114858 non-null  datetime64[ns]
 3   shipping_limit_date            117329 non-null  datetime64[ns]
 4   order_approved_at              117314 non-null  datetime64[ns]
 5   order_delivered_carrier_date   116094 non-null  datetime64[ns]
 6   review_creation_date           117329 non-null  datetime64[ns]
 7   order_estimated_delivery_date  117329 non-null  datetime64[ns]
dtypes: datetime64[ns](8)
memory usage: 8.1 MB
</code></pre>
<h4 id="feature-creation">Feature Creation</h4>
<p>Dari fitur bertipe datetime, kita bisa mengekstrak informasi lain seperti tahun, bulan, hari secara independen untuk mendapatkan informasi yang lebih kaya</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>to_date
</span></span></code></pre></div><pre><code>['review_answer_timestamp',
 'order_purchase_timestamp',
 'order_delivered_customer_date',
 'shipping_limit_date',
 'order_approved_at',
 'order_delivered_carrier_date',
 'review_creation_date',
 'order_estimated_delivery_date']
</code></pre>
<h4 id="extracting-year">Extracting Year</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_purchase_year&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_purchase_timestamp&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;review_answer_year&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;review_creation_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_customer_year&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_delivered_customer_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_shipping_limit_year&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;shipping_limit_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_approved_at_year&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_approved_at&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_year&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;review_creation_year&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;review_creation_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_estimated_delivery_year&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_estimated_delivery_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year
</span></span></code></pre></div><h4 id="extracting-month">Extracting Month</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_purchase_month&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_purchase_timestamp&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month_name()<span style="color:#f92672">.</span>str[:<span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;review_answer_month&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;review_creation_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month_name()<span style="color:#f92672">.</span>str[:<span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;review_answer_month_n&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;review_answer_timestamp&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_purchase_month_n&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_purchase_timestamp&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_customer_month&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_delivered_customer_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_shipping_limit_month&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;shipping_limit_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_approved_at_month&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_approved_at&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_month&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;review_creation_month&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;review_creation_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_estimated_delivery_month&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_estimated_delivery_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month
</span></span></code></pre></div><h4 id="extracting-day">Extracting Day</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;review_answer_day&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;review_answer_timestamp&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>day
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_purchase_day&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_purchase_timestamp&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>day
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_customer_day&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_delivered_customer_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>day
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_shipping_limit_day&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;shipping_limit_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>day
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_approved_at_day&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_approved_at&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>day
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_day&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>day
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;review_creation_day&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;review_creation_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>day
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_estimated_delivery_day&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_estimated_delivery_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>day
</span></span></code></pre></div><h4 id="extracting-daywofweek">Extracting Daywofweek</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;review_answer_dayofweek&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;review_answer_timestamp&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>dayofweek
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_purchase_dayofweek&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_purchase_timestamp&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>dayofweek
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_customer_dayofweek&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_delivered_customer_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>dayofweek
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_shipping_limit_dayofweek&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;shipping_limit_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>dayofweek
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_approved_at_dayofweek&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_approved_at&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>dayofweek
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_dayofweek&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>dayofweek
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;review_creation_dayofweek&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;review_creation_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>dayofweek
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_estimated_delivery_dayofweek&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_estimated_delivery_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>dayofweek
</span></span></code></pre></div><h4 id="extracting-daypart">Extracting Daypart</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dayPart</span>(hour):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> hour <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">and</span> hour <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">5</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;dawn&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> hour <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">6</span> <span style="color:#f92672">and</span> hour <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">7</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;early morning&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> hour <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">and</span> hour <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">10</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;late morning&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> hour <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">11</span> <span style="color:#f92672">and</span> hour <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">13</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;noon&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> hour <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">14</span> <span style="color:#f92672">and</span> hour <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">16</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;afternoon&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> hour <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">17</span> <span style="color:#f92672">and</span> hour <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">19</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;evening&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> hour <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">20</span> <span style="color:#f92672">and</span> hour <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">22</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;night&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;midnight&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Days and Daypart</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_purchase_day_name&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_purchase_timestamp&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>day_name()
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_purchase_day_part&#39;</span>] <span style="color:#f92672">=</span> (cus360[<span style="color:#e6db74">&#39;order_purchase_timestamp&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>hour)<span style="color:#f92672">.</span>apply(dayPart)
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_purchase_is_weekend&#39;</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>where(cus360[<span style="color:#e6db74">&#39;order_purchase_day_name&#39;</span>]<span style="color:#f92672">.</span>isin([<span style="color:#e6db74">&#39;Sunday&#39;</span>, <span style="color:#e6db74">&#39;Saturday&#39;</span>]), <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_customer_day_name&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_delivered_customer_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>day_name()
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_customer_day_part&#39;</span>] <span style="color:#f92672">=</span> (cus360[<span style="color:#e6db74">&#39;order_delivered_customer_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>hour)<span style="color:#f92672">.</span>apply(dayPart)
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_customer_is_weekend&#39;</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>where(cus360[<span style="color:#e6db74">&#39;order_delivered_customer_day_name&#39;</span>]<span style="color:#f92672">.</span>isin([<span style="color:#e6db74">&#39;Sunday&#39;</span>, <span style="color:#e6db74">&#39;Saturday&#39;</span>]), <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_approved_at_day_part&#39;</span>] <span style="color:#f92672">=</span> (cus360[<span style="color:#e6db74">&#39;order_approved_at&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>hour)<span style="color:#f92672">.</span>apply(dayPart)
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_approved_at_day_name&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_approved_at&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>day_name()
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_approved_at_is_weekend&#39;</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>where(cus360[<span style="color:#e6db74">&#39;order_approved_at_day_name&#39;</span>]<span style="color:#f92672">.</span>isin([<span style="color:#e6db74">&#39;Sunday&#39;</span>, <span style="color:#e6db74">&#39;Saturday&#39;</span>]), <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_day_name&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>day_name()
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_day_part&#39;</span>] <span style="color:#f92672">=</span> (cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>hour)<span style="color:#f92672">.</span>apply(dayPart)
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_is_weekend&#39;</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>where(cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_day_name&#39;</span>]<span style="color:#f92672">.</span>isin([<span style="color:#e6db74">&#39;Sunday&#39;</span>, <span style="color:#e6db74">&#39;Saturday&#39;</span>]), <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)
</span></span></code></pre></div><h3 id="features-creation">Features Creation</h3>
<h4 id="shipping-status">Shipping Status</h4>
<p>Shipping Status menunjukan status dari pengiriman dari seller, apakah seller telah mengirimkan barang sebelum batas waktu (On Time), atau melebih batas waktu (Late)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">shippingStatus</span>(length):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> length <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;On Time&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> length <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Late&#34;</span>
</span></span></code></pre></div><h4 id="shipping-performance">Shipping Performance</h4>
<p>Shipping Performance menyatakan performa pengiriman, apakah pengriman tergolong cepat, normal atau lambat. Dihitung dari selisih estimasi waktu terkirim dengan waktu barang sampai di customer</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">shippingPerformance</span>(length):
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> length <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Fast&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">elif</span> length <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Normal&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">elif</span> length <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Slow&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;shipping_length&#39;</span>] <span style="color:#f92672">=</span> (cus360[<span style="color:#e6db74">&#39;order_delivered_customer_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>date <span style="color:#f92672">-</span> cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>date)<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>days
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;seller_shipping_response&#39;</span>] <span style="color:#f92672">=</span> (cus360[<span style="color:#e6db74">&#39;order_delivered_carrier_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>date <span style="color:#f92672">-</span> cus360[<span style="color:#e6db74">&#39;order_approved_at&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>date)<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>days
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;seller_order_response&#39;</span>] <span style="color:#f92672">=</span> (cus360[<span style="color:#e6db74">&#39;order_approved_at&#39;</span>] <span style="color:#f92672">-</span> cus360[<span style="color:#e6db74">&#39;order_purchase_timestamp&#39;</span>])<span style="color:#f92672">/</span> np<span style="color:#f92672">.</span>timedelta64(<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;h&#39;</span>)
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;shipping_status&#39;</span>] <span style="color:#f92672">=</span> ((cus360[<span style="color:#e6db74">&#39;shipping_limit_date&#39;</span>] <span style="color:#f92672">-</span> cus360[<span style="color:#e6db74">&#39;order_approved_at&#39;</span>])<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>days)<span style="color:#f92672">.</span>apply(shippingStatus)
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;shipping_performance&#39;</span>] <span style="color:#f92672">=</span> ((cus360[<span style="color:#e6db74">&#39;order_estimated_delivery_date&#39;</span>] <span style="color:#f92672">-</span> cus360[<span style="color:#e6db74">&#39;order_delivered_customer_date&#39;</span>])<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>days)<span style="color:#f92672">.</span>apply(shippingPerformance)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360<span style="color:#f92672">.</span>head()
</span></span></code></pre></div>  <div id="df-17ab49d2-2d50-4ad5-bb1f-4cb6ea24af29">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>customer_id</th>
      <th>order_status</th>
      <th>order_purchase_timestamp</th>
      <th>order_approved_at</th>
      <th>order_delivered_carrier_date</th>
      <th>order_delivered_customer_date</th>
      <th>order_estimated_delivery_date</th>
      <th>order_item_id</th>
      <th>product_id</th>
      <th>seller_id</th>
      <th>shipping_limit_date</th>
      <th>price</th>
      <th>freight_value</th>
      <th>payment_sequential</th>
      <th>payment_type</th>
      <th>payment_installments</th>
      <th>payment_value</th>
      <th>review_id</th>
      <th>review_score</th>
      <th>review_comment_title</th>
      <th>review_comment_message</th>
      <th>review_creation_date</th>
      <th>review_answer_timestamp</th>
      <th>product_category_name</th>
      <th>product_name_lenght</th>
      <th>product_description_lenght</th>
      <th>product_photos_qty</th>
      <th>product_weight_g</th>
      <th>product_length_cm</th>
      <th>product_height_cm</th>
      <th>product_width_cm</th>
      <th>customer_unique_id</th>
      <th>cust_zip_code</th>
      <th>cust_city</th>
      <th>cust_state</th>
      <th>sel_zip_code</th>
      <th>sel_city</th>
      <th>sel_state</th>
      <th>order_purchase_year</th>
      <th>review_answer_year</th>
      <th>order_delivered_customer_year</th>
      <th>order_shipping_limit_year</th>
      <th>order_approved_at_year</th>
      <th>order_delivered_carrier_year</th>
      <th>review_creation_year</th>
      <th>order_estimated_delivery_year</th>
      <th>order_purchase_month</th>
      <th>review_answer_month</th>
      <th>review_answer_month_n</th>
      <th>order_purchase_month_n</th>
      <th>order_delivered_customer_month</th>
      <th>order_shipping_limit_month</th>
      <th>order_approved_at_month</th>
      <th>order_delivered_carrier_month</th>
      <th>review_creation_month</th>
      <th>order_estimated_delivery_month</th>
      <th>review_answer_day</th>
      <th>order_purchase_day</th>
      <th>order_delivered_customer_day</th>
      <th>order_shipping_limit_day</th>
      <th>order_approved_at_day</th>
      <th>order_delivered_carrier_day</th>
      <th>review_creation_day</th>
      <th>order_estimated_delivery_day</th>
      <th>review_answer_dayofweek</th>
      <th>order_purchase_dayofweek</th>
      <th>order_delivered_customer_dayofweek</th>
      <th>order_shipping_limit_dayofweek</th>
      <th>order_approved_at_dayofweek</th>
      <th>order_delivered_carrier_dayofweek</th>
      <th>review_creation_dayofweek</th>
      <th>order_estimated_delivery_dayofweek</th>
      <th>order_purchase_day_name</th>
      <th>order_purchase_day_part</th>
      <th>order_purchase_is_weekend</th>
      <th>order_delivered_customer_day_name</th>
      <th>order_delivered_customer_day_part</th>
      <th>order_delivered_customer_is_weekend</th>
      <th>order_approved_at_day_part</th>
      <th>order_approved_at_day_name</th>
      <th>order_approved_at_is_weekend</th>
      <th>order_delivered_carrier_day_name</th>
      <th>order_delivered_carrier_day_part</th>
      <th>order_delivered_carrier_is_weekend</th>
      <th>shipping_length</th>
      <th>seller_shipping_response</th>
      <th>seller_order_response</th>
      <th>shipping_status</th>
      <th>shipping_performance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>e481f51cbdc54678b7cc49136f2d6af7</td>
      <td>9ef432eb6251297304e76186b10a928d</td>
      <td>delivered</td>
      <td>2017-10-02 10:56:33</td>
      <td>2017-10-02 11:07:15</td>
      <td>2017-10-04 19:55:00</td>
      <td>2017-10-10 21:25:13</td>
      <td>2017-10-18</td>
      <td>1.0</td>
      <td>87285b34884572647811a353c7ac498a</td>
      <td>3504c0cb71d7fa48d967e0e4c94d59d9</td>
      <td>2017-10-06 11:07:15</td>
      <td>29.99</td>
      <td>8.72</td>
      <td>1</td>
      <td>credit_card</td>
      <td>1</td>
      <td>18.12</td>
      <td>a54f0611adc9ed256b57ede6b6eb5114</td>
      <td>4</td>
      <td>NaN</td>
      <td>Não testei o produto ainda, mas ele veio corre...</td>
      <td>2017-10-11</td>
      <td>2017-10-12 03:43:48</td>
      <td>utilidades_domesticas</td>
      <td>40.0</td>
      <td>268.0</td>
      <td>4.0</td>
      <td>500.0</td>
      <td>19.0</td>
      <td>8.0</td>
      <td>13.0</td>
      <td>7c396fd4830fd04220f754e42b4e5bff</td>
      <td>3149</td>
      <td>sao paulo</td>
      <td>SP</td>
      <td>9350</td>
      <td>maua</td>
      <td>SP</td>
      <td>2017</td>
      <td>2017</td>
      <td>2017.0</td>
      <td>2017</td>
      <td>2017.0</td>
      <td>2017.0</td>
      <td>2017</td>
      <td>2017</td>
      <td>Oct</td>
      <td>Oct</td>
      <td>10</td>
      <td>10</td>
      <td>10.0</td>
      <td>10</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10</td>
      <td>10</td>
      <td>12</td>
      <td>2</td>
      <td>10.0</td>
      <td>6</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>11</td>
      <td>18</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>4</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2</td>
      <td>2</td>
      <td>Monday</td>
      <td>late morning</td>
      <td>0</td>
      <td>Tuesday</td>
      <td>night</td>
      <td>0</td>
      <td>noon</td>
      <td>Monday</td>
      <td>0</td>
      <td>Wednesday</td>
      <td>evening</td>
      <td>0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>0.178333</td>
      <td>On Time</td>
      <td>Fast</td>
    </tr>
    <tr>
      <th>1</th>
      <td>e481f51cbdc54678b7cc49136f2d6af7</td>
      <td>9ef432eb6251297304e76186b10a928d</td>
      <td>delivered</td>
      <td>2017-10-02 10:56:33</td>
      <td>2017-10-02 11:07:15</td>
      <td>2017-10-04 19:55:00</td>
      <td>2017-10-10 21:25:13</td>
      <td>2017-10-18</td>
      <td>1.0</td>
      <td>87285b34884572647811a353c7ac498a</td>
      <td>3504c0cb71d7fa48d967e0e4c94d59d9</td>
      <td>2017-10-06 11:07:15</td>
      <td>29.99</td>
      <td>8.72</td>
      <td>3</td>
      <td>voucher</td>
      <td>1</td>
      <td>2.00</td>
      <td>a54f0611adc9ed256b57ede6b6eb5114</td>
      <td>4</td>
      <td>NaN</td>
      <td>Não testei o produto ainda, mas ele veio corre...</td>
      <td>2017-10-11</td>
      <td>2017-10-12 03:43:48</td>
      <td>utilidades_domesticas</td>
      <td>40.0</td>
      <td>268.0</td>
      <td>4.0</td>
      <td>500.0</td>
      <td>19.0</td>
      <td>8.0</td>
      <td>13.0</td>
      <td>7c396fd4830fd04220f754e42b4e5bff</td>
      <td>3149</td>
      <td>sao paulo</td>
      <td>SP</td>
      <td>9350</td>
      <td>maua</td>
      <td>SP</td>
      <td>2017</td>
      <td>2017</td>
      <td>2017.0</td>
      <td>2017</td>
      <td>2017.0</td>
      <td>2017.0</td>
      <td>2017</td>
      <td>2017</td>
      <td>Oct</td>
      <td>Oct</td>
      <td>10</td>
      <td>10</td>
      <td>10.0</td>
      <td>10</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10</td>
      <td>10</td>
      <td>12</td>
      <td>2</td>
      <td>10.0</td>
      <td>6</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>11</td>
      <td>18</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>4</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2</td>
      <td>2</td>
      <td>Monday</td>
      <td>late morning</td>
      <td>0</td>
      <td>Tuesday</td>
      <td>night</td>
      <td>0</td>
      <td>noon</td>
      <td>Monday</td>
      <td>0</td>
      <td>Wednesday</td>
      <td>evening</td>
      <td>0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>0.178333</td>
      <td>On Time</td>
      <td>Fast</td>
    </tr>
    <tr>
      <th>2</th>
      <td>e481f51cbdc54678b7cc49136f2d6af7</td>
      <td>9ef432eb6251297304e76186b10a928d</td>
      <td>delivered</td>
      <td>2017-10-02 10:56:33</td>
      <td>2017-10-02 11:07:15</td>
      <td>2017-10-04 19:55:00</td>
      <td>2017-10-10 21:25:13</td>
      <td>2017-10-18</td>
      <td>1.0</td>
      <td>87285b34884572647811a353c7ac498a</td>
      <td>3504c0cb71d7fa48d967e0e4c94d59d9</td>
      <td>2017-10-06 11:07:15</td>
      <td>29.99</td>
      <td>8.72</td>
      <td>2</td>
      <td>voucher</td>
      <td>1</td>
      <td>18.59</td>
      <td>a54f0611adc9ed256b57ede6b6eb5114</td>
      <td>4</td>
      <td>NaN</td>
      <td>Não testei o produto ainda, mas ele veio corre...</td>
      <td>2017-10-11</td>
      <td>2017-10-12 03:43:48</td>
      <td>utilidades_domesticas</td>
      <td>40.0</td>
      <td>268.0</td>
      <td>4.0</td>
      <td>500.0</td>
      <td>19.0</td>
      <td>8.0</td>
      <td>13.0</td>
      <td>7c396fd4830fd04220f754e42b4e5bff</td>
      <td>3149</td>
      <td>sao paulo</td>
      <td>SP</td>
      <td>9350</td>
      <td>maua</td>
      <td>SP</td>
      <td>2017</td>
      <td>2017</td>
      <td>2017.0</td>
      <td>2017</td>
      <td>2017.0</td>
      <td>2017.0</td>
      <td>2017</td>
      <td>2017</td>
      <td>Oct</td>
      <td>Oct</td>
      <td>10</td>
      <td>10</td>
      <td>10.0</td>
      <td>10</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10</td>
      <td>10</td>
      <td>12</td>
      <td>2</td>
      <td>10.0</td>
      <td>6</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>11</td>
      <td>18</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>4</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2</td>
      <td>2</td>
      <td>Monday</td>
      <td>late morning</td>
      <td>0</td>
      <td>Tuesday</td>
      <td>night</td>
      <td>0</td>
      <td>noon</td>
      <td>Monday</td>
      <td>0</td>
      <td>Wednesday</td>
      <td>evening</td>
      <td>0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>0.178333</td>
      <td>On Time</td>
      <td>Fast</td>
    </tr>
    <tr>
      <th>3</th>
      <td>128e10d95713541c87cd1a2e48201934</td>
      <td>a20e8105f23924cd00833fd87daa0831</td>
      <td>delivered</td>
      <td>2017-08-15 18:29:31</td>
      <td>2017-08-15 20:05:16</td>
      <td>2017-08-17 15:28:33</td>
      <td>2017-08-18 14:44:43</td>
      <td>2017-08-28</td>
      <td>1.0</td>
      <td>87285b34884572647811a353c7ac498a</td>
      <td>3504c0cb71d7fa48d967e0e4c94d59d9</td>
      <td>2017-08-21 20:05:16</td>
      <td>29.99</td>
      <td>7.78</td>
      <td>1</td>
      <td>credit_card</td>
      <td>3</td>
      <td>37.77</td>
      <td>b46f1e34512b0f4c74a72398b03ca788</td>
      <td>4</td>
      <td>NaN</td>
      <td>Deveriam embalar melhor o produto. A caixa vei...</td>
      <td>2017-08-19</td>
      <td>2017-08-20 15:16:36</td>
      <td>utilidades_domesticas</td>
      <td>40.0</td>
      <td>268.0</td>
      <td>4.0</td>
      <td>500.0</td>
      <td>19.0</td>
      <td>8.0</td>
      <td>13.0</td>
      <td>3a51803cc0d012c3b5dc8b7528cb05f7</td>
      <td>3366</td>
      <td>sao paulo</td>
      <td>SP</td>
      <td>9350</td>
      <td>maua</td>
      <td>SP</td>
      <td>2017</td>
      <td>2017</td>
      <td>2017.0</td>
      <td>2017</td>
      <td>2017.0</td>
      <td>2017.0</td>
      <td>2017</td>
      <td>2017</td>
      <td>Aug</td>
      <td>Aug</td>
      <td>8</td>
      <td>8</td>
      <td>8.0</td>
      <td>8</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8</td>
      <td>8</td>
      <td>20</td>
      <td>15</td>
      <td>18.0</td>
      <td>21</td>
      <td>15.0</td>
      <td>17.0</td>
      <td>19</td>
      <td>28</td>
      <td>6</td>
      <td>1</td>
      <td>4.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5</td>
      <td>0</td>
      <td>Tuesday</td>
      <td>evening</td>
      <td>0</td>
      <td>Friday</td>
      <td>afternoon</td>
      <td>0</td>
      <td>night</td>
      <td>Tuesday</td>
      <td>0</td>
      <td>Thursday</td>
      <td>afternoon</td>
      <td>0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.595833</td>
      <td>On Time</td>
      <td>Fast</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0e7e841ddf8f8f2de2bad69267ecfbcf</td>
      <td>26c7ac168e1433912a51b924fbd34d34</td>
      <td>delivered</td>
      <td>2017-08-02 18:24:47</td>
      <td>2017-08-02 18:43:15</td>
      <td>2017-08-04 17:35:43</td>
      <td>2017-08-07 18:30:01</td>
      <td>2017-08-15</td>
      <td>1.0</td>
      <td>87285b34884572647811a353c7ac498a</td>
      <td>3504c0cb71d7fa48d967e0e4c94d59d9</td>
      <td>2017-08-08 18:37:31</td>
      <td>29.99</td>
      <td>7.78</td>
      <td>1</td>
      <td>credit_card</td>
      <td>1</td>
      <td>37.77</td>
      <td>dc90f19c2806f1abba9e72ad3c350073</td>
      <td>5</td>
      <td>NaN</td>
      <td>Só achei ela pequena pra seis xícaras ,mais é ...</td>
      <td>2017-08-08</td>
      <td>2017-08-08 23:26:23</td>
      <td>utilidades_domesticas</td>
      <td>40.0</td>
      <td>268.0</td>
      <td>4.0</td>
      <td>500.0</td>
      <td>19.0</td>
      <td>8.0</td>
      <td>13.0</td>
      <td>ef0996a1a279c26e7ecbd737be23d235</td>
      <td>2290</td>
      <td>sao paulo</td>
      <td>SP</td>
      <td>9350</td>
      <td>maua</td>
      <td>SP</td>
      <td>2017</td>
      <td>2017</td>
      <td>2017.0</td>
      <td>2017</td>
      <td>2017.0</td>
      <td>2017.0</td>
      <td>2017</td>
      <td>2017</td>
      <td>Aug</td>
      <td>Aug</td>
      <td>8</td>
      <td>8</td>
      <td>8.0</td>
      <td>8</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>2</td>
      <td>7.0</td>
      <td>8</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>8</td>
      <td>15</td>
      <td>1</td>
      <td>2</td>
      <td>0.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>1</td>
      <td>1</td>
      <td>Wednesday</td>
      <td>evening</td>
      <td>0</td>
      <td>Monday</td>
      <td>evening</td>
      <td>0</td>
      <td>evening</td>
      <td>Wednesday</td>
      <td>0</td>
      <td>Friday</td>
      <td>evening</td>
      <td>0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>0.307778</td>
      <td>On Time</td>
      <td>Fast</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-17ab49d2-2d50-4ad5-bb1f-4cb6ea24af29')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-17ab49d2-2d50-4ad5-bb1f-4cb6ea24af29 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-17ab49d2-2d50-4ad5-bb1f-4cb6ea24af29');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;product_volume&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;product_height_cm&#39;</span>] <span style="color:#f92672">*</span> cus360[<span style="color:#e6db74">&#39;product_length_cm&#39;</span>] <span style="color:#f92672">*</span> cus360[<span style="color:#e6db74">&#39;product_width_cm&#39;</span>]
</span></span></code></pre></div><h4 id="product-category-translation">Product Category Translation</h4>
<p>Nama Kategori Produk secara default tersedia dalam bahasa brazil. Untuk memudahkan analisis, terdapat pula hasil translasi dalam bahas inggris.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>product_cat_names_eng <span style="color:#f92672">=</span> dict(zip(translate<span style="color:#f92672">.</span>product_category_name, 
</span></span><span style="display:flex;"><span>                                 translate<span style="color:#f92672">.</span>product_category_name_english))
</span></span><span style="display:flex;"><span>cus360<span style="color:#f92672">.</span>replace({<span style="color:#e6db74">&#34;product_category_name&#34;</span>:product_cat_names_eng}, inplace <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><h3 id="imputing-categorical-attributes">Imputing Categorical Attributes</h3>
<p>Beberapa data yang memiliki tipe categorical perlu kita lakukan imputasi untuk memperjelas dan mempermudah eksplorasi</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cats <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> cus360<span style="color:#f92672">.</span>columns:
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> cus360[i]<span style="color:#f92672">.</span>dtype <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;object&#39;</span>:
</span></span><span style="display:flex;"><span>    cats<span style="color:#f92672">.</span>append(i)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>resumetable(cus360[cats])
</span></span></code></pre></div><pre><code>Dataset Shape: (117329, 27)
</code></pre>
  <div id="df-d99034a5-fbfe-497b-a152-8dbd51e9b325">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Name</th>
      <th>dtypes</th>
      <th>Missing</th>
      <th>Uniques</th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>review_comment_title</td>
      <td>object</td>
      <td>103437</td>
      <td>4497</td>
      <td>0.881598</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8</td>
      <td>review_comment_message</td>
      <td>object</td>
      <td>67650</td>
      <td>35691</td>
      <td>0.576584</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26</td>
      <td>shipping_performance</td>
      <td>object</td>
      <td>2471</td>
      <td>3</td>
      <td>0.021060</td>
    </tr>
    <tr>
      <th>3</th>
      <td>19</td>
      <td>order_delivered_customer_day_name</td>
      <td>object</td>
      <td>2471</td>
      <td>7</td>
      <td>0.021060</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>product_category_name</td>
      <td>object</td>
      <td>1695</td>
      <td>73</td>
      <td>0.014447</td>
    </tr>
    <tr>
      <th>5</th>
      <td>23</td>
      <td>order_delivered_carrier_day_name</td>
      <td>object</td>
      <td>1235</td>
      <td>7</td>
      <td>0.010526</td>
    </tr>
    <tr>
      <th>6</th>
      <td>25</td>
      <td>shipping_status</td>
      <td>object</td>
      <td>15</td>
      <td>2</td>
      <td>0.000128</td>
    </tr>
    <tr>
      <th>7</th>
      <td>22</td>
      <td>order_approved_at_day_name</td>
      <td>object</td>
      <td>15</td>
      <td>7</td>
      <td>0.000128</td>
    </tr>
    <tr>
      <th>8</th>
      <td>15</td>
      <td>order_purchase_month</td>
      <td>object</td>
      <td>0</td>
      <td>12</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>24</td>
      <td>order_delivered_carrier_day_part</td>
      <td>object</td>
      <td>0</td>
      <td>8</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>21</td>
      <td>order_approved_at_day_part</td>
      <td>object</td>
      <td>0</td>
      <td>8</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>20</td>
      <td>order_delivered_customer_day_part</td>
      <td>object</td>
      <td>0</td>
      <td>8</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>18</td>
      <td>order_purchase_day_part</td>
      <td>object</td>
      <td>0</td>
      <td>8</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>17</td>
      <td>order_purchase_day_name</td>
      <td>object</td>
      <td>0</td>
      <td>7</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>16</td>
      <td>review_answer_month</td>
      <td>object</td>
      <td>0</td>
      <td>12</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0</td>
      <td>order_id</td>
      <td>object</td>
      <td>0</td>
      <td>97916</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>14</td>
      <td>sel_state</td>
      <td>object</td>
      <td>0</td>
      <td>23</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1</td>
      <td>customer_id</td>
      <td>object</td>
      <td>0</td>
      <td>97916</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>18</th>
      <td>12</td>
      <td>cust_state</td>
      <td>object</td>
      <td>0</td>
      <td>27</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>19</th>
      <td>11</td>
      <td>cust_city</td>
      <td>object</td>
      <td>0</td>
      <td>4108</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>20</th>
      <td>10</td>
      <td>customer_unique_id</td>
      <td>object</td>
      <td>0</td>
      <td>94720</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>21</th>
      <td>6</td>
      <td>review_id</td>
      <td>object</td>
      <td>0</td>
      <td>97708</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>22</th>
      <td>5</td>
      <td>payment_type</td>
      <td>object</td>
      <td>0</td>
      <td>4</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>23</th>
      <td>4</td>
      <td>seller_id</td>
      <td>object</td>
      <td>0</td>
      <td>3090</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>24</th>
      <td>3</td>
      <td>product_id</td>
      <td>object</td>
      <td>0</td>
      <td>32789</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2</td>
      <td>order_status</td>
      <td>object</td>
      <td>0</td>
      <td>7</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>26</th>
      <td>13</td>
      <td>sel_city</td>
      <td>object</td>
      <td>0</td>
      <td>611</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d99034a5-fbfe-497b-a152-8dbd51e9b325')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-d99034a5-fbfe-497b-a152-8dbd51e9b325 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-d99034a5-fbfe-497b-a152-8dbd51e9b325');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h4 id="product-category-name">Product Category Name</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;product_category_name&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;product_category_name&#39;</span>]<span style="color:#f92672">.</span>fillna(<span style="color:#e6db74">&#39;others&#39;</span>)
</span></span></code></pre></div><p>Mengisi dengan nilai <code>others</code> pada kategori yang minoritas (peringkat terbanyak 20 kebawah)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>relabel_categories <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;product_category_name&#39;</span>]<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>index[<span style="color:#ae81ff">20</span>:]
</span></span><span style="display:flex;"><span>cus360<span style="color:#f92672">.</span>product_category_name[cus360[<span style="color:#e6db74">&#39;product_category_name&#39;</span>]<span style="color:#f92672">.</span>isin(relabel_categories)] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;others&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360<span style="color:#f92672">.</span>product_category_name<span style="color:#f92672">.</span>isna()<span style="color:#f92672">.</span>sum()
</span></span></code></pre></div><pre><code>0
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360<span style="color:#f92672">.</span>product_category_name<span style="color:#f92672">.</span>value_counts()
</span></span></code></pre></div><pre><code>others                      16301
bed_bath_table              11847
health_beauty                9944
sports_leisure               8942
furniture_decor              8743
computers_accessories        8105
housewares                   7331
watches_gifts                6161
telephony                    4692
garden_tools                 4558
auto                         4356
toys                         4246
cool_stuff                   3964
perfumery                    3575
baby                         3178
electronics                  2827
stationery                   2607
fashion_bags_accessories     2159
pet_shop                     2020
office_furniture             1773
Name: product_category_name, dtype: int64
</code></pre>
<h4 id="review-comment-title">Review Comment Title</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;review_comment_title&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;review_comment_title&#39;</span>]<span style="color:#f92672">.</span>fillna(<span style="color:#e6db74">&#39;untitled&#39;</span>)
</span></span></code></pre></div><h4 id="review-comment-message">Review Comment Message</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;review_comment_message&#39;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#39;review_comment_message&#39;</span>]<span style="color:#f92672">.</span>fillna(<span style="color:#e6db74">&#39;no message&#39;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>resumetable(cus360[cats])
</span></span></code></pre></div><pre><code>Dataset Shape: (117329, 27)
</code></pre>
  <div id="df-16c16167-c920-47a9-a42e-4815ccce5de5">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Name</th>
      <th>dtypes</th>
      <th>Missing</th>
      <th>Uniques</th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26</td>
      <td>shipping_performance</td>
      <td>object</td>
      <td>2471</td>
      <td>3</td>
      <td>0.021060</td>
    </tr>
    <tr>
      <th>1</th>
      <td>19</td>
      <td>order_delivered_customer_day_name</td>
      <td>object</td>
      <td>2471</td>
      <td>7</td>
      <td>0.021060</td>
    </tr>
    <tr>
      <th>2</th>
      <td>23</td>
      <td>order_delivered_carrier_day_name</td>
      <td>object</td>
      <td>1235</td>
      <td>7</td>
      <td>0.010526</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25</td>
      <td>shipping_status</td>
      <td>object</td>
      <td>15</td>
      <td>2</td>
      <td>0.000128</td>
    </tr>
    <tr>
      <th>4</th>
      <td>22</td>
      <td>order_approved_at_day_name</td>
      <td>object</td>
      <td>15</td>
      <td>7</td>
      <td>0.000128</td>
    </tr>
    <tr>
      <th>5</th>
      <td>14</td>
      <td>sel_state</td>
      <td>object</td>
      <td>0</td>
      <td>23</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>24</td>
      <td>order_delivered_carrier_day_part</td>
      <td>object</td>
      <td>0</td>
      <td>8</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>21</td>
      <td>order_approved_at_day_part</td>
      <td>object</td>
      <td>0</td>
      <td>8</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>20</td>
      <td>order_delivered_customer_day_part</td>
      <td>object</td>
      <td>0</td>
      <td>8</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>18</td>
      <td>order_purchase_day_part</td>
      <td>object</td>
      <td>0</td>
      <td>8</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>17</td>
      <td>order_purchase_day_name</td>
      <td>object</td>
      <td>0</td>
      <td>7</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>16</td>
      <td>review_answer_month</td>
      <td>object</td>
      <td>0</td>
      <td>12</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>15</td>
      <td>order_purchase_month</td>
      <td>object</td>
      <td>0</td>
      <td>12</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
      <td>order_id</td>
      <td>object</td>
      <td>0</td>
      <td>97916</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1</td>
      <td>customer_id</td>
      <td>object</td>
      <td>0</td>
      <td>97916</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>12</td>
      <td>cust_state</td>
      <td>object</td>
      <td>0</td>
      <td>27</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>11</td>
      <td>cust_city</td>
      <td>object</td>
      <td>0</td>
      <td>4108</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>17</th>
      <td>10</td>
      <td>customer_unique_id</td>
      <td>object</td>
      <td>0</td>
      <td>94720</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>18</th>
      <td>9</td>
      <td>product_category_name</td>
      <td>object</td>
      <td>0</td>
      <td>20</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>19</th>
      <td>8</td>
      <td>review_comment_message</td>
      <td>object</td>
      <td>0</td>
      <td>35692</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>20</th>
      <td>7</td>
      <td>review_comment_title</td>
      <td>object</td>
      <td>0</td>
      <td>4498</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>21</th>
      <td>6</td>
      <td>review_id</td>
      <td>object</td>
      <td>0</td>
      <td>97708</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>22</th>
      <td>5</td>
      <td>payment_type</td>
      <td>object</td>
      <td>0</td>
      <td>4</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>23</th>
      <td>4</td>
      <td>seller_id</td>
      <td>object</td>
      <td>0</td>
      <td>3090</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>24</th>
      <td>3</td>
      <td>product_id</td>
      <td>object</td>
      <td>0</td>
      <td>32789</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2</td>
      <td>order_status</td>
      <td>object</td>
      <td>0</td>
      <td>7</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>26</th>
      <td>13</td>
      <td>sel_city</td>
      <td>object</td>
      <td>0</td>
      <td>611</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-16c16167-c920-47a9-a42e-4815ccce5de5')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-16c16167-c920-47a9-a42e-4815ccce5de5 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-16c16167-c920-47a9-a42e-4815ccce5de5');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h2 id="eda-exploratory-data-analysis">EDA (Exploratory Data Analysis)</h2>
<h3 id="review-score">Review Score</h3>
<p>Disini kita akan melihat bagaimana review score didistribusikan</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Persentase Score Review:&#39;</span>)
</span></span><span style="display:flex;"><span>print(cus360[[<span style="color:#e6db74">&#34;review_score&#34;</span>]]<span style="color:#f92672">.</span>value_counts() <span style="color:#f92672">/</span> cus360[<span style="color:#e6db74">&#34;review_score&#34;</span>]<span style="color:#f92672">.</span>count() <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Jumlah masing&#34; Score Review:&#39;</span>)
</span></span><span style="display:flex;"><span>print(cus360[[<span style="color:#e6db74">&#34;review_score&#34;</span>]]<span style="color:#f92672">.</span>value_counts())
</span></span></code></pre></div><pre><code>Persentase Score Review:
review_score
5               56.477086
4               18.994451
1               12.660127
3                8.386673
2                3.481663
dtype: float64
Jumlah masing&quot; Score Review:
review_score
5               66264
4               22286
1               14854
3                9840
2                4085
dtype: int64
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>showData <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>countplot(cus360[<span style="color:#e6db74">&#34;review_score&#34;</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Jumlah&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Distribusi Review Score&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show(showData)
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;review_score&#39;</span>]<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>plot<span style="color:#f92672">.</span>pie(autopct<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%1.2f%%</span><span style="color:#e6db74">&#39;</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Distribusi Review Score&#34;</span>)
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_126_0.png" alt="png"></p>
<pre><code>Text(0.5, 1.0, 'Distribusi Review Score')
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_126_2.png" alt="png"></p>
<p>Dari grafik diatas dapat kita lihat bahwa sekitar 75% memberikan nilai review yang baik (skor 4 atau 5). Skor review 1 berada pada kisaran 12,5%, angka ini masih cukup besar jika dilihat dari jumlah keseluruhan review pada data. Saya ingin mencari tahu apa yang menyebabkan customer memberikan skor review, terutama skor 1.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>scoreOne <span style="color:#f92672">=</span> cus360[cus360[<span style="color:#e6db74">&#39;review_score&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>scoreOne <span style="color:#f92672">=</span> scoreOne<span style="color:#f92672">.</span>drop_duplicates()
</span></span><span style="display:flex;"><span>scoreOne[[<span style="color:#e6db74">&#39;product_category_name&#39;</span>, <span style="color:#e6db74">&#39;price&#39;</span>, <span style="color:#e6db74">&#39;review_comment_title&#39;</span>, <span style="color:#e6db74">&#39;review_comment_message&#39;</span>]]<span style="color:#f92672">.</span>head()
</span></span></code></pre></div>  <div id="df-aa472c22-4951-42b9-8d58-455708dc52e9">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>product_category_name</th>
      <th>price</th>
      <th>review_comment_title</th>
      <th>review_comment_message</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>45</th>
      <td>housewares</td>
      <td>46.8</td>
      <td>untitled</td>
      <td>Prezados que porcaria de atendimento ao client...</td>
    </tr>
    <tr>
      <th>82</th>
      <td>perfumery</td>
      <td>116.9</td>
      <td>Produto falsificado</td>
      <td>A embalagem do perfume é original, mas a essên...</td>
    </tr>
    <tr>
      <th>88</th>
      <td>perfumery</td>
      <td>117.8</td>
      <td>Não recebi os dois produt</td>
      <td>Recebi apenas 1 perfume (perfume H2O). O perfu...</td>
    </tr>
    <tr>
      <th>103</th>
      <td>perfumery</td>
      <td>119.8</td>
      <td>untitled</td>
      <td>o produto entregue não foi o mesmo que eu pedi...</td>
    </tr>
    <tr>
      <th>127</th>
      <td>perfumery</td>
      <td>119.8</td>
      <td>untitled</td>
      <td>Xxx</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-aa472c22-4951-42b9-8d58-455708dc52e9')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-aa472c22-4951-42b9-8d58-455708dc52e9 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-aa472c22-4951-42b9-8d58-455708dc52e9');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<p>Di bawah ini akan saya tampilkan 50 data review yang beberapa diantaranya tertulis terkait pelayanan yang kurang memuaskan yang menjadi alasan pelanggan memberikan rating review 1. Pelayanan seperti barang yang tidak memiliki kondisi seperti yang dijelaskan di deskripsi, jumlah barang yang tidak sesuai jumlah pesanan adalah salah satu isi review.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>scoreOne[<span style="color:#e6db74">&#39;review_comment_message&#39;</span>]<span style="color:#f92672">.</span>drop_duplicates()<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">50</span>)
</span></span></code></pre></div><pre><code>45     Prezados que porcaria de atendimento ao client...
82     A embalagem do perfume é original, mas a essên...
88     Recebi apenas 1 perfume (perfume H2O). O perfu...
103    o produto entregue não foi o mesmo que eu pedi...
127                                                  Xxx
161    O produto nizzio Amore Hidratação Avançada 245...
189    O produto está na transportadora há dias e até...
201                                 Péssimo atendimento!
234    Não entregou o produto, confiou aos correios e...
239           Me entregaram FALTANDO um vidro de perfume
266                        Não comprarei mais mesa loja.
295    Vivemos no país da mentira. Brasil. Duvida? En...
308             Recebi outro perfume e não o emcomendado
331                                           no message
360    O produto era pra chegar no dia 05/04 no entan...
363               Consta que foi entregue mas não recebi
389    Não acredito q comprei um presente de Natal em...
416    Não recebi o pedido no tempo estimado e não fu...
417    realizei a compra, e não entregara!!! estou ca...
451                  Meu produto não foi entregue ainda 
472    Desde que comprei vinha tentando cancelar, mas...
474    produto ainda não foi entregue, depois de dias...
476    Comprei um produto na esperança de chegar na d...
496    Já fiz a solicitação de devolver a compra e já...
516    Estou totalmente insatisfeito com a compra do ...
521    Até o momento recebi apenas a lixeira. Nao rec...
530    ainda não recebi meu produto e quero saber com...
535    Comprei um relógio por ORIGINAL, além de vir f...
537    Já está no quinto dia de atraso com o prazo qu...
544    Não tenho informações nenhuma do meu pedido, s...
548    atraso na entrega, não recomendo a loja pois e...
564    To esperando até agora meu relógio, mais 2 dia...
567                        Estou aguardando meu produto.
584    Bom, o relógio é lindo, porem estou desconfiad...
601     Paguei o frete e o meu protudo não foi entregueb
609    Comprei o relógio dia 20/02 pensando em dar de...
614    Solicitei um produto e veio outro. Já entrei e...
624    A ENTREGA ESTA PARA DIA 04/04 E ATÉ O MOMENTO ...
664    Recebi o produto no prazo, mas não gostei do r...
671          Não recomendo. Não recebi. Quero reembolso.
683    Não recomendaria a targaryen a outros comprado...
687    As descrições desse relógio não diz o tamanho ...
700                                        Quero receber
787    comprei relogio de homem e recebi relogio de c...
816    Comprei e paguei por dois produtos iguais e só...
825                             Loja sem credibilidade. 
847    Péssima entrega fiz a compra no dia 13/02 e at...
895    só recebi um dos produtos, quando na verdade e...
922    Eu comprei o produto, a qualidade dele não é a...
933    Estou aguardando o envio do produto há mais de...
Name: review_comment_message, dtype: object
</code></pre>
<p>Berikut adalah 20 data kategori teratas pada barang yang mendapat rating 1, kecuali others, beserta tampilan semua data tersebut dalam bentuk grafik</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>no_other <span style="color:#f92672">=</span> scoreOne[<span style="color:#e6db74">&#39;product_category_name&#39;</span>][scoreOne[<span style="color:#e6db74">&#39;product_category_name&#39;</span>] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;others&#39;</span>]
</span></span><span style="display:flex;"><span>no_other<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>head(<span style="color:#ae81ff">20</span>)<span style="color:#f92672">.</span>sort_values(ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span></code></pre></div><pre><code>bed_bath_table              1724
furniture_decor             1303
computers_accessories       1199
health_beauty               1128
sports_leisure              1061
housewares                   869
watches_gifts                780
garden_tools                 602
telephony                    600
auto                         512
toys                         463
perfumery                    440
baby                         421
cool_stuff                   396
office_furniture             360
electronics                  332
stationery                   252
fashion_bags_accessories     224
pet_shop                     196
Name: product_category_name, dtype: int64
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>showData <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>countplot(data<span style="color:#f92672">=</span>cus360, y<span style="color:#f92672">=</span>no_other, order <span style="color:#f92672">=</span> no_other<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>index)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Count&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Product category dengan review score 1&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show(showData)
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_133_0.png" alt="png"></p>
<h3 id="most-revenued-customer">Most Revenued Customer</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Customer dengan jumlah order terbanyak</span>
</span></span><span style="display:flex;"><span>top_customers <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;customer_unique_id&#34;</span>)[<span style="color:#e6db74">&#34;payment_value&#34;</span>]<span style="color:#f92672">.</span>sum()<span style="color:#f92672">.</span>reset_index()<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#34;payment_value&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>top_customers<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;payment_value&#34;</span>:<span style="color:#e6db74">&#34;total_paid&#34;</span>}, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>top_customers[<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f Total Sales&#34;</span>] <span style="color:#f92672">=</span> (top_customers[<span style="color:#e6db74">&#34;total_paid&#34;</span>] <span style="color:#f92672">/</span> top_customers[<span style="color:#e6db74">&#34;total_paid&#34;</span>]<span style="color:#f92672">.</span>sum()) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>top_customers[<span style="color:#e6db74">&#34;Cum </span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f Total Sales&#34;</span>] <span style="color:#f92672">=</span> top_customers[<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f Total Sales&#34;</span>]<span style="color:#f92672">.</span>cumsum() 
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>lineplot(x<span style="color:#f92672">=</span>range(<span style="color:#ae81ff">1</span>,len(top_customers)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Cum </span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f Total Sales&#34;</span>, data<span style="color:#f92672">=</span>top_customers)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#34;N° of Customers&#34;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;Persentase Kontribusi terhadap penjualan berdasarkan jumlah customer&#34;</span>)
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>,len(top_customers)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>b<span style="color:#f92672">=</span>top_customers[<span style="color:#e6db74">&#34;Cum </span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f Total Sales&#34;</span>]
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>fill_between(a, b, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>                 where <span style="color:#f92672">=</span> (a <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">&amp;</span> (a <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">40000</span>),
</span></span><span style="display:flex;"><span>                 color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;royalblue&#39;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>text(<span style="color:#ae81ff">42000</span>, <span style="color:#ae81ff">70</span>, <span style="color:#e6db74">&#34;&#34;&#34;40000 customer (sekitar 42</span><span style="color:#e6db74">% d</span><span style="color:#e6db74">ari total customer) 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">berkontribusi pada sekitar 80</span><span style="color:#e6db74">% d</span><span style="color:#e6db74">ari total penjualan&#34;&#34;&#34;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
</span></span></code></pre></div><pre><code>Text(42000, 70, '40000 customer (sekitar 42% dari total customer) \nberkontribusi pada sekitar 80% dari total penjualan')
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_136_1.png" alt="png"></p>
<p>40000 customers (sekitar 42% of total customers) berkontribusi pada sekitar 80% dari total penjualan</p>
<h3 id="top-customers">Top Customers</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>top_customers<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;payment_value&#34;</span> : <span style="color:#e6db74">&#34;total_paid&#34;</span>}, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>barplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;total_paid&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;customer_unique_id&#34;</span>, data<span style="color:#f92672">=</span>top_customers[:<span style="color:#ae81ff">10</span>])
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;Top 10 Customers berdasarkan total pembayaran&#34;</span>)
</span></span></code></pre></div><pre><code>Text(0.5, 1.0, 'Top 10 Customers berdasarkan total pembayaran')
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_139_1.png" alt="png"></p>
<h3 id="top-cites-by-number-of-orders-by-state">Top Cites by number of orders by state</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>top_orders_cities <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;cust_state&#34;</span>)[<span style="color:#e6db74">&#34;order_id&#34;</span>]<span style="color:#f92672">.</span>count()<span style="color:#f92672">.</span>reset_index()<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#34;order_id&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>top_orders_cities<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;order_id&#34;</span>:<span style="color:#e6db74">&#34;count&#34;</span>}, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>barplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;count&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;cust_state&#34;</span>, data<span style="color:#f92672">=</span>top_orders_cities[:<span style="color:#ae81ff">10</span>])
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;TOP 10 states berdasarkan jumlah order&#34;</span>)
</span></span></code></pre></div><pre><code>Text(0.5, 1.0, 'TOP 10 states berdasarkan jumlah order')
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_141_1.png" alt="png"></p>
<h3 id="highest-revenued-cities">Highest Revenued Cities</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>top_ordersbyvalue_cities <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;cust_city&#34;</span>)[<span style="color:#e6db74">&#34;payment_value&#34;</span>]<span style="color:#f92672">.</span>sum()<span style="color:#f92672">.</span>reset_index()<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#34;payment_value&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>top_ordersbyvalue_cities[<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f Total Payments&#34;</span>] <span style="color:#f92672">=</span> (top_ordersbyvalue_cities[<span style="color:#e6db74">&#34;payment_value&#34;</span>] <span style="color:#f92672">/</span> top_ordersbyvalue_cities[<span style="color:#e6db74">&#34;payment_value&#34;</span>]<span style="color:#f92672">.</span>sum()) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>top_ordersbyvalue_cities[<span style="color:#e6db74">&#34;Cum </span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f Total Payments&#34;</span>] <span style="color:#f92672">=</span> top_ordersbyvalue_cities[<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f Total Payments&#34;</span>]<span style="color:#f92672">.</span>cumsum() 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>barplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f Total Payments&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;cust_city&#34;</span>, data<span style="color:#f92672">=</span>top_ordersbyvalue_cities[:<span style="color:#ae81ff">10</span>])
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;TOP 10 kota dengan revenue tertinggi&#34;</span>)
</span></span></code></pre></div><pre><code>Text(0.5, 1.0, 'TOP 10 kota dengan revenue tertinggi')
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_144_1.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">9</span>))
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>lineplot(x<span style="color:#f92672">=</span>range(<span style="color:#ae81ff">1</span>,len(top_ordersbyvalue_cities)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Cum </span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f Total Payments&#34;</span>, data<span style="color:#f92672">=</span>top_ordersbyvalue_cities)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#34;N° of cities&#34;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;Persentase Kontribusi pada penjualan berdasarkan jumlah kota&#34;</span>)
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>,len(top_ordersbyvalue_cities)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>b<span style="color:#f92672">=</span>top_ordersbyvalue_cities[<span style="color:#e6db74">&#34;Cum </span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f Total Payments&#34;</span>]
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>fill_between(a, b, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>                 where <span style="color:#f92672">=</span> (a <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">&amp;</span> (a <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">358</span>),
</span></span><span style="display:flex;"><span>                 color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;royalblue&#39;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>text(<span style="color:#ae81ff">1000</span>, <span style="color:#ae81ff">70</span>, <span style="color:#e6db74">&#34;&#34;&#34;358 Kota (sekitar 8.7 </span><span style="color:#e6db74">% d</span><span style="color:#e6db74">ari total kota) 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">berkontribusi pada sekitar 80</span><span style="color:#e6db74">% d</span><span style="color:#e6db74">ari total penjualan&#34;&#34;&#34;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
</span></span></code></pre></div><pre><code>Text(1000, 70, '358 Kota (sekitar 8.7 % dari total kota) \nberkontribusi pada sekitar 80% dari total penjualan')
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_145_1.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Jumlah kota yang berkontribusi pada 80% jumlah penjualan :&#34;</span>,
</span></span><span style="display:flex;"><span>      len(top_ordersbyvalue_cities[top_ordersbyvalue_cities[<span style="color:#e6db74">&#34;Cum </span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f Total Payments&#34;</span>] <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">80</span>]),
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;atau sekitar :&#34;</span>,
</span></span><span style="display:flex;"><span>      (len(top_ordersbyvalue_cities[top_ordersbyvalue_cities[<span style="color:#e6db74">&#34;Cum </span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f Total Payments&#34;</span>] <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">80</span>]) <span style="color:#f92672">/</span> len(top_ordersbyvalue_cities)) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>, <span style="color:#e6db74">&#39;%&#39;</span>)
</span></span></code></pre></div><pre><code>Jumlah kota yang berkontribusi pada 80% jumlah penjualan : 358 atau sekitar : 8.714703018500487 %
</code></pre>
<h3 id="sales-payments">Sales Payments</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#39;payment_type&#39;</span>]<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>plot<span style="color:#f92672">.</span>pie(autopct<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%1.2f%%</span><span style="color:#e6db74">&#39;</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">8</span>))
</span></span></code></pre></div><pre><code>&lt;AxesSubplot:ylabel='payment_type'&gt;
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_148_1.png" alt="png"></p>
<h3 id="order-vary-accross-the-time">Order Vary accross the time</h3>
<h4 id="order-by-hour">Order by Hour</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Orders by hour</span>
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#34;order_purchase_timestamp&#34;</span>] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>to_datetime(cus360[<span style="color:#e6db74">&#34;order_purchase_timestamp&#34;</span>])
</span></span><span style="display:flex;"><span>orderbyhour <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(cus360[<span style="color:#e6db74">&#34;order_purchase_timestamp&#34;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>hour)[<span style="color:#e6db74">&#34;order_id&#34;</span>]<span style="color:#f92672">.</span>count()<span style="color:#f92672">.</span>reset_index()<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;order_purchase_timestamp&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>orderbyhour<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;order_id&#34;</span>:<span style="color:#e6db74">&#34;Total Orders&#34;</span>, <span style="color:#e6db74">&#34;order_purchase_timestamp&#34;</span>: <span style="color:#e6db74">&#34;Hour of Day&#34;</span>}, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>orderbyhour<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Hour of Day&#34;</span>)
</span></span></code></pre></div>  <div id="df-e1ca120c-4ba1-4956-a2ba-97e4c330d32c">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Hour of Day</th>
      <th>Total Orders</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2882</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1333</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>605</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>316</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>254</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>224</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>569</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>1416</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>3507</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>5613</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>7318</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>7757</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
      <td>7165</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
      <td>7674</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
      <td>7894</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
      <td>7592</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
      <td>7954</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
      <td>7249</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
      <td>6848</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
      <td>6949</td>
    </tr>
    <tr>
      <th>20</th>
      <td>20</td>
      <td>7206</td>
    </tr>
    <tr>
      <th>21</th>
      <td>21</td>
      <td>7225</td>
    </tr>
    <tr>
      <th>22</th>
      <td>22</td>
      <td>6917</td>
    </tr>
    <tr>
      <th>23</th>
      <td>23</td>
      <td>4862</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e1ca120c-4ba1-4956-a2ba-97e4c330d32c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-e1ca120c-4ba1-4956-a2ba-97e4c330d32c button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-e1ca120c-4ba1-4956-a2ba-97e4c330d32c');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Visualize data</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>barplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Hour of Day&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Total Orders&#34;</span>, data<span style="color:#f92672">=</span>orderbyhour)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;Orders by hour&#34;</span>)
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>lineplot(data <span style="color:#f92672">=</span> orderbyhour, marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;o&#39;</span>, sort <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>, ax<span style="color:#f92672">=</span>ax)
</span></span></code></pre></div><pre><code>&lt;AxesSubplot:title={'center':'Orders by hour'}, xlabel='Hour of Day', ylabel='Total Orders'&gt;
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_153_1.png" alt="png"></p>
<p>Order mulai meningkat pada jam 6 pagi, dan mulai turun pada jam 4 sore</p>
<h4 id="order-by-day">Order by Day</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Orders by day of the week</span>
</span></span><span style="display:flex;"><span>orderbydow <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(cus360[<span style="color:#e6db74">&#34;order_purchase_timestamp&#34;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>day_name())[<span style="color:#e6db74">&#34;order_id&#34;</span>]<span style="color:#f92672">.</span>count()<span style="color:#f92672">.</span>reset_index()
</span></span><span style="display:flex;"><span>orderbydow<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;order_id&#34;</span>:<span style="color:#e6db74">&#34;Total Orders&#34;</span>, <span style="color:#e6db74">&#34;order_purchase_timestamp&#34;</span>: <span style="color:#e6db74">&#34;Weekday Name&#34;</span>}, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>orderbydow <span style="color:#f92672">=</span> orderbydow<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Total Orders&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize <span style="color:#f92672">=</span> (<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>barplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Weekday Name&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Total Orders&#34;</span>, data<span style="color:#f92672">=</span>orderbydow)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;N° of Orders by DOW&#34;</span>)
</span></span></code></pre></div><pre><code>Text(0.5, 1.0, 'N° of Orders by DOW')
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_157_1.png" alt="png"></p>
<p>Order tercatat cukup tinggi pada hari Senin dan Selasa, sedangkan mulai turun saat memasuki weekend.</p>
<h4 id="orders-in-weekend">Orders in Weekend</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Orders in weekend</span>
</span></span><span style="display:flex;"><span>orderinwn <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(cus360[<span style="color:#e6db74">&#34;order_purchase_is_weekend&#34;</span>])[<span style="color:#e6db74">&#34;order_id&#34;</span>]<span style="color:#f92672">.</span>count()<span style="color:#f92672">.</span>reset_index()<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;order_purchase_is_weekend&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>orderinwn<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;order_id&#34;</span>:<span style="color:#e6db74">&#34;Total Orders&#34;</span>, <span style="color:#e6db74">&#34;order_purchase_is_weekend&#34;</span>: <span style="color:#e6db74">&#34;Is Weekend&#34;</span>}, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>orderinwn<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Is Weekend&#34;</span>)
</span></span></code></pre></div>  <div id="df-4fdf808e-615e-48f8-ab97-2688c21be0c6">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Is Weekend</th>
      <th>Total Orders</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>90716</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>26613</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4fdf808e-615e-48f8-ab97-2688c21be0c6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-4fdf808e-615e-48f8-ab97-2688c21be0c6 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-4fdf808e-615e-48f8-ab97-2688c21be0c6');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Visualize data</span>
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>barplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Is Weekend&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Total Orders&#34;</span>, data<span style="color:#f92672">=</span>orderinwn)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;Orders di weekend&#34;</span>)
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>set(rc<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;figure.figsize&#39;</span>:(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">4</span>)})
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_162_0.png" alt="png"></p>
<h4 id="order-delivered-daypart">Order Delivered daypart</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Orders delivered daypart</span>
</span></span><span style="display:flex;"><span>orderdpt <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(cus360[<span style="color:#e6db74">&#34;order_delivered_customer_day_part&#34;</span>])[<span style="color:#e6db74">&#34;order_id&#34;</span>]<span style="color:#f92672">.</span>count()<span style="color:#f92672">.</span>reset_index()<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;order_delivered_customer_day_part&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>orderdpt<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;order_id&#34;</span>:<span style="color:#e6db74">&#34;Total Orders&#34;</span>, <span style="color:#e6db74">&#34;order_delivered_customer_day_part&#34;</span>: <span style="color:#e6db74">&#34;Daypart&#34;</span>}, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>orderdpt<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Daypart&#34;</span>)
</span></span></code></pre></div>  <div id="df-4598433d-fe57-4873-985e-efe553695f98">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Daypart</th>
      <th>Total Orders</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>afternoon</td>
      <td>24570</td>
    </tr>
    <tr>
      <th>1</th>
      <td>dawn</td>
      <td>451</td>
    </tr>
    <tr>
      <th>2</th>
      <td>early morning</td>
      <td>815</td>
    </tr>
    <tr>
      <th>3</th>
      <td>evening</td>
      <td>33309</td>
    </tr>
    <tr>
      <th>4</th>
      <td>late morning</td>
      <td>4656</td>
    </tr>
    <tr>
      <th>5</th>
      <td>midnight</td>
      <td>13614</td>
    </tr>
    <tr>
      <th>6</th>
      <td>night</td>
      <td>26762</td>
    </tr>
    <tr>
      <th>7</th>
      <td>noon</td>
      <td>13152</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4598433d-fe57-4873-985e-efe553695f98')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-4598433d-fe57-4873-985e-efe553695f98 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-4598433d-fe57-4873-985e-efe553695f98');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize <span style="color:#f92672">=</span> (<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>barplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Daypart&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Total Orders&#34;</span>, data<span style="color:#f92672">=</span>orderdpt<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Total Orders&#39;</span>))
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;Orders Delivered in Daypart&#34;</span>)
</span></span></code></pre></div><pre><code>Text(0.5, 1.0, 'Orders Delivered in Daypart')
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_166_1.png" alt="png"></p>
<h3 id="rating-by-products">Rating by Products</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Best and worst rated products</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">12</span>))
</span></span><span style="display:flex;"><span>reviewsocres <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;product_category_name&#34;</span>)[<span style="color:#e6db74">&#34;review_score&#34;</span>]<span style="color:#f92672">.</span>agg([<span style="color:#e6db74">&#34;mean&#34;</span>, <span style="color:#e6db74">&#34;count&#34;</span>])<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;mean&#34;</span>,ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ax = sns.barplot(y=bestrated.index, x=bestrated.values)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get only products with 30 or more reviews in order to have a more realistic idea about the rating</span>
</span></span><span style="display:flex;"><span>bestrated <span style="color:#f92672">=</span> reviewsocres[reviewsocres[<span style="color:#e6db74">&#34;count&#34;</span>]<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">30</span>][:<span style="color:#ae81ff">10</span>]
</span></span><span style="display:flex;"><span>bestrated
</span></span></code></pre></div>  <div id="df-701f9440-9a37-410b-8b69-e74c04a4c85a">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>count</th>
    </tr>
    <tr>
      <th>product_category_name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pet_shop</th>
      <td>4.197030</td>
      <td>2020</td>
    </tr>
    <tr>
      <th>stationery</th>
      <td>4.188339</td>
      <td>2607</td>
    </tr>
    <tr>
      <th>toys</th>
      <td>4.162506</td>
      <td>4246</td>
    </tr>
    <tr>
      <th>cool_stuff</th>
      <td>4.140767</td>
      <td>3964</td>
    </tr>
    <tr>
      <th>health_beauty</th>
      <td>4.137973</td>
      <td>9944</td>
    </tr>
    <tr>
      <th>fashion_bags_accessories</th>
      <td>4.130616</td>
      <td>2159</td>
    </tr>
    <tr>
      <th>perfumery</th>
      <td>4.128112</td>
      <td>3575</td>
    </tr>
    <tr>
      <th>sports_leisure</th>
      <td>4.107470</td>
      <td>8942</td>
    </tr>
    <tr>
      <th>others</th>
      <td>4.064475</td>
      <td>16301</td>
    </tr>
    <tr>
      <th>auto</th>
      <td>4.064279</td>
      <td>4356</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-701f9440-9a37-410b-8b69-e74c04a4c85a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-701f9440-9a37-410b-8b69-e74c04a4c85a button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-701f9440-9a37-410b-8b69-e74c04a4c85a');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<pre><code>&lt;Figure size 864x864 with 0 Axes&gt;
</code></pre>
<p>Product dengan rating terbaik berada di kategori pet shop</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Bottom 10 Products by review socre</span>
</span></span><span style="display:flex;"><span>worstrated <span style="color:#f92672">=</span> reviewsocres[reviewsocres[<span style="color:#e6db74">&#34;count&#34;</span>]<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">30</span>]<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;mean&#39;</span>)[:<span style="color:#ae81ff">10</span>]
</span></span><span style="display:flex;"><span>worstrated
</span></span></code></pre></div>  <div id="df-2053d671-a766-4dec-98a4-c1df856509a3">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>count</th>
    </tr>
    <tr>
      <th>product_category_name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>office_furniture</th>
      <td>3.526791</td>
      <td>1773</td>
    </tr>
    <tr>
      <th>bed_bath_table</th>
      <td>3.890605</td>
      <td>11847</td>
    </tr>
    <tr>
      <th>furniture_decor</th>
      <td>3.912158</td>
      <td>8743</td>
    </tr>
    <tr>
      <th>computers_accessories</th>
      <td>3.936089</td>
      <td>8105</td>
    </tr>
    <tr>
      <th>telephony</th>
      <td>3.948849</td>
      <td>4692</td>
    </tr>
    <tr>
      <th>baby</th>
      <td>4.011643</td>
      <td>3178</td>
    </tr>
    <tr>
      <th>watches_gifts</th>
      <td>4.017692</td>
      <td>6161</td>
    </tr>
    <tr>
      <th>garden_tools</th>
      <td>4.023914</td>
      <td>4558</td>
    </tr>
    <tr>
      <th>electronics</th>
      <td>4.040325</td>
      <td>2827</td>
    </tr>
    <tr>
      <th>housewares</th>
      <td>4.060428</td>
      <td>7331</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-2053d671-a766-4dec-98a4-c1df856509a3')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-2053d671-a766-4dec-98a4-c1df856509a3 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-2053d671-a766-4dec-98a4-c1df856509a3');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<p>Product dengan rating terendah berada pada kategori office_furniture</p>
<h3 id="payment-method--order-status">Payment Method &amp; Order Status</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cashvscancel <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>crosstab(cus360[<span style="color:#e6db74">&#34;payment_type&#34;</span>], cus360[<span style="color:#e6db74">&#34;order_status&#34;</span>])
</span></span><span style="display:flex;"><span>cashvscancel <span style="color:#f92672">=</span> cashvscancel[[<span style="color:#e6db74">&#34;canceled&#34;</span>, <span style="color:#e6db74">&#34;delivered&#34;</span>]]
</span></span><span style="display:flex;"><span>cashvscancel[<span style="color:#e6db74">&#34;% Canceled&#34;</span>] <span style="color:#f92672">=</span> (cashvscancel[<span style="color:#e6db74">&#34;canceled&#34;</span>] <span style="color:#f92672">/</span> cashvscancel[<span style="color:#e6db74">&#34;delivered&#34;</span>] ) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>cashvscancel[<span style="color:#e6db74">&#34;Avg Cancelation Rate&#34;</span>] <span style="color:#f92672">=</span> (len(cus360[cus360[<span style="color:#e6db74">&#34;order_status&#34;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;canceled&#34;</span>]) <span style="color:#f92672">/</span> len(cus360[cus360[<span style="color:#e6db74">&#34;order_status&#34;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;delivered&#34;</span>])) <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>cashvscancel
</span></span></code></pre></div><p>Persentase Pembatalan pesanan relatif sama di tiap metode pembayaran</p>
<h3 id="delivery-time--review-scores">Delivery Time &amp; Review Scores</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Add delta column which computes the time it took for the order to get delivered</span>
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#34;TimeToDeliveryinHours&#34;</span>] <span style="color:#f92672">=</span> (cus360[<span style="color:#e6db74">&#34;order_delivered_customer_date&#34;</span>] <span style="color:#f92672">-</span> cus360[<span style="color:#e6db74">&#34;order_purchase_timestamp&#34;</span>])
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#34;TimeToDeliveryinHours&#34;</span>] <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#34;TimeToDeliveryinHours&#34;</span>]<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: x<span style="color:#f92672">.</span>total_seconds())
</span></span><span style="display:flex;"><span>cus360[<span style="color:#e6db74">&#34;TimeToDeliveryinHours&#34;</span>] <span style="color:#f92672">=</span> round((cus360[<span style="color:#e6db74">&#34;TimeToDeliveryinHours&#34;</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">3600</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>cus360<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;TimeToDeliveryinHours&#34;</span> : <span style="color:#e6db74">&#34;TimeToDeliveryinDays&#34;</span>}, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Main stats of deliverytime</span>
</span></span><span style="display:flex;"><span>cus360[[<span style="color:#e6db74">&#34;TimeToDeliveryinDays&#34;</span>]]<span style="color:#f92672">.</span>describe()
</span></span></code></pre></div><p>Waktu pengiriman cukup lama, yakni sekitar 12 hari dengan median 10 hari. Terdapat outlier yakni pada pengiriman selama 208 hari.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>boxplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;review_score&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;TimeToDeliveryinDays&#34;</span>, data<span style="color:#f92672">=</span>cus360)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Menghilangkan Outlier</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>q_high <span style="color:#f92672">=</span> cus360[<span style="color:#e6db74">&#34;TimeToDeliveryinDays&#34;</span>]<span style="color:#f92672">.</span>quantile(<span style="color:#ae81ff">0.95</span>)
</span></span><span style="display:flex;"><span>cus360_no_outliers <span style="color:#f92672">=</span> cus360[cus360[<span style="color:#e6db74">&#34;TimeToDeliveryinDays&#34;</span>] <span style="color:#f92672">&lt;</span> q_high]
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>boxplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;review_score&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;TimeToDeliveryinDays&#34;</span>, data<span style="color:#f92672">=</span>cus360_no_outliers)
</span></span></code></pre></div><p>Dapat kita simpulkan bahwa semakin cepat pengiriman, maka semakin tinggi rating yang diberikan.</p>
<h3 id="delivery-time-by-city">Delivery Time by City</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sellersdeliverytime <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;sel_city&#34;</span>)[<span style="color:#e6db74">&#34;TimeToDeliveryinDays&#34;</span>]<span style="color:#f92672">.</span>agg([<span style="color:#e6db74">&#34;min&#34;</span>, <span style="color:#e6db74">&#34;max&#34;</span>, <span style="color:#e6db74">&#34;mean&#34;</span>, <span style="color:#e6db74">&#34;std&#34;</span>, <span style="color:#e6db74">&#34;count&#34;</span> ])<span style="color:#f92672">.</span>dropna()<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#34;mean&#34;</span>)<span style="color:#f92672">.</span>reset_index()
</span></span><span style="display:flex;"><span>sellersdeliverytime <span style="color:#f92672">=</span> sellersdeliverytime[sellersdeliverytime[<span style="color:#e6db74">&#34;count&#34;</span>]<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">30</span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fastestdeliverysellers <span style="color:#f92672">=</span> sellersdeliverytime[:<span style="color:#ae81ff">10</span>]
</span></span><span style="display:flex;"><span>slowestdeliverysellers <span style="color:#f92672">=</span> sellersdeliverytime<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#34;mean&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)[:<span style="color:#ae81ff">10</span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Seller dengan waktu pengiriman tercepat</span>
</span></span><span style="display:flex;"><span>fastestdeliverysellers
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>avg_review_score_seller <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;sel_city&#34;</span>)[<span style="color:#e6db74">&#34;review_score&#34;</span>]<span style="color:#f92672">.</span>mean()<span style="color:#f92672">.</span>dropna()<span style="color:#f92672">.</span>sort_values(ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#f92672">.</span>reset_index()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sellerPerf <span style="color:#f92672">=</span> sellersdeliverytime<span style="color:#f92672">.</span>merge(avg_review_score_seller, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sel_city&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Relasi antara rata-rata waktu pengiriman dan rata-rata skor review</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>regplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;mean&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;review_score&#34;</span>, data<span style="color:#f92672">=</span>sellerPerf)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#34;&#34;</span>)
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_188_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Seller dengan waktu delivery terlambat</span>
</span></span><span style="display:flex;"><span>slowestdeliverysellers
</span></span></code></pre></div>  <div id="df-6de2914a-a52f-48ee-b736-0986eb0d0c7e">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sel_city</th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
      <th>std</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>524</th>
      <td>mombuca</td>
      <td>6.03</td>
      <td>88.24</td>
      <td>22.921515</td>
      <td>17.782976</td>
      <td>33</td>
    </tr>
    <tr>
      <th>519</th>
      <td>itaquaquecetuba</td>
      <td>1.61</td>
      <td>194.85</td>
      <td>21.838281</td>
      <td>12.911572</td>
      <td>1734</td>
    </tr>
    <tr>
      <th>517</th>
      <td>congonhal</td>
      <td>4.31</td>
      <td>60.82</td>
      <td>21.590463</td>
      <td>12.736508</td>
      <td>108</td>
    </tr>
    <tr>
      <th>513</th>
      <td>balneario camboriu</td>
      <td>3.25</td>
      <td>79.36</td>
      <td>20.641613</td>
      <td>17.449918</td>
      <td>31</td>
    </tr>
    <tr>
      <th>512</th>
      <td>tubarao</td>
      <td>6.01</td>
      <td>81.33</td>
      <td>19.930286</td>
      <td>20.308568</td>
      <td>35</td>
    </tr>
    <tr>
      <th>508</th>
      <td>foz do iguacu</td>
      <td>2.98</td>
      <td>92.78</td>
      <td>19.490833</td>
      <td>17.240529</td>
      <td>192</td>
    </tr>
    <tr>
      <th>501</th>
      <td>bombinhas</td>
      <td>5.13</td>
      <td>68.10</td>
      <td>18.875761</td>
      <td>9.758911</td>
      <td>92</td>
    </tr>
    <tr>
      <th>500</th>
      <td>criciuma</td>
      <td>3.73</td>
      <td>71.16</td>
      <td>18.396000</td>
      <td>15.760557</td>
      <td>35</td>
    </tr>
    <tr>
      <th>497</th>
      <td>claudio</td>
      <td>5.73</td>
      <td>48.63</td>
      <td>18.216846</td>
      <td>8.143201</td>
      <td>130</td>
    </tr>
    <tr>
      <th>491</th>
      <td>caucaia</td>
      <td>3.14</td>
      <td>138.88</td>
      <td>17.841471</td>
      <td>23.052995</td>
      <td>34</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6de2914a-a52f-48ee-b736-0986eb0d0c7e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-6de2914a-a52f-48ee-b736-0986eb0d0c7e button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-6de2914a-a52f-48ee-b736-0986eb0d0c7e');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h3 id="delivery-time-by-states">Delivery Time by States</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>highestTTDstates <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;cust_state&#34;</span>)[<span style="color:#e6db74">&#34;TimeToDeliveryinDays&#34;</span>]<span style="color:#f92672">.</span>mean()<span style="color:#f92672">.</span>dropna()<span style="color:#f92672">.</span>sort_values(ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#f92672">.</span>reset_index()
</span></span><span style="display:flex;"><span>highestTTDstates <span style="color:#f92672">=</span> highestTTDstates[:<span style="color:#ae81ff">10</span>]
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>barplot(y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;cust_state&#34;</span>, x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;TimeToDeliveryinDays&#34;</span>, data<span style="color:#f92672">=</span>highestTTDstates)
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_191_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>lowestTTDstates <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;cust_state&#34;</span>)[<span style="color:#e6db74">&#34;TimeToDeliveryinDays&#34;</span>]<span style="color:#f92672">.</span>mean()<span style="color:#f92672">.</span>dropna()<span style="color:#f92672">.</span>sort_values(ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)<span style="color:#f92672">.</span>reset_index()
</span></span><span style="display:flex;"><span>lowestTTDstates <span style="color:#f92672">=</span> lowestTTDstates[:<span style="color:#ae81ff">10</span>]
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>barplot(y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;cust_state&#34;</span>, x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;TimeToDeliveryinDays&#34;</span>, data<span style="color:#f92672">=</span>lowestTTDstates)
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_192_0.png" alt="png"></p>
<h3 id="deliverytime-vary-across-the-time">Deliverytime Vary across the time</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>deliverytimevstime <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(cus360[<span style="color:#e6db74">&#34;order_purchase_timestamp&#34;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year)[<span style="color:#e6db74">&#34;TimeToDeliveryinDays&#34;</span>]<span style="color:#f92672">.</span>median()<span style="color:#f92672">.</span>dropna()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>deliverytimevstime<span style="color:#f92672">.</span>plot(kind<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bar&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Median deliveryTime in days&#34;</span>)
</span></span></code></pre></div><pre><code>Text(0, 0.5, 'Median deliveryTime in days')
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_194_1.png" alt="png"></p>
<p>Kita dapat melihat bahwa perusahaan membuat peningkatan yang signifikan dalam waktu pengiriman. Pada tahun 2016, waktu pengiriman rata-rata melebihi 17 hari sementara pada tahun 2017 turun menjadi sekitar 12 dan menjadi sekitar 9 hari pada tahun 2018.</p>
<h3 id="review-score-vary-across-the-time">Review Score Vary across the time</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>scorevstime <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(cus360[<span style="color:#e6db74">&#34;order_purchase_timestamp&#34;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year)[<span style="color:#e6db74">&#34;review_score&#34;</span>]<span style="color:#f92672">.</span>mean()<span style="color:#f92672">.</span>dropna()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>scorevstime<span style="color:#f92672">.</span>plot(kind<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bar&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Mean review_score&#34;</span>)
</span></span></code></pre></div><pre><code>Text(0, 0.5, 'Mean review_score')
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_197_1.png" alt="png"></p>
<p>Pelanggan memberikan skor yang lebih baik di tahun 2017 dan 2018 dibandingkan tahun 2016.</p>
<h3 id="the-most-sold-categories-of-product">The most sold categories of product</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>top_categ_by_revenue <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;product_category_name&#34;</span>)<span style="color:#f92672">.</span>agg({<span style="color:#e6db74">&#39;order_id&#39;</span>:<span style="color:#e6db74">&#39;nunique&#39;</span>,<span style="color:#e6db74">&#39;payment_value&#39;</span>:<span style="color:#e6db74">&#39;sum&#39;</span>})<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#34;payment_value&#34;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)[:<span style="color:#ae81ff">10</span>]
</span></span><span style="display:flex;"><span>top_categ_by_revenue<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;order_id&#34;</span>:<span style="color:#e6db74">&#34;NumOfOrders&#34;</span>, <span style="color:#e6db74">&#34;payment_value&#34;</span>:<span style="color:#e6db74">&#34;Revenues&#34;</span>}, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>top_categ_by_revenue
</span></span></code></pre></div>  <div id="df-ce603993-5d75-4067-b234-80290d84817b">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NumOfOrders</th>
      <th>Revenues</th>
    </tr>
    <tr>
      <th>product_category_name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>others</th>
      <td>13824</td>
      <td>3598269.64</td>
    </tr>
    <tr>
      <th>bed_bath_table</th>
      <td>9313</td>
      <td>1725465.67</td>
    </tr>
    <tr>
      <th>health_beauty</th>
      <td>8770</td>
      <td>1646292.53</td>
    </tr>
    <tr>
      <th>computers_accessories</th>
      <td>6649</td>
      <td>1592611.66</td>
    </tr>
    <tr>
      <th>furniture_decor</th>
      <td>6398</td>
      <td>1427214.01</td>
    </tr>
    <tr>
      <th>watches_gifts</th>
      <td>5576</td>
      <td>1420682.17</td>
    </tr>
    <tr>
      <th>sports_leisure</th>
      <td>7669</td>
      <td>1390581.87</td>
    </tr>
    <tr>
      <th>housewares</th>
      <td>5843</td>
      <td>1091709.15</td>
    </tr>
    <tr>
      <th>garden_tools</th>
      <td>3496</td>
      <td>834757.45</td>
    </tr>
    <tr>
      <th>auto</th>
      <td>3877</td>
      <td>802254.74</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ce603993-5d75-4067-b234-80290d84817b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-ce603993-5d75-4067-b234-80290d84817b button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-ce603993-5d75-4067-b234-80290d84817b');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h2 id="feature-engineering-phase-2">Feature Engineering Phase 2</h2>
<p>Feature Engineering Fase 2 digunakan untuk menyeleksi fitur, imputasi lanjutan, encoding dan akan menghasilkan dataset yang siap digunakan untuk modeling</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cus360<span style="color:#f92672">.</span>shape
</span></span></code></pre></div><pre><code>(117329, 92)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>feature <span style="color:#f92672">=</span> cus360<span style="color:#f92672">.</span>loc[:, [<span style="color:#e6db74">&#39;customer_unique_id&#39;</span>, <span style="color:#e6db74">&#39;order_id&#39;</span>, <span style="color:#e6db74">&#39;order_purchase_timestamp&#39;</span>, <span style="color:#e6db74">&#39;product_id&#39;</span>, <span style="color:#e6db74">&#39;price&#39;</span>, <span style="color:#e6db74">&#39;freight_value&#39;</span>, <span style="color:#e6db74">&#39;payment_value&#39;</span>,
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#39;review_score&#39;</span>, <span style="color:#e6db74">&#39;product_weight_g&#39;</span>, <span style="color:#e6db74">&#39;product_length_cm&#39;</span>,
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#39;product_height_cm&#39;</span>, <span style="color:#e6db74">&#39;product_width_cm&#39;</span>, <span style="color:#e6db74">&#39;shipping_length&#39;</span>, <span style="color:#e6db74">&#39;payment_type&#39;</span>, <span style="color:#e6db74">&#39;order_delivered_customer_date&#39;</span>,
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#39;order_approved_at&#39;</span>, <span style="color:#e6db74">&#39;order_delivered_carrier_date&#39;</span>, <span style="color:#e6db74">&#39;shipping_limit_date&#39;</span>, <span style="color:#e6db74">&#39;order_estimated_delivery_date&#39;</span>,
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#39;product_description_lenght&#39;</span>, <span style="color:#e6db74">&#39;product_photos_qty&#39;</span>, <span style="color:#e6db74">&#39;review_creation_date&#39;</span>, <span style="color:#e6db74">&#39;review_answer_timestamp&#39;</span>]]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>feature<span style="color:#f92672">.</span>shape
</span></span></code></pre></div><pre><code>(117329, 23)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>feature<span style="color:#f92672">.</span>head()
</span></span></code></pre></div>  <div id="df-3693435f-3e13-44a5-b3e0-7cca49a38b11">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_unique_id</th>
      <th>order_id</th>
      <th>order_purchase_timestamp</th>
      <th>product_id</th>
      <th>price</th>
      <th>freight_value</th>
      <th>payment_value</th>
      <th>review_score</th>
      <th>product_weight_g</th>
      <th>product_length_cm</th>
      <th>product_height_cm</th>
      <th>product_width_cm</th>
      <th>shipping_length</th>
      <th>payment_type</th>
      <th>order_delivered_customer_date</th>
      <th>order_approved_at</th>
      <th>order_delivered_carrier_date</th>
      <th>shipping_limit_date</th>
      <th>order_estimated_delivery_date</th>
      <th>product_description_lenght</th>
      <th>product_photos_qty</th>
      <th>review_creation_date</th>
      <th>review_answer_timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7c396fd4830fd04220f754e42b4e5bff</td>
      <td>e481f51cbdc54678b7cc49136f2d6af7</td>
      <td>2017-10-02 10:56:33</td>
      <td>87285b34884572647811a353c7ac498a</td>
      <td>29.99</td>
      <td>8.72</td>
      <td>18.12</td>
      <td>4</td>
      <td>500.0</td>
      <td>19.0</td>
      <td>8.0</td>
      <td>13.0</td>
      <td>6.0</td>
      <td>credit_card</td>
      <td>2017-10-10 21:25:13</td>
      <td>2017-10-02 11:07:15</td>
      <td>2017-10-04 19:55:00</td>
      <td>2017-10-06 11:07:15</td>
      <td>2017-10-18</td>
      <td>268.0</td>
      <td>4.0</td>
      <td>2017-10-11</td>
      <td>2017-10-12 03:43:48</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7c396fd4830fd04220f754e42b4e5bff</td>
      <td>e481f51cbdc54678b7cc49136f2d6af7</td>
      <td>2017-10-02 10:56:33</td>
      <td>87285b34884572647811a353c7ac498a</td>
      <td>29.99</td>
      <td>8.72</td>
      <td>2.00</td>
      <td>4</td>
      <td>500.0</td>
      <td>19.0</td>
      <td>8.0</td>
      <td>13.0</td>
      <td>6.0</td>
      <td>voucher</td>
      <td>2017-10-10 21:25:13</td>
      <td>2017-10-02 11:07:15</td>
      <td>2017-10-04 19:55:00</td>
      <td>2017-10-06 11:07:15</td>
      <td>2017-10-18</td>
      <td>268.0</td>
      <td>4.0</td>
      <td>2017-10-11</td>
      <td>2017-10-12 03:43:48</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7c396fd4830fd04220f754e42b4e5bff</td>
      <td>e481f51cbdc54678b7cc49136f2d6af7</td>
      <td>2017-10-02 10:56:33</td>
      <td>87285b34884572647811a353c7ac498a</td>
      <td>29.99</td>
      <td>8.72</td>
      <td>18.59</td>
      <td>4</td>
      <td>500.0</td>
      <td>19.0</td>
      <td>8.0</td>
      <td>13.0</td>
      <td>6.0</td>
      <td>voucher</td>
      <td>2017-10-10 21:25:13</td>
      <td>2017-10-02 11:07:15</td>
      <td>2017-10-04 19:55:00</td>
      <td>2017-10-06 11:07:15</td>
      <td>2017-10-18</td>
      <td>268.0</td>
      <td>4.0</td>
      <td>2017-10-11</td>
      <td>2017-10-12 03:43:48</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3a51803cc0d012c3b5dc8b7528cb05f7</td>
      <td>128e10d95713541c87cd1a2e48201934</td>
      <td>2017-08-15 18:29:31</td>
      <td>87285b34884572647811a353c7ac498a</td>
      <td>29.99</td>
      <td>7.78</td>
      <td>37.77</td>
      <td>4</td>
      <td>500.0</td>
      <td>19.0</td>
      <td>8.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>credit_card</td>
      <td>2017-08-18 14:44:43</td>
      <td>2017-08-15 20:05:16</td>
      <td>2017-08-17 15:28:33</td>
      <td>2017-08-21 20:05:16</td>
      <td>2017-08-28</td>
      <td>268.0</td>
      <td>4.0</td>
      <td>2017-08-19</td>
      <td>2017-08-20 15:16:36</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ef0996a1a279c26e7ecbd737be23d235</td>
      <td>0e7e841ddf8f8f2de2bad69267ecfbcf</td>
      <td>2017-08-02 18:24:47</td>
      <td>87285b34884572647811a353c7ac498a</td>
      <td>29.99</td>
      <td>7.78</td>
      <td>37.77</td>
      <td>5</td>
      <td>500.0</td>
      <td>19.0</td>
      <td>8.0</td>
      <td>13.0</td>
      <td>3.0</td>
      <td>credit_card</td>
      <td>2017-08-07 18:30:01</td>
      <td>2017-08-02 18:43:15</td>
      <td>2017-08-04 17:35:43</td>
      <td>2017-08-08 18:37:31</td>
      <td>2017-08-15</td>
      <td>268.0</td>
      <td>4.0</td>
      <td>2017-08-08</td>
      <td>2017-08-08 23:26:23</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-3693435f-3e13-44a5-b3e0-7cca49a38b11')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-3693435f-3e13-44a5-b3e0-7cca49a38b11 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-3693435f-3e13-44a5-b3e0-7cca49a38b11');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h3 id="feature-creation--aggregation">Feature Creation &amp; Aggregation</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>feature[<span style="color:#e6db74">&#39;product_volume&#39;</span>] <span style="color:#f92672">=</span> feature<span style="color:#f92672">.</span>product_length_cm <span style="color:#f92672">*</span> feature<span style="color:#f92672">.</span>product_width_cm <span style="color:#f92672">*</span> feature<span style="color:#f92672">.</span>product_height_cm
</span></span><span style="display:flex;"><span>feature[<span style="color:#e6db74">&#39;review_ans_delta&#39;</span>] <span style="color:#f92672">=</span> (feature<span style="color:#f92672">.</span>review_answer_timestamp <span style="color:#f92672">-</span> feature<span style="color:#f92672">.</span>review_creation_date)<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>total_seconds()
</span></span><span style="display:flex;"><span>feature[<span style="color:#e6db74">&#39;estimated_delivery_delta&#39;</span>] <span style="color:#f92672">=</span> (feature<span style="color:#f92672">.</span>order_estimated_delivery_date <span style="color:#f92672">-</span> feature<span style="color:#f92672">.</span>order_delivered_customer_date)<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>days
</span></span><span style="display:flex;"><span>feature[<span style="color:#e6db74">&#39;shipping_limit_carrier_delta&#39;</span>] <span style="color:#f92672">=</span> (feature<span style="color:#f92672">.</span>shipping_limit_date <span style="color:#f92672">-</span> feature<span style="color:#f92672">.</span>order_delivered_carrier_date)<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>days
</span></span><span style="display:flex;"><span>feature[<span style="color:#e6db74">&#39;del_carrier_approved_delta&#39;</span>] <span style="color:#f92672">=</span> (feature<span style="color:#f92672">.</span>order_delivered_carrier_date <span style="color:#f92672">-</span> feature<span style="color:#f92672">.</span>order_approved_at)<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>days
</span></span><span style="display:flex;"><span>feature[<span style="color:#e6db74">&#39;approved_purchase_delta&#39;</span>] <span style="color:#f92672">=</span> (feature<span style="color:#f92672">.</span>order_approved_at <span style="color:#f92672">-</span> feature<span style="color:#f92672">.</span>order_purchase_timestamp)<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>total_seconds()
</span></span><span style="display:flex;"><span>feature[<span style="color:#e6db74">&#39;delivery_time&#39;</span>] <span style="color:#f92672">=</span> (feature<span style="color:#f92672">.</span>order_delivered_customer_date <span style="color:#f92672">-</span> feature<span style="color:#f92672">.</span>order_purchase_timestamp)<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>days
</span></span></code></pre></div><h4 id="feature-imputation">Feature Imputation</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>feature[<span style="color:#e6db74">&#39;product_photos_qty&#39;</span>] <span style="color:#f92672">=</span> feature<span style="color:#f92672">.</span>product_photos_qty<span style="color:#f92672">.</span>fillna(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>feature[<span style="color:#e6db74">&#39;product_description_lenght&#39;</span>] <span style="color:#f92672">=</span> feature<span style="color:#f92672">.</span>product_description_lenght<span style="color:#f92672">.</span>fillna(<span style="color:#ae81ff">0</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>feature <span style="color:#f92672">=</span> feature<span style="color:#f92672">.</span>dropna()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Mengecek tanggal pemesanan maksimum dan minimum</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Min Date :&#34;</span>, feature[<span style="color:#e6db74">&#34;order_purchase_timestamp&#34;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>date<span style="color:#f92672">.</span>min(), <span style="color:#e6db74">&#34;Max Date :&#34;</span>, feature[<span style="color:#e6db74">&#34;order_purchase_timestamp&#34;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>date<span style="color:#f92672">.</span>max())
</span></span></code></pre></div><pre><code>Min Date : 2016-10-03 Max Date : 2018-08-29
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>lastdate <span style="color:#f92672">=</span> feature[<span style="color:#e6db74">&#34;order_purchase_timestamp&#34;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>date<span style="color:#f92672">.</span>max()
</span></span><span style="display:flex;"><span>print(lastdate)
</span></span></code></pre></div><pre><code>2018-08-29
</code></pre>
<h4 id="recency">Recency</h4>
<p>Recency adalah waktu/durasi antara tanggal transaksi terakhir tiap customer dengan waktu terakhir dari seluruh transaksi</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>recency <span style="color:#f92672">=</span> feature<span style="color:#f92672">.</span>groupby(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;customer_unique_id&#39;</span>, as_index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)[<span style="color:#e6db74">&#39;order_purchase_timestamp&#39;</span>]<span style="color:#f92672">.</span>max()
</span></span><span style="display:flex;"><span>recency<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;customer_unique_id&#39;</span>,<span style="color:#e6db74">&#39;LastPurchaseDate&#39;</span>]
</span></span><span style="display:flex;"><span>recency
</span></span></code></pre></div>  <div id="df-c59da510-e616-4a30-9281-31ae4f54f54d">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_unique_id</th>
      <th>LastPurchaseDate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000366f3b9a7992bf8c76cfdf3221e2</td>
      <td>2018-05-10 10:56:27</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000b849f77a49e4a4ce2b2a4ca5be3f</td>
      <td>2018-05-07 11:11:27</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000f46a3911fa3c0805444483337064</td>
      <td>2017-03-10 21:05:03</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000f6ccb0745a6a4b88665a16c9f078</td>
      <td>2017-10-12 20:29:41</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0004aac84e0df4da2b147fca70cf8255</td>
      <td>2017-11-14 19:45:42</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>92720</th>
      <td>fffcf5a5ff07b0908bd4e2dbc735a684</td>
      <td>2017-06-08 21:00:36</td>
    </tr>
    <tr>
      <th>92721</th>
      <td>fffea47cd6d3cc0a88bd621562a9d061</td>
      <td>2017-12-10 20:07:56</td>
    </tr>
    <tr>
      <th>92722</th>
      <td>ffff371b4d645b6ecea244b27531430a</td>
      <td>2017-02-07 15:49:16</td>
    </tr>
    <tr>
      <th>92723</th>
      <td>ffff5962728ec6157033ef9805bacc48</td>
      <td>2018-05-02 15:17:41</td>
    </tr>
    <tr>
      <th>92724</th>
      <td>ffffd2657e2aad2907e67c3e9daecbeb</td>
      <td>2017-05-02 20:18:45</td>
    </tr>
  </tbody>
</table>
<p>92725 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c59da510-e616-4a30-9281-31ae4f54f54d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-c59da510-e616-4a30-9281-31ae4f54f54d button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-c59da510-e616-4a30-9281-31ae4f54f54d');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>recency[<span style="color:#e6db74">&#39;Recency&#39;</span>] <span style="color:#f92672">=</span> recency[<span style="color:#e6db74">&#39;LastPurchaseDate&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>date<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: (lastdate <span style="color:#f92672">-</span> x)<span style="color:#f92672">.</span>days)
</span></span><span style="display:flex;"><span>recency<span style="color:#f92672">.</span>head()
</span></span></code></pre></div>  <div id="df-8ce2949a-b0b5-4666-a63d-aeb9ba49e026">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_unique_id</th>
      <th>LastPurchaseDate</th>
      <th>Recency</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000366f3b9a7992bf8c76cfdf3221e2</td>
      <td>2018-05-10 10:56:27</td>
      <td>111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000b849f77a49e4a4ce2b2a4ca5be3f</td>
      <td>2018-05-07 11:11:27</td>
      <td>114</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000f46a3911fa3c0805444483337064</td>
      <td>2017-03-10 21:05:03</td>
      <td>537</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000f6ccb0745a6a4b88665a16c9f078</td>
      <td>2017-10-12 20:29:41</td>
      <td>321</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0004aac84e0df4da2b147fca70cf8255</td>
      <td>2017-11-14 19:45:42</td>
      <td>288</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-8ce2949a-b0b5-4666-a63d-aeb9ba49e026')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-8ce2949a-b0b5-4666-a63d-aeb9ba49e026 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-8ce2949a-b0b5-4666-a63d-aeb9ba49e026');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h4 id="frequency">Frequency</h4>
<p>Frequency adalah jumlah keseluruhan transaksi, dihitung dari total order yang dilakukan oeh tiap customer sejak pertamakali bergabung</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>frequency <span style="color:#f92672">=</span> feature<span style="color:#f92672">.</span>groupby(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;customer_unique_id&#34;</span>,as_index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#f92672">.</span>agg({<span style="color:#e6db74">&#34;order_id&#34;</span>:<span style="color:#e6db74">&#34;nunique&#34;</span>})
</span></span><span style="display:flex;"><span>frequency<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;customer_unique_id&#39;</span>,<span style="color:#e6db74">&#39;Frequency&#39;</span>]
</span></span><span style="display:flex;"><span>frequency
</span></span></code></pre></div>  <div id="df-7414f275-5b3e-4eff-ae39-fafa3a2db383">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_unique_id</th>
      <th>Frequency</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000366f3b9a7992bf8c76cfdf3221e2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000b849f77a49e4a4ce2b2a4ca5be3f</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000f46a3911fa3c0805444483337064</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000f6ccb0745a6a4b88665a16c9f078</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0004aac84e0df4da2b147fca70cf8255</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>92720</th>
      <td>fffcf5a5ff07b0908bd4e2dbc735a684</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92721</th>
      <td>fffea47cd6d3cc0a88bd621562a9d061</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92722</th>
      <td>ffff371b4d645b6ecea244b27531430a</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92723</th>
      <td>ffff5962728ec6157033ef9805bacc48</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92724</th>
      <td>ffffd2657e2aad2907e67c3e9daecbeb</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>92725 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7414f275-5b3e-4eff-ae39-fafa3a2db383')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-7414f275-5b3e-4eff-ae39-fafa3a2db383 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-7414f275-5b3e-4eff-ae39-fafa3a2db383');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h4 id="monetary">Monetary</h4>
<p>Monetary adaah total nilai transaksi dari total order yang telah dilakukan customer</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>monetary <span style="color:#f92672">=</span> feature<span style="color:#f92672">.</span>groupby(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;customer_unique_id&#39;</span>,as_index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#f92672">.</span>agg({<span style="color:#e6db74">&#39;payment_value&#39;</span>: <span style="color:#e6db74">&#39;sum&#39;</span>})
</span></span><span style="display:flex;"><span>monetary<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;customer_unique_id&#39;</span>,<span style="color:#e6db74">&#39;Monetary&#39;</span>]
</span></span><span style="display:flex;"><span>monetary
</span></span></code></pre></div>  <div id="df-a5d32df7-c9c4-4ae5-aff1-f6b28644bbe6">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_unique_id</th>
      <th>Monetary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000366f3b9a7992bf8c76cfdf3221e2</td>
      <td>141.90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000b849f77a49e4a4ce2b2a4ca5be3f</td>
      <td>27.19</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000f46a3911fa3c0805444483337064</td>
      <td>86.22</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000f6ccb0745a6a4b88665a16c9f078</td>
      <td>43.62</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0004aac84e0df4da2b147fca70cf8255</td>
      <td>196.89</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>92720</th>
      <td>fffcf5a5ff07b0908bd4e2dbc735a684</td>
      <td>4134.84</td>
    </tr>
    <tr>
      <th>92721</th>
      <td>fffea47cd6d3cc0a88bd621562a9d061</td>
      <td>84.58</td>
    </tr>
    <tr>
      <th>92722</th>
      <td>ffff371b4d645b6ecea244b27531430a</td>
      <td>112.46</td>
    </tr>
    <tr>
      <th>92723</th>
      <td>ffff5962728ec6157033ef9805bacc48</td>
      <td>133.69</td>
    </tr>
    <tr>
      <th>92724</th>
      <td>ffffd2657e2aad2907e67c3e9daecbeb</td>
      <td>71.56</td>
    </tr>
  </tbody>
</table>
<p>92725 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a5d32df7-c9c4-4ae5-aff1-f6b28644bbe6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-a5d32df7-c9c4-4ae5-aff1-f6b28644bbe6 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-a5d32df7-c9c4-4ae5-aff1-f6b28644bbe6');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h4 id="transaction-age">Transaction Age</h4>
<p>Transaction Age adalah durasi/interval waktu antara transaksi pertama dengan transaksi terakhir dari tiap customer</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>trans_age <span style="color:#f92672">=</span> feature<span style="color:#f92672">.</span>groupby(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;customer_unique_id&#39;</span>,as_index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#f92672">.</span>agg({<span style="color:#e6db74">&#39;order_purchase_timestamp&#39;</span>: [<span style="color:#e6db74">&#39;min&#39;</span>, <span style="color:#e6db74">&#39;max&#39;</span>]})
</span></span><span style="display:flex;"><span>trans_age<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;customer_unique_id&#39;</span>,<span style="color:#e6db74">&#39;first_trans&#39;</span>, <span style="color:#e6db74">&#39;last_trans&#39;</span>]
</span></span><span style="display:flex;"><span>trans_age[<span style="color:#e6db74">&#39;trans_age&#39;</span>] <span style="color:#f92672">=</span> (trans_age<span style="color:#f92672">.</span>last_trans <span style="color:#f92672">-</span> trans_age<span style="color:#f92672">.</span>first_trans)<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>days <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>trans_age
</span></span></code></pre></div>  <div id="df-8fec3d79-d0cc-49ec-8bce-d3ed8555df23">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_unique_id</th>
      <th>first_trans</th>
      <th>last_trans</th>
      <th>trans_age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000366f3b9a7992bf8c76cfdf3221e2</td>
      <td>2018-05-10 10:56:27</td>
      <td>2018-05-10 10:56:27</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000b849f77a49e4a4ce2b2a4ca5be3f</td>
      <td>2018-05-07 11:11:27</td>
      <td>2018-05-07 11:11:27</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000f46a3911fa3c0805444483337064</td>
      <td>2017-03-10 21:05:03</td>
      <td>2017-03-10 21:05:03</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000f6ccb0745a6a4b88665a16c9f078</td>
      <td>2017-10-12 20:29:41</td>
      <td>2017-10-12 20:29:41</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0004aac84e0df4da2b147fca70cf8255</td>
      <td>2017-11-14 19:45:42</td>
      <td>2017-11-14 19:45:42</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>92720</th>
      <td>fffcf5a5ff07b0908bd4e2dbc735a684</td>
      <td>2017-06-08 21:00:36</td>
      <td>2017-06-08 21:00:36</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92721</th>
      <td>fffea47cd6d3cc0a88bd621562a9d061</td>
      <td>2017-12-10 20:07:56</td>
      <td>2017-12-10 20:07:56</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92722</th>
      <td>ffff371b4d645b6ecea244b27531430a</td>
      <td>2017-02-07 15:49:16</td>
      <td>2017-02-07 15:49:16</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92723</th>
      <td>ffff5962728ec6157033ef9805bacc48</td>
      <td>2018-05-02 15:17:41</td>
      <td>2018-05-02 15:17:41</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92724</th>
      <td>ffffd2657e2aad2907e67c3e9daecbeb</td>
      <td>2017-05-02 20:18:45</td>
      <td>2017-05-02 20:18:45</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>92725 rows × 4 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-8fec3d79-d0cc-49ec-8bce-d3ed8555df23')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-8fec3d79-d0cc-49ec-8bce-d3ed8555df23 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-8fec3d79-d0cc-49ec-8bce-d3ed8555df23');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h4 id="rfma-table">RFMA Table</h4>
<p>RFMA Table adalah tabel hasil merge dari Table Recency, Feature, Monetary dan Transaction Age</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Drop last Purchase date from recency dataframe as we do not need it anymore.</span>
</span></span><span style="display:flex;"><span>recency<span style="color:#f92672">.</span>drop(<span style="color:#e6db74">&#39;LastPurchaseDate&#39;</span>,axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>trans_age<span style="color:#f92672">.</span>drop([<span style="color:#e6db74">&#39;first_trans&#39;</span>, <span style="color:#e6db74">&#39;last_trans&#39;</span>],axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Merge recency, frequency and monetary dataframes</span>
</span></span><span style="display:flex;"><span>temp <span style="color:#f92672">=</span> recency<span style="color:#f92672">.</span>merge(frequency,on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;customer_unique_id&#39;</span>)
</span></span><span style="display:flex;"><span>rfm <span style="color:#f92672">=</span> temp<span style="color:#f92672">.</span>merge(monetary,on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;customer_unique_id&#39;</span>)
</span></span><span style="display:flex;"><span>rfm <span style="color:#f92672">=</span> rfm<span style="color:#f92672">.</span>merge(trans_age,on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;customer_unique_id&#39;</span>)
</span></span><span style="display:flex;"><span>rfm
</span></span></code></pre></div>  <div id="df-8725ce03-f9c5-4931-94db-40b28af4de2d">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_unique_id</th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>trans_age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000366f3b9a7992bf8c76cfdf3221e2</td>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000b849f77a49e4a4ce2b2a4ca5be3f</td>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000f46a3911fa3c0805444483337064</td>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000f6ccb0745a6a4b88665a16c9f078</td>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0004aac84e0df4da2b147fca70cf8255</td>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>92720</th>
      <td>fffcf5a5ff07b0908bd4e2dbc735a684</td>
      <td>447</td>
      <td>1</td>
      <td>4134.84</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92721</th>
      <td>fffea47cd6d3cc0a88bd621562a9d061</td>
      <td>262</td>
      <td>1</td>
      <td>84.58</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92722</th>
      <td>ffff371b4d645b6ecea244b27531430a</td>
      <td>568</td>
      <td>1</td>
      <td>112.46</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92723</th>
      <td>ffff5962728ec6157033ef9805bacc48</td>
      <td>119</td>
      <td>1</td>
      <td>133.69</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92724</th>
      <td>ffffd2657e2aad2907e67c3e9daecbeb</td>
      <td>484</td>
      <td>1</td>
      <td>71.56</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>92725 rows × 5 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-8725ce03-f9c5-4931-94db-40b28af4de2d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-8725ce03-f9c5-4931-94db-40b28af4de2d button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-8725ce03-f9c5-4931-94db-40b28af4de2d');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h4 id="payment-type-encoding">Payment Type Encoding</h4>
<p>Encoding dilakukan untuk menafsirkan fitur kategorik menjadi numerik, karena mesin tidak bisa melihat pola dan melakukan training dari data bertipe kategorik</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pay_type <span style="color:#f92672">=</span> feature<span style="color:#f92672">.</span>loc[:, [<span style="color:#e6db74">&#39;customer_unique_id&#39;</span>, <span style="color:#e6db74">&#39;payment_type&#39;</span>]]
</span></span><span style="display:flex;"><span>dum <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>get_dummies(pay_type<span style="color:#f92672">.</span>payment_type, prefix<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;payment&#39;</span>)
</span></span><span style="display:flex;"><span>pay_type <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([pay_type, dum], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>pay_type<span style="color:#f92672">.</span>drop(columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;payment_type&#39;</span>], inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pay_type <span style="color:#f92672">=</span> pay_type<span style="color:#f92672">.</span>groupby(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;customer_unique_id&#39;</span>,as_index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#f92672">.</span>agg({<span style="color:#e6db74">&#39;payment_boleto&#39;</span>: [<span style="color:#e6db74">&#39;sum&#39;</span>], <span style="color:#e6db74">&#39;payment_credit_card&#39;</span>: [<span style="color:#e6db74">&#39;sum&#39;</span>], <span style="color:#e6db74">&#39;payment_debit_card&#39;</span>: [<span style="color:#e6db74">&#39;sum&#39;</span>], <span style="color:#e6db74">&#39;payment_voucher&#39;</span>:[<span style="color:#e6db74">&#39;sum&#39;</span>]})
</span></span><span style="display:flex;"><span>pay_type<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;customer_unique_id&#39;</span>,<span style="color:#e6db74">&#39;payment_boleto&#39;</span>, <span style="color:#e6db74">&#39;payment_credit_card&#39;</span>, <span style="color:#e6db74">&#39;payment_debit_card&#39;</span>, <span style="color:#e6db74">&#39;payment_voucher&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pay_type
</span></span></code></pre></div>  <div id="df-53de97dc-4110-463b-9c59-54862fb5a1ff">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_unique_id</th>
      <th>payment_boleto</th>
      <th>payment_credit_card</th>
      <th>payment_debit_card</th>
      <th>payment_voucher</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000366f3b9a7992bf8c76cfdf3221e2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000b849f77a49e4a4ce2b2a4ca5be3f</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000f46a3911fa3c0805444483337064</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000f6ccb0745a6a4b88665a16c9f078</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0004aac84e0df4da2b147fca70cf8255</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>92720</th>
      <td>fffcf5a5ff07b0908bd4e2dbc735a684</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>92721</th>
      <td>fffea47cd6d3cc0a88bd621562a9d061</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>92722</th>
      <td>ffff371b4d645b6ecea244b27531430a</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>92723</th>
      <td>ffff5962728ec6157033ef9805bacc48</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>92724</th>
      <td>ffffd2657e2aad2907e67c3e9daecbeb</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>92725 rows × 5 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-53de97dc-4110-463b-9c59-54862fb5a1ff')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-53de97dc-4110-463b-9c59-54862fb5a1ff button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-53de97dc-4110-463b-9c59-54862fb5a1ff');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h4 id="feature-selection">Feature Selection</h4>
<p>Menghilangkan fitur yang telah dipakai, dan menyeleksi fitur yang dianggap paling influential</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>feature<span style="color:#f92672">.</span>drop(columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;order_delivered_customer_date&#39;</span>, <span style="color:#e6db74">&#39;order_delivered_carrier_date&#39;</span>,
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;product_length_cm&#39;</span>, <span style="color:#e6db74">&#39;product_height_cm&#39;</span>, <span style="color:#e6db74">&#39;product_width_cm&#39;</span>,
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;order_approved_at&#39;</span>, <span style="color:#e6db74">&#39;shipping_limit_date&#39;</span>, <span style="color:#e6db74">&#39;order_estimated_delivery_date&#39;</span>,
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;review_creation_date&#39;</span>, <span style="color:#e6db74">&#39;review_answer_timestamp&#39;</span>, <span style="color:#e6db74">&#39;order_purchase_timestamp&#39;</span>, <span style="color:#e6db74">&#39;order_id&#39;</span>, <span style="color:#e6db74">&#39;payment_type&#39;</span>],
</span></span><span style="display:flex;"><span>             inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>resumetable(feature)
</span></span></code></pre></div><pre><code>Dataset Shape: (114822, 17)
</code></pre>
  <div id="df-b4c91aaa-e47e-4d86-bc67-97157c686744">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Name</th>
      <th>dtypes</th>
      <th>Missing</th>
      <th>Uniques</th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>customer_unique_id</td>
      <td>object</td>
      <td>0</td>
      <td>92725</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9</td>
      <td>product_photos_qty</td>
      <td>float64</td>
      <td>0</td>
      <td>20</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>15</td>
      <td>approved_purchase_delta</td>
      <td>float64</td>
      <td>0</td>
      <td>32449</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>14</td>
      <td>del_carrier_approved_delta</td>
      <td>float64</td>
      <td>0</td>
      <td>69</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13</td>
      <td>shipping_limit_carrier_delta</td>
      <td>float64</td>
      <td>0</td>
      <td>104</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12</td>
      <td>estimated_delivery_delta</td>
      <td>float64</td>
      <td>0</td>
      <td>196</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>11</td>
      <td>review_ans_delta</td>
      <td>float64</td>
      <td>0</td>
      <td>79859</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10</td>
      <td>product_volume</td>
      <td>float64</td>
      <td>0</td>
      <td>4444</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>product_description_lenght</td>
      <td>float64</td>
      <td>0</td>
      <td>2943</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>product_id</td>
      <td>object</td>
      <td>0</td>
      <td>32064</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>7</td>
      <td>shipping_length</td>
      <td>float64</td>
      <td>0</td>
      <td>145</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>6</td>
      <td>product_weight_g</td>
      <td>float64</td>
      <td>0</td>
      <td>2168</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>5</td>
      <td>review_score</td>
      <td>int64</td>
      <td>0</td>
      <td>5</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>4</td>
      <td>payment_value</td>
      <td>float64</td>
      <td>0</td>
      <td>28439</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>3</td>
      <td>freight_value</td>
      <td>float64</td>
      <td>0</td>
      <td>6902</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2</td>
      <td>price</td>
      <td>float64</td>
      <td>0</td>
      <td>5842</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
      <td>delivery_time</td>
      <td>float64</td>
      <td>0</td>
      <td>143</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b4c91aaa-e47e-4d86-bc67-97157c686744')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-b4c91aaa-e47e-4d86-bc67-97157c686744 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-b4c91aaa-e47e-4d86-bc67-97157c686744');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h4 id="final-feature">Final Feature</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>grouped <span style="color:#f92672">=</span> feature<span style="color:#f92672">.</span>groupby(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;customer_unique_id&#39;</span>,as_index<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#f92672">.</span>agg(
</span></span><span style="display:flex;"><span>    {<span style="color:#e6db74">&#39;shipping_length&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>], 
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;delivery_time&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;product_id&#39;</span>: [<span style="color:#e6db74">&#39;count&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;price&#39;</span>:[<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;freight_value&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;payment_value&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;review_score&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;product_weight_g&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;product_volume&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;product_description_lenght&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;product_photos_qty&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;estimated_delivery_delta&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;del_carrier_approved_delta&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;shipping_limit_carrier_delta&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;approved_purchase_delta&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     <span style="color:#e6db74">&#39;review_ans_delta&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>],
</span></span><span style="display:flex;"><span>     })
</span></span><span style="display:flex;"><span>grouped<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;customer_unique_id&#39;</span>,<span style="color:#e6db74">&#39;avg_shipping_length&#39;</span>, <span style="color:#e6db74">&#39;avg_delivery_time&#39;</span>,
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;product_quantity&#39;</span>, <span style="color:#e6db74">&#39;avg_price&#39;</span>, <span style="color:#e6db74">&#39;avg_freight_value&#39;</span>,
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;avg_payment_value&#39;</span>, <span style="color:#e6db74">&#39;avg_review_score&#39;</span>, <span style="color:#e6db74">&#39;avg_product_weight_g&#39;</span>,
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;avg_product_volume&#39;</span>, <span style="color:#e6db74">&#39;avg_product_desc_length&#39;</span>, <span style="color:#e6db74">&#39;avg_product_photos_qty&#39;</span>,
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;avg_estimated_delivery_delta&#39;</span>, <span style="color:#e6db74">&#39;avg_del_carrier_approved_delta&#39;</span>,
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;avg_shipping_limit_carrier_delta&#39;</span>, <span style="color:#e6db74">&#39;avg_approved_purchase_delta&#39;</span>,
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;avg_review_ans_delta&#39;</span>]
</span></span><span style="display:flex;"><span>grouped
</span></span></code></pre></div>  <div id="df-c76b583a-8e62-4081-a4d0-b7a4411b4e8e">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_unique_id</th>
      <th>avg_shipping_length</th>
      <th>avg_delivery_time</th>
      <th>product_quantity</th>
      <th>avg_price</th>
      <th>avg_freight_value</th>
      <th>avg_payment_value</th>
      <th>avg_review_score</th>
      <th>avg_product_weight_g</th>
      <th>avg_product_volume</th>
      <th>avg_product_desc_length</th>
      <th>avg_product_photos_qty</th>
      <th>avg_estimated_delivery_delta</th>
      <th>avg_del_carrier_approved_delta</th>
      <th>avg_shipping_limit_carrier_delta</th>
      <th>avg_approved_purchase_delta</th>
      <th>avg_review_ans_delta</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000366f3b9a7992bf8c76cfdf3221e2</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1</td>
      <td>129.90</td>
      <td>12.00</td>
      <td>141.90</td>
      <td>5.0</td>
      <td>1500.0</td>
      <td>7616.0</td>
      <td>236.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>891.0</td>
      <td>395088.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000b849f77a49e4a4ce2b2a4ca5be3f</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>18.90</td>
      <td>8.29</td>
      <td>27.19</td>
      <td>4.0</td>
      <td>375.0</td>
      <td>5148.0</td>
      <td>635.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>26057.0</td>
      <td>80965.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000f46a3911fa3c0805444483337064</td>
      <td>23.0</td>
      <td>25.0</td>
      <td>1</td>
      <td>69.00</td>
      <td>17.22</td>
      <td>86.22</td>
      <td>3.0</td>
      <td>1500.0</td>
      <td>43750.0</td>
      <td>177.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>91184.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000f6ccb0745a6a4b88665a16c9f078</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>1</td>
      <td>25.99</td>
      <td>17.63</td>
      <td>43.62</td>
      <td>4.0</td>
      <td>150.0</td>
      <td>1045.0</td>
      <td>1741.0</td>
      <td>5.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1176.0</td>
      <td>87471.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0004aac84e0df4da2b147fca70cf8255</td>
      <td>11.0</td>
      <td>13.0</td>
      <td>1</td>
      <td>180.00</td>
      <td>16.89</td>
      <td>196.89</td>
      <td>5.0</td>
      <td>6050.0</td>
      <td>528.0</td>
      <td>794.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>1270.0</td>
      <td>426575.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>92720</th>
      <td>fffcf5a5ff07b0908bd4e2dbc735a684</td>
      <td>13.0</td>
      <td>27.0</td>
      <td>2</td>
      <td>785.00</td>
      <td>248.71</td>
      <td>2067.42</td>
      <td>5.0</td>
      <td>30000.0</td>
      <td>251625.0</td>
      <td>478.5</td>
      <td>1.0</td>
      <td>26.0</td>
      <td>14.0</td>
      <td>2.0</td>
      <td>880.0</td>
      <td>386405.0</td>
    </tr>
    <tr>
      <th>92721</th>
      <td>fffea47cd6d3cc0a88bd621562a9d061</td>
      <td>19.0</td>
      <td>30.0</td>
      <td>1</td>
      <td>64.89</td>
      <td>19.69</td>
      <td>84.58</td>
      <td>4.0</td>
      <td>1720.0</td>
      <td>32076.0</td>
      <td>506.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>-7.0</td>
      <td>504.0</td>
      <td>474719.0</td>
    </tr>
    <tr>
      <th>92722</th>
      <td>ffff371b4d645b6ecea244b27531430a</td>
      <td>14.0</td>
      <td>14.0</td>
      <td>1</td>
      <td>89.90</td>
      <td>22.56</td>
      <td>112.46</td>
      <td>5.0</td>
      <td>600.0</td>
      <td>3315.0</td>
      <td>716.0</td>
      <td>5.0</td>
      <td>29.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>808.0</td>
      <td>227001.0</td>
    </tr>
    <tr>
      <th>92723</th>
      <td>ffff5962728ec6157033ef9805bacc48</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>1</td>
      <td>115.00</td>
      <td>18.69</td>
      <td>133.69</td>
      <td>5.0</td>
      <td>444.0</td>
      <td>4480.0</td>
      <td>591.0</td>
      <td>3.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>2466.0</td>
      <td>227780.0</td>
    </tr>
    <tr>
      <th>92724</th>
      <td>ffffd2657e2aad2907e67c3e9daecbeb</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>1</td>
      <td>56.99</td>
      <td>14.57</td>
      <td>71.56</td>
      <td>5.0</td>
      <td>400.0</td>
      <td>2178.0</td>
      <td>1003.0</td>
      <td>2.0</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>68188.0</td>
      <td>212124.0</td>
    </tr>
  </tbody>
</table>
<p>92725 rows × 17 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c76b583a-8e62-4081-a4d0-b7a4411b4e8e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-c76b583a-8e62-4081-a4d0-b7a4411b4e8e button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-c76b583a-8e62-4081-a4d0-b7a4411b4e8e');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#Merge grouped, rfma and payment_type encoding</span>
</span></span><span style="display:flex;"><span>final_features <span style="color:#f92672">=</span> grouped<span style="color:#f92672">.</span>merge(rfm,on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;customer_unique_id&#39;</span>)
</span></span><span style="display:flex;"><span>final_features <span style="color:#f92672">=</span> final_features<span style="color:#f92672">.</span>merge(pay_type,on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;customer_unique_id&#39;</span>)
</span></span><span style="display:flex;"><span>final_features
</span></span></code></pre></div>  <div id="df-5282d2a3-0a9a-42a4-ac53-ce74f97ef553">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_unique_id</th>
      <th>avg_shipping_length</th>
      <th>avg_delivery_time</th>
      <th>product_quantity</th>
      <th>avg_price</th>
      <th>avg_freight_value</th>
      <th>avg_payment_value</th>
      <th>avg_review_score</th>
      <th>avg_product_weight_g</th>
      <th>avg_product_volume</th>
      <th>avg_product_desc_length</th>
      <th>avg_product_photos_qty</th>
      <th>avg_estimated_delivery_delta</th>
      <th>avg_del_carrier_approved_delta</th>
      <th>avg_shipping_limit_carrier_delta</th>
      <th>avg_approved_purchase_delta</th>
      <th>avg_review_ans_delta</th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>trans_age</th>
      <th>payment_boleto</th>
      <th>payment_credit_card</th>
      <th>payment_debit_card</th>
      <th>payment_voucher</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000366f3b9a7992bf8c76cfdf3221e2</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1</td>
      <td>129.90</td>
      <td>12.00</td>
      <td>141.90</td>
      <td>5.0</td>
      <td>1500.0</td>
      <td>7616.0</td>
      <td>236.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>891.0</td>
      <td>395088.0</td>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000b849f77a49e4a4ce2b2a4ca5be3f</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>18.90</td>
      <td>8.29</td>
      <td>27.19</td>
      <td>4.0</td>
      <td>375.0</td>
      <td>5148.0</td>
      <td>635.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>26057.0</td>
      <td>80965.0</td>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000f46a3911fa3c0805444483337064</td>
      <td>23.0</td>
      <td>25.0</td>
      <td>1</td>
      <td>69.00</td>
      <td>17.22</td>
      <td>86.22</td>
      <td>3.0</td>
      <td>1500.0</td>
      <td>43750.0</td>
      <td>177.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>91184.0</td>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000f6ccb0745a6a4b88665a16c9f078</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>1</td>
      <td>25.99</td>
      <td>17.63</td>
      <td>43.62</td>
      <td>4.0</td>
      <td>150.0</td>
      <td>1045.0</td>
      <td>1741.0</td>
      <td>5.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1176.0</td>
      <td>87471.0</td>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0004aac84e0df4da2b147fca70cf8255</td>
      <td>11.0</td>
      <td>13.0</td>
      <td>1</td>
      <td>180.00</td>
      <td>16.89</td>
      <td>196.89</td>
      <td>5.0</td>
      <td>6050.0</td>
      <td>528.0</td>
      <td>794.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>1270.0</td>
      <td>426575.0</td>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>92720</th>
      <td>fffcf5a5ff07b0908bd4e2dbc735a684</td>
      <td>13.0</td>
      <td>27.0</td>
      <td>2</td>
      <td>785.00</td>
      <td>248.71</td>
      <td>2067.42</td>
      <td>5.0</td>
      <td>30000.0</td>
      <td>251625.0</td>
      <td>478.5</td>
      <td>1.0</td>
      <td>26.0</td>
      <td>14.0</td>
      <td>2.0</td>
      <td>880.0</td>
      <td>386405.0</td>
      <td>447</td>
      <td>1</td>
      <td>4134.84</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>92721</th>
      <td>fffea47cd6d3cc0a88bd621562a9d061</td>
      <td>19.0</td>
      <td>30.0</td>
      <td>1</td>
      <td>64.89</td>
      <td>19.69</td>
      <td>84.58</td>
      <td>4.0</td>
      <td>1720.0</td>
      <td>32076.0</td>
      <td>506.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>-7.0</td>
      <td>504.0</td>
      <td>474719.0</td>
      <td>262</td>
      <td>1</td>
      <td>84.58</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>92722</th>
      <td>ffff371b4d645b6ecea244b27531430a</td>
      <td>14.0</td>
      <td>14.0</td>
      <td>1</td>
      <td>89.90</td>
      <td>22.56</td>
      <td>112.46</td>
      <td>5.0</td>
      <td>600.0</td>
      <td>3315.0</td>
      <td>716.0</td>
      <td>5.0</td>
      <td>29.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>808.0</td>
      <td>227001.0</td>
      <td>568</td>
      <td>1</td>
      <td>112.46</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>92723</th>
      <td>ffff5962728ec6157033ef9805bacc48</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>1</td>
      <td>115.00</td>
      <td>18.69</td>
      <td>133.69</td>
      <td>5.0</td>
      <td>444.0</td>
      <td>4480.0</td>
      <td>591.0</td>
      <td>3.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>2466.0</td>
      <td>227780.0</td>
      <td>119</td>
      <td>1</td>
      <td>133.69</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>92724</th>
      <td>ffffd2657e2aad2907e67c3e9daecbeb</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>1</td>
      <td>56.99</td>
      <td>14.57</td>
      <td>71.56</td>
      <td>5.0</td>
      <td>400.0</td>
      <td>2178.0</td>
      <td>1003.0</td>
      <td>2.0</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>68188.0</td>
      <td>212124.0</td>
      <td>484</td>
      <td>1</td>
      <td>71.56</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>92725 rows × 25 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5282d2a3-0a9a-42a4-ac53-ce74f97ef553')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-5282d2a3-0a9a-42a4-ac53-ce74f97ef553 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-5282d2a3-0a9a-42a4-ac53-ce74f97ef553');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>resumetable(final_features)
</span></span></code></pre></div><pre><code>Dataset Shape: (92725, 25)
</code></pre>
  <div id="df-25bbc74f-5ebf-4f96-a1da-c4f926d6206c">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Name</th>
      <th>dtypes</th>
      <th>Missing</th>
      <th>Uniques</th>
      <th>Missing Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>customer_unique_id</td>
      <td>object</td>
      <td>0</td>
      <td>92725</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13</td>
      <td>avg_del_carrier_approved_delta</td>
      <td>float64</td>
      <td>0</td>
      <td>205</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>23</td>
      <td>payment_debit_card</td>
      <td>uint8</td>
      <td>0</td>
      <td>8</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22</td>
      <td>payment_credit_card</td>
      <td>uint8</td>
      <td>0</td>
      <td>17</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21</td>
      <td>payment_boleto</td>
      <td>uint8</td>
      <td>0</td>
      <td>17</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>20</td>
      <td>trans_age</td>
      <td>int64</td>
      <td>0</td>
      <td>414</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>19</td>
      <td>Monetary</td>
      <td>float64</td>
      <td>0</td>
      <td>30340</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>18</td>
      <td>Frequency</td>
      <td>int64</td>
      <td>0</td>
      <td>9</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>17</td>
      <td>Recency</td>
      <td>int64</td>
      <td>0</td>
      <td>610</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>16</td>
      <td>avg_review_ans_delta</td>
      <td>float64</td>
      <td>0</td>
      <td>78500</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>15</td>
      <td>avg_approved_purchase_delta</td>
      <td>float64</td>
      <td>0</td>
      <td>32867</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>14</td>
      <td>avg_shipping_limit_carrier_delta</td>
      <td>float64</td>
      <td>0</td>
      <td>275</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
      <td>avg_estimated_delivery_delta</td>
      <td>float64</td>
      <td>0</td>
      <td>471</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1</td>
      <td>avg_shipping_length</td>
      <td>float64</td>
      <td>0</td>
      <td>372</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>11</td>
      <td>avg_product_photos_qty</td>
      <td>float64</td>
      <td>0</td>
      <td>119</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>10</td>
      <td>avg_product_desc_length</td>
      <td>float64</td>
      <td>0</td>
      <td>4697</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>9</td>
      <td>avg_product_volume</td>
      <td>float64</td>
      <td>0</td>
      <td>7228</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>8</td>
      <td>avg_product_weight_g</td>
      <td>float64</td>
      <td>0</td>
      <td>3262</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>7</td>
      <td>avg_review_score</td>
      <td>float64</td>
      <td>0</td>
      <td>64</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>6</td>
      <td>avg_payment_value</td>
      <td>float64</td>
      <td>0</td>
      <td>29509</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>5</td>
      <td>avg_freight_value</td>
      <td>float64</td>
      <td>0</td>
      <td>8624</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>4</td>
      <td>avg_price</td>
      <td>float64</td>
      <td>0</td>
      <td>8146</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>3</td>
      <td>product_quantity</td>
      <td>int64</td>
      <td>0</td>
      <td>26</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2</td>
      <td>avg_delivery_time</td>
      <td>float64</td>
      <td>0</td>
      <td>369</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>24</td>
      <td>payment_voucher</td>
      <td>uint8</td>
      <td>0</td>
      <td>26</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-25bbc74f-5ebf-4f96-a1da-c4f926d6206c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-25bbc74f-5ebf-4f96-a1da-c4f926d6206c button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-25bbc74f-5ebf-4f96-a1da-c4f926d6206c');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<p>Melihat korelasi antar fitur</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>heatmap(final_features<span style="color:#f92672">.</span>corr())
</span></span></code></pre></div><pre><code>&lt;AxesSubplot:&gt;
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_243_1.png" alt="png"></p>
<h2 id="customer-segmentation">Customer Segmentation</h2>
<h3 id="rfm-analysis">RFM Analysis</h3>
<p>&ldquo;RFM&rdquo; adalah singkatan dari Recency, Frequency dan Monetary. Analisis RFM adalah cara menggunakan data berdasarkan perilaku pelanggan yang ada untuk memprediksi bagaimana kemungkinan tindakan pelanggan baru di masa depan. Model RFM dibangun menggunakan tiga faktor utama:</p>
<ul>
<li>seberapa baru pelanggan bertransaksi (Recency)</li>
<li>seberapa sering mereka melakukan transaksi (Frequency)</li>
<li>berapa banyak uang yang mereka habiskan untuk produk dan layanan merek (Monetary)</li>
</ul>
<p><strong>Recency</strong>: Ini mengacu pada jumlah waktu sejak transaksi terakhir pelanggan, yang dapat mencakup pembelian terakhir mereka, kunjungan ke situs web, penggunaan aplikasi seluler. Recency adalah metrik utama karena pelanggan yang baru-baru ini melakukan transaksi akan lebih cenderung merespons upaya pemasaran baru.</p>
<p><strong>Frequency</strong>: Ini mengacu pada berapa kali pelanggan melakukan pembelian atau berinteraksi dengan merek Anda selama periode waktu tertentu. Frekuensi adalah metrik utama karena menunjukkan seberapa dalam pelanggan terlibat dengan merek Anda. Frekuensi yang lebih besar menunjukkan tingkat loyalitas pelanggan yang lebih tinggi.</p>
<p><strong>Monetary</strong>: Ini mengacu pada jumlah total yang telah dihabiskan pelanggan untuk membeli produk dan layanan dari merek Anda selama periode waktu tertentu. Nilai moneter adalah metrik utama karena pelanggan yang telah menghabiskan paling banyak di masa lalu lebih cenderung membelanjakan lebih banyak di masa depan.</p>
<p>Kita sebelumnya sudah menghitung nilai RFM untuk masing-masing customer, sekarang saatnya melakukan analisis lebih lanjut</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RFM_df <span style="color:#f92672">=</span> final_features<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;customer_unique_id&#39;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RFM_df <span style="color:#f92672">=</span> RFM_df<span style="color:#f92672">.</span>loc[:, [<span style="color:#e6db74">&#39;Recency&#39;</span>, <span style="color:#e6db74">&#39;Frequency&#39;</span>, <span style="color:#e6db74">&#39;Monetary&#39;</span>]]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RFM_df<span style="color:#f92672">.</span>describe()<span style="color:#f92672">.</span>T
</span></span></code></pre></div>  <div id="df-7b992b84-d8a2-4fdd-9686-eff83fc88cc2">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Recency</th>
      <td>92725.0</td>
      <td>237.278210</td>
      <td>152.571038</td>
      <td>0.00</td>
      <td>114.00</td>
      <td>218.00</td>
      <td>346.00</td>
      <td>695.00</td>
    </tr>
    <tr>
      <th>Frequency</th>
      <td>92725.0</td>
      <td>1.033141</td>
      <td>0.208351</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>15.00</td>
    </tr>
    <tr>
      <th>Monetary</th>
      <td>92725.0</td>
      <td>212.073725</td>
      <td>630.037331</td>
      <td>9.59</td>
      <td>63.79</td>
      <td>113.03</td>
      <td>201.99</td>
      <td>109312.64</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7b992b84-d8a2-4fdd-9686-eff83fc88cc2')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-7b992b84-d8a2-4fdd-9686-eff83fc88cc2 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-7b992b84-d8a2-4fdd-9686-eff83fc88cc2');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">12</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>); sns<span style="color:#f92672">.</span>distplot(RFM_df[<span style="color:#e6db74">&#39;Recency&#39;</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>); sns<span style="color:#f92672">.</span>distplot(RFM_df[<span style="color:#e6db74">&#39;Frequency&#39;</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>); sns<span style="color:#f92672">.</span>distplot(RFM_df[<span style="color:#e6db74">&#39;Monetary&#39;</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_251_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RFM_df<span style="color:#f92672">.</span>info()
</span></span></code></pre></div><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 92725 entries, 0000366f3b9a7992bf8c76cfdf3221e2 to ffffd2657e2aad2907e67c3e9daecbeb
Data columns (total 3 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   Recency    92725 non-null  int64  
 1   Frequency  92725 non-null  int64  
 2   Monetary   92725 non-null  float64
dtypes: float64(1), int64(2)
memory usage: 2.8+ MB
</code></pre>
<h4 id="checking-outliers">Checking Outliers</h4>
<p>Mengecek adanya outlier dan menghilangkannya, karena outlier bisa mengaburkan analisis karena nilainya bisa sangat mempengaruhi perhitungan dan membuat data menjadi tidak representatif.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#34;Recency&#34;</span>, <span style="color:#e6db74">&#34;Frequency&#34;</span>, <span style="color:#e6db74">&#34;Monetary&#34;</span>]:
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>gca()<span style="color:#f92672">.</span>set(xlabel<span style="color:#f92672">=</span> i, ylabel<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Frequency&#39;</span>)
</span></span><span style="display:flex;"><span>    sns<span style="color:#f92672">.</span>boxplot(x <span style="color:#f92672">=</span> RFM_df[i])
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_255_0.png" alt="png"></p>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_255_1.png" alt="png"></p>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_255_2.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">num_outlier</span>(df_in, col_name):
</span></span><span style="display:flex;"><span>    q1 <span style="color:#f92672">=</span> df_in[col_name]<span style="color:#f92672">.</span>quantile(<span style="color:#ae81ff">0.05</span>)
</span></span><span style="display:flex;"><span>    q3 <span style="color:#f92672">=</span> df_in[col_name]<span style="color:#f92672">.</span>quantile(<span style="color:#ae81ff">0.95</span>)
</span></span><span style="display:flex;"><span>    iqr <span style="color:#f92672">=</span> q3<span style="color:#f92672">-</span>q1 <span style="color:#75715e">#Interquartile range</span>
</span></span><span style="display:flex;"><span>    fence_low  <span style="color:#f92672">=</span> q1<span style="color:#f92672">-</span><span style="color:#ae81ff">1.5</span><span style="color:#f92672">*</span>iqr
</span></span><span style="display:flex;"><span>    fence_high <span style="color:#f92672">=</span> q3<span style="color:#f92672">+</span><span style="color:#ae81ff">1.5</span><span style="color:#f92672">*</span>iqr
</span></span><span style="display:flex;"><span>    outliers_df<span style="color:#f92672">=</span> df_in<span style="color:#f92672">.</span>loc[(df_in[col_name] <span style="color:#f92672">&lt;</span> fence_low) <span style="color:#f92672">|</span> (df_in[col_name] <span style="color:#f92672">&gt;</span> fence_high)]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> print(<span style="color:#e6db74">&#34;Number of outliers in </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> column: &#34;</span><span style="color:#f92672">.</span>format(col_name), len(outliers_df)), print(<span style="color:#e6db74">&#34;Indexes: &#34;</span>, outliers_df<span style="color:#f92672">.</span>index)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#34;Recency&#34;</span>, <span style="color:#e6db74">&#34;Frequency&#34;</span>, <span style="color:#e6db74">&#34;Monetary&#34;</span>]:
</span></span><span style="display:flex;"><span>    num_outlier(RFM_df, i)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;*&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">40</span>)
</span></span></code></pre></div><pre><code>Number of outliers in Recency column:  0
Indexes:  Index([], dtype='object', name='customer_unique_id')
****************************************
Number of outliers in Frequency column:  2760
Indexes:  Index(['004288347e5e88a27ded2bb23747066c', '00a39521eb40f7012db50455bf083460',
       '00cc12a6d8b578b8ebd21ea4e2ae8b27', '011575986092c30523ecb71ff10cb473',
       '011b4adcd54683b480c4d841250a987f', '012452d40dafae4df401bced74cdb490',
       '012a218df8995d3ec3bb221828360c86', '013ef03e0f3f408dd9bf555e4edcdc0a',
       '013f4353d26bb05dc6652f1269458d8d', '015557c9912277312b9073947804a7ba',
       ...
       'fe59d5878cd80080edbd29b5a0a4e1cf', 'fe613188d4d20ea3e3dc1290549c3ad1',
       'fe81bb32c243a86b2f86fbf053fe6140', 'fed2005ccab4fcf1a40ebdaff032a148',
       'fed519569d16e690df6f89cb99d4e682', 'ff03923ad1eb9e32304deb7f9b2a45c9',
       'ff44401d0d8f5b9c54a47374eb48c1b8', 'ff8892f7c26aa0446da53d01b18df463',
       'ff922bdd6bafcdf99cb90d7f39cea5b3', 'ffe254cc039740e17dd15a5305035928'],
      dtype='object', name='customer_unique_id', length=2760)
****************************************
Number of outliers in Monetary column:  1020
Indexes:  Index(['0096c18412349537abc45e350581cbbc', '00adeda9b742746c0c66e10d00ea1b74',
       '00c07da5ba0e07b4f248a3a373b07476', '011875f0176909c5cf0b14a9138bb691',
       '01726e5d6a88d1a8dffd9578872ce54e', '01858f2fad256b1689f5bdafc059f745',
       '019ac5580a897d52e5ed6f7ed89ade27', '019ed386aec9ff0f9eab4a590231174e',
       '01e123d7c7cedf12af483fc17258b9ce', '0209f290b5451d357308bc0e90521026',
       ...
       'ff0ae98646e7bbb41cf0f0d3991fef98', 'ff0e4a6f3114ad1d211b885159bf1eb2',
       'ff20fff170ed80db557b344c839df854', 'ff4159b92c40ebe40454e3e6a7c35ed6',
       'ff5f29fbfd0a13f7e7ed9f7b92a32194', 'ff7f36f6ba0f1126bb95b635322cf9d2',
       'ff8eddc3ff272a5724e2ac6635cb7df2', 'ffba9f9dff87b05e310ecc46c8591044',
       'fff5eb4918b2bf4b2da476788d42051c', 'fffcf5a5ff07b0908bd4e2dbc735a684'],
      dtype='object', name='customer_unique_id', length=1020)
****************************************
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RFM_df<span style="color:#f92672">.</span>shape
</span></span></code></pre></div><pre><code>(92725, 3)
</code></pre>
<p>Handling Outliers</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">remove_outlier</span>(df_in, col_name):
</span></span><span style="display:flex;"><span>    q1 <span style="color:#f92672">=</span> df_in[col_name]<span style="color:#f92672">.</span>quantile(<span style="color:#ae81ff">0.05</span>)
</span></span><span style="display:flex;"><span>    q3 <span style="color:#f92672">=</span> df_in[col_name]<span style="color:#f92672">.</span>quantile(<span style="color:#ae81ff">0.95</span>)
</span></span><span style="display:flex;"><span>    iqr <span style="color:#f92672">=</span> q3<span style="color:#f92672">-</span>q1     
</span></span><span style="display:flex;"><span>    fence_low  <span style="color:#f92672">=</span> q1<span style="color:#f92672">-</span><span style="color:#ae81ff">1.5</span><span style="color:#f92672">*</span>iqr
</span></span><span style="display:flex;"><span>    fence_high <span style="color:#f92672">=</span> q3<span style="color:#f92672">+</span><span style="color:#ae81ff">1.5</span><span style="color:#f92672">*</span>iqr
</span></span><span style="display:flex;"><span>    index_outliers<span style="color:#f92672">=</span> df_in<span style="color:#f92672">.</span>loc[(df_in[col_name] <span style="color:#f92672">&lt;</span> fence_low) <span style="color:#f92672">|</span> (df_in[col_name] <span style="color:#f92672">&gt;</span> fence_high)]<span style="color:#f92672">.</span>index
</span></span><span style="display:flex;"><span>    df_in<span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(df_in<span style="color:#f92672">.</span>drop(index_outliers<span style="color:#f92672">.</span>to_list(), axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>))
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Outliers in the </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> column have been removed&#34;</span><span style="color:#f92672">.</span>format(col_name))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> df_in
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#34;Recency&#34;</span>, <span style="color:#e6db74">&#34;Monetary&#34;</span>]:
</span></span><span style="display:flex;"><span>    remove_outlier(RFM_df, i)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;*&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">40</span>)
</span></span></code></pre></div><pre><code>Outliers in the Recency column have been removed
****************************************
Outliers in the Monetary column have been removed
****************************************
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RFM_df<span style="color:#f92672">.</span>shape
</span></span></code></pre></div><pre><code>(91705, 3)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RFM_df
</span></span></code></pre></div>  <div id="df-b3d98e3b-39f2-4199-b72a-c102c8739a21">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
    </tr>
    <tr>
      <th>customer_unique_id</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0000366f3b9a7992bf8c76cfdf3221e2</th>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
    </tr>
    <tr>
      <th>0000b849f77a49e4a4ce2b2a4ca5be3f</th>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
    </tr>
    <tr>
      <th>0000f46a3911fa3c0805444483337064</th>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
    </tr>
    <tr>
      <th>0000f6ccb0745a6a4b88665a16c9f078</th>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
    </tr>
    <tr>
      <th>0004aac84e0df4da2b147fca70cf8255</th>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>fffbf87b7a1a6fa8b03f081c5f51a201</th>
      <td>245</td>
      <td>1</td>
      <td>167.32</td>
    </tr>
    <tr>
      <th>fffea47cd6d3cc0a88bd621562a9d061</th>
      <td>262</td>
      <td>1</td>
      <td>84.58</td>
    </tr>
    <tr>
      <th>ffff371b4d645b6ecea244b27531430a</th>
      <td>568</td>
      <td>1</td>
      <td>112.46</td>
    </tr>
    <tr>
      <th>ffff5962728ec6157033ef9805bacc48</th>
      <td>119</td>
      <td>1</td>
      <td>133.69</td>
    </tr>
    <tr>
      <th>ffffd2657e2aad2907e67c3e9daecbeb</th>
      <td>484</td>
      <td>1</td>
      <td>71.56</td>
    </tr>
  </tbody>
</table>
<p>91705 rows × 3 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b3d98e3b-39f2-4199-b72a-c102c8739a21')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-b3d98e3b-39f2-4199-b72a-c102c8739a21 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-b3d98e3b-39f2-4199-b72a-c102c8739a21');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h4 id="rfm-segments">RFM Segments</h4>
<p>Segmentasi pelanggan adalah proses membagi pelanggan ke dalam kelompok yang berbeda berdasarkan karakteristik umum. Dalam konteks proyek ini, saya akan mengelompokkan pelanggan berdasarkan RFM yang sebelumnya telah dibuat. RFM diklasifikasikan sebagai &ldquo;segmentasi perilaku&rdquo; (karena mengidentifikasi kecenderungan dan tindakan serta kebiasaan pelanggan yang sering dilakukan) dan &ldquo;segmentasi berbasis nilai&rdquo; (karena pelanggan dibagi berdasarkan nilai ekonomi yang mereka berikan kepada bisnis). Segmentasi ini akan membantu perusahaan dalam menentukan strategi/treatment yang tepat berdasarkan segmen ini.</p>
<p>Dalam komputasi, saya akan menerapkan fungsi pada pandas, yakni <code>pd.qcut</code> untuk menjadi beberapa kelompok dengan rentang nilai yang sama. Saya membagi setiap variabel baru menjadi &ldquo;5&rdquo; gelongan (skor dari 1-5) karena ini adalah standar industri yang menawarkan perincian yang lebih baik. Recency adalah jumlah hari sejak pembelian terakhir. Pelanggan dengan nilai Recency terendah akan mendapat skor tertinggi, karena perusahaan tentu ingin pelanggan kembali lebih sering. Oleh karena itu, semakin rendah skor Recency, semakin tinggi peringkatnya  diantara 1-5. Sebaliknya, pelanggan dengan nilai Frequency dan Monetary tinggi, akan mendapat skor tertinggi antara 1-5, karena pelanggan yang menghabiskan lebih banyak uang dan membeli lebih sering cenderung tidak berhenti bertransaksi.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rfm_segmentation <span style="color:#f92672">=</span> RFM_df
</span></span><span style="display:flex;"><span>rfm_segmentation[<span style="color:#e6db74">&#34;R&#34;</span>]  <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>qcut(RFM_df[<span style="color:#e6db74">&#34;Recency&#34;</span>], <span style="color:#ae81ff">5</span>, labels <span style="color:#f92672">=</span> [<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">4</span> , <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>]) 
</span></span><span style="display:flex;"><span>rfm_segmentation[<span style="color:#e6db74">&#34;F&#34;</span>]<span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>qcut(RFM_df[<span style="color:#e6db74">&#34;Frequency&#34;</span>]<span style="color:#f92672">.</span>rank(method<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;first&#34;</span>),<span style="color:#ae81ff">5</span>, labels<span style="color:#f92672">=</span>[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>])
</span></span><span style="display:flex;"><span>rfm_segmentation[<span style="color:#e6db74">&#34;M&#34;</span>] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>qcut(RFM_df[<span style="color:#e6db74">&#39;Monetary&#39;</span>], <span style="color:#ae81ff">5</span>, labels <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>])
</span></span><span style="display:flex;"><span>rfm_segmentation<span style="color:#f92672">.</span>head()
</span></span></code></pre></div>  <div id="df-995e4019-2257-46b6-a312-249c9d854c35">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
    </tr>
    <tr>
      <th>customer_unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0000366f3b9a7992bf8c76cfdf3221e2</th>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>0000b849f77a49e4a4ce2b2a4ca5be3f</th>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0000f46a3911fa3c0805444483337064</th>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>0000f6ccb0745a6a4b88665a16c9f078</th>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0004aac84e0df4da2b147fca70cf8255</th>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-995e4019-2257-46b6-a312-249c9d854c35')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-995e4019-2257-46b6-a312-249c9d854c35 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-995e4019-2257-46b6-a312-249c9d854c35');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rfm_segmentation<span style="color:#f92672">.</span>dtypes
</span></span></code></pre></div><pre><code>Recency         int64
Frequency       int64
Monetary      float64
R            category
F            category
M            category
dtype: object
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Mengubah variabel RFM ke numerik</span>
</span></span><span style="display:flex;"><span>rfm_segmentation[<span style="color:#e6db74">&#39;R&#39;</span>] <span style="color:#f92672">=</span> rfm_segmentation[<span style="color:#e6db74">&#39;R&#39;</span>]<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int&#39;</span>)
</span></span><span style="display:flex;"><span>rfm_segmentation[<span style="color:#e6db74">&#39;F&#39;</span>] <span style="color:#f92672">=</span> rfm_segmentation[<span style="color:#e6db74">&#39;F&#39;</span>]<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int&#39;</span>)
</span></span><span style="display:flex;"><span>rfm_segmentation[<span style="color:#e6db74">&#39;M&#39;</span>] <span style="color:#f92672">=</span> rfm_segmentation[<span style="color:#e6db74">&#39;M&#39;</span>]<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;int&#39;</span>)
</span></span></code></pre></div><p>Selanjutnya saya akan nenggabungkan skor RFM individual. Skor RFM akhir dihitung hanya dengan menggabungkan angka skor RFM individual, seperti yang terlihat pada kolom &ldquo;RFM_Score&rdquo;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Memnggabungkan Skor RFM</span>
</span></span><span style="display:flex;"><span>rfm_segmentation[<span style="color:#e6db74">&#39;RFM_Score&#39;</span>] <span style="color:#f92672">=</span> rfm_segmentation[<span style="color:#e6db74">&#39;R&#39;</span>]<span style="color:#f92672">.</span>map(str) <span style="color:#f92672">+</span> rfm_segmentation[<span style="color:#e6db74">&#39;F&#39;</span>]<span style="color:#f92672">.</span>map(str) <span style="color:#f92672">+</span> rfm_segmentation[<span style="color:#e6db74">&#39;M&#39;</span>]<span style="color:#f92672">.</span>map(str)
</span></span><span style="display:flex;"><span>rfm_segmentation<span style="color:#f92672">.</span>head()
</span></span></code></pre></div>  <div id="df-7c81d75f-da31-4cf6-b91c-425413372a00">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>RFM_Score</th>
    </tr>
    <tr>
      <th>customer_unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0000366f3b9a7992bf8c76cfdf3221e2</th>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>414</td>
    </tr>
    <tr>
      <th>0000b849f77a49e4a4ce2b2a4ca5be3f</th>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>411</td>
    </tr>
    <tr>
      <th>0000f46a3911fa3c0805444483337064</th>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>112</td>
    </tr>
    <tr>
      <th>0000f6ccb0745a6a4b88665a16c9f078</th>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>211</td>
    </tr>
    <tr>
      <th>0004aac84e0df4da2b147fca70cf8255</th>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>214</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7c81d75f-da31-4cf6-b91c-425413372a00')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-7c81d75f-da31-4cf6-b91c-425413372a00 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-7c81d75f-da31-4cf6-b91c-425413372a00');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<p>Dengan penggabungan skor RFM, kita akan memiliki 5^3 atau 125 kombinasi skor, yang mana akan terlalu banyak jika kita melakukan segmentasi untuk masing&rdquo; kombinasi skor. Maka dari itu saya akan menyederhanakan segmentasi, dengan mengelompokkannya menjadi beberapa segmen saja. Untuk mempersimpel komputasi, saya akan menggunakan nilai rata&rdquo; FM terlebih dahulu.</p>
<pre><code>                                               FM = (F+M)/2
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> math
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">truncate</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> math<span style="color:#f92672">.</span>trunc(x)
</span></span><span style="display:flex;"><span>rfm_segmentation[<span style="color:#e6db74">&#39;FM&#39;</span>] <span style="color:#f92672">=</span> ((rfm_segmentation[<span style="color:#e6db74">&#39;F&#39;</span>] <span style="color:#f92672">+</span> rfm_segmentation[<span style="color:#e6db74">&#39;M&#39;</span>])<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: truncate(x))
</span></span><span style="display:flex;"><span>rfm_segmentation<span style="color:#f92672">.</span>head()
</span></span></code></pre></div>  <div id="df-f5ce9a39-5141-47a2-bfba-4018773b8fa2">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>RFM_Score</th>
      <th>FM</th>
    </tr>
    <tr>
      <th>customer_unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0000366f3b9a7992bf8c76cfdf3221e2</th>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>414</td>
      <td>2</td>
    </tr>
    <tr>
      <th>0000b849f77a49e4a4ce2b2a4ca5be3f</th>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>411</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0000f46a3911fa3c0805444483337064</th>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>112</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0000f6ccb0745a6a4b88665a16c9f078</th>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>211</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0004aac84e0df4da2b147fca70cf8255</th>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>214</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f5ce9a39-5141-47a2-bfba-4018773b8fa2')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-f5ce9a39-5141-47a2-bfba-4018773b8fa2 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-f5ce9a39-5141-47a2-bfba-4018773b8fa2');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<p>Berdasarkan skor RFM yang akan ditemukan, kita akan tahu apakah pelanggan lebih cenderung churn atau tidak. Saya akan mengkalisifikasikan pelanggan dalam segmen berikut:</p>
<ul>
<li>
<p><strong>Champions:</strong> Pelanggan terbaik/impian, karena baru-baru ini membeli dan mentransaksikan nilai dan volume produk tertinggi.</p>
</li>
<li>
<p><strong>Potential Loyalist:</strong> Pelanggan baru dengan nilai transaksi tinggi yang perlu dihargai dan ditreatment dengan baik untuk menjadi pelanggan loyal.</p>
</li>
<li>
<p><strong>New Customer:</strong> Pelanggan yang baru melakukan transaksi, dimana pelanggan ini perlu ditreatment dengan baik agar menjadi pelanggan yang loyal(kembali bertransksi)</p>
</li>
<li>
<p><strong>Loyal Customer:</strong> Pelanggan yang cukup teratur dalam bertransaksi, dengan nilai dan volume yang cukup tinggi.</p>
</li>
<li>
<p><strong>Need Attention:</strong> Pelanggan yang memiliki rata-rata RFM diatas rata&rdquo;, akan tetapi belum melakukan transaksi diakhir&rdquo; ini.</p>
</li>
<li>
<p><strong>About to Sleep:</strong> Pelanggan lama yang sudah lama tidak melakukan pembelian, bisa hilang jika tidak diaktifkan kembali. Berpotensi Churn.</p>
</li>
<li>
<p><strong>Menjanjikan:</strong> Pelanggan terakhir yang belum banyak bertransaksi.</p>
</li>
<li>
<p><strong>Can&rsquo;t Loose:</strong> Pelanggan bernilai tinggi. Sering melakukan pembelian volume tinggi tetapi tidak kembali dalam waktu yang lama. Berpotensi churn</p>
</li>
<li>
<p><strong>Beresiko:</strong> Sering ditransaksikan dengan nilai tinggi, tetapi sudah lama sekali. Karena itu, mereka perlu dibawa kembali. Berpotensi Churn.</p>
</li>
<li>
<p><strong>Hibernasi:</strong> Transaksi terakhir sudah lama, frekuensi dan nilai transaksi rendah. Berpotensi Churn.</p>
</li>
<li>
<p><strong>Hilang:</strong> Transkasi sejak dahulu kala dan bisa dipastikan tidak pernah kembali (churned).</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># RFM Segments</span>
</span></span><span style="display:flex;"><span>seg_map <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;22&#39;</span>: <span style="color:#e6db74">&#39;Hibernating&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;[1-2][1-2]&#39;</span>: <span style="color:#e6db74">&#39;Lost&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;15&#39;</span>: <span style="color:#e6db74">&#39;Can</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">t Lose&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;[1-2][3-5]&#39;</span>: <span style="color:#e6db74">&#39;At Risk&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;3[1-2]&#39;</span>: <span style="color:#e6db74">&#39;About to Sleep&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;33&#39;</span>: <span style="color:#e6db74">&#39;Need Attention&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;55&#39;</span>: <span style="color:#e6db74">&#39;Champions&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;[3-5][4-5]&#39;</span>: <span style="color:#e6db74">&#39;Loyal Customers&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;41&#39;</span>: <span style="color:#e6db74">&#39;Promising&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;51&#39;</span>: <span style="color:#e6db74">&#39;New Customers&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;[4-5][2-3]&#39;</span>: <span style="color:#e6db74">&#39;Potential Loyalists&#39;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>rfm_segmentation[<span style="color:#e6db74">&#39;RFM_Segment&#39;</span>] <span style="color:#f92672">=</span> rfm_segmentation[<span style="color:#e6db74">&#39;R&#39;</span>]<span style="color:#f92672">.</span>astype(str) <span style="color:#f92672">+</span> rfm_segmentation[<span style="color:#e6db74">&#39;FM&#39;</span>]<span style="color:#f92672">.</span>astype(str)
</span></span><span style="display:flex;"><span>rfm_segmentation[<span style="color:#e6db74">&#39;RFM_Segment&#39;</span>] <span style="color:#f92672">=</span> rfm_segmentation[<span style="color:#e6db74">&#39;RFM_Segment&#39;</span>]<span style="color:#f92672">.</span>replace(seg_map, regex<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>rfm_segmentation
</span></span></code></pre></div>  <div id="df-28264084-b591-4876-b44f-17417b9b7859">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>RFM_Score</th>
      <th>FM</th>
      <th>RFM_Segment</th>
    </tr>
    <tr>
      <th>customer_unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0000366f3b9a7992bf8c76cfdf3221e2</th>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>414</td>
      <td>2</td>
      <td>Potential Loyalists</td>
    </tr>
    <tr>
      <th>0000b849f77a49e4a4ce2b2a4ca5be3f</th>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>411</td>
      <td>1</td>
      <td>Promising</td>
    </tr>
    <tr>
      <th>0000f46a3911fa3c0805444483337064</th>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>112</td>
      <td>1</td>
      <td>Lost</td>
    </tr>
    <tr>
      <th>0000f6ccb0745a6a4b88665a16c9f078</th>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>211</td>
      <td>1</td>
      <td>Lost</td>
    </tr>
    <tr>
      <th>0004aac84e0df4da2b147fca70cf8255</th>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>214</td>
      <td>2</td>
      <td>Hibernating</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>fffbf87b7a1a6fa8b03f081c5f51a201</th>
      <td>245</td>
      <td>1</td>
      <td>167.32</td>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>354</td>
      <td>4</td>
      <td>Loyal Customers</td>
    </tr>
    <tr>
      <th>fffea47cd6d3cc0a88bd621562a9d061</th>
      <td>262</td>
      <td>1</td>
      <td>84.58</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>352</td>
      <td>3</td>
      <td>Need Attention</td>
    </tr>
    <tr>
      <th>ffff371b4d645b6ecea244b27531430a</th>
      <td>568</td>
      <td>1</td>
      <td>112.46</td>
      <td>1</td>
      <td>5</td>
      <td>3</td>
      <td>153</td>
      <td>4</td>
      <td>At Risk</td>
    </tr>
    <tr>
      <th>ffff5962728ec6157033ef9805bacc48</th>
      <td>119</td>
      <td>1</td>
      <td>133.69</td>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>453</td>
      <td>4</td>
      <td>Loyal Customers</td>
    </tr>
    <tr>
      <th>ffffd2657e2aad2907e67c3e9daecbeb</th>
      <td>484</td>
      <td>1</td>
      <td>71.56</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>152</td>
      <td>3</td>
      <td>At Risk</td>
    </tr>
  </tbody>
</table>
<p>91705 rows × 9 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-28264084-b591-4876-b44f-17417b9b7859')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-28264084-b591-4876-b44f-17417b9b7859 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-28264084-b591-4876-b44f-17417b9b7859');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h5 id="eksplorasi-rfm-segment">Eksplorasi RFM Segment</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RFMStats <span style="color:#f92672">=</span> rfm_segmentation[[<span style="color:#e6db74">&#34;RFM_Segment&#34;</span>, <span style="color:#e6db74">&#34;Recency&#34;</span>, <span style="color:#e6db74">&#34;Frequency&#34;</span>, <span style="color:#e6db74">&#34;Monetary&#34;</span>]]<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;RFM_Segment&#34;</span>)<span style="color:#f92672">.</span>agg([<span style="color:#e6db74">&#39;mean&#39;</span>,<span style="color:#e6db74">&#39;median&#39;</span>, <span style="color:#e6db74">&#39;min&#39;</span>, <span style="color:#e6db74">&#39;max&#39;</span>, <span style="color:#e6db74">&#39;count&#39;</span>])
</span></span><span style="display:flex;"><span>RFMStats[<span style="color:#e6db74">&#39;Ratio&#39;</span>]<span style="color:#f92672">=</span> (<span style="color:#ae81ff">100</span><span style="color:#f92672">*</span>RFMStats[<span style="color:#e6db74">&#39;Monetary&#39;</span>][<span style="color:#e6db74">&#34;count&#34;</span>]<span style="color:#f92672">/</span>RFMStats[<span style="color:#e6db74">&#39;Monetary&#39;</span>][<span style="color:#e6db74">&#34;count&#34;</span>]<span style="color:#f92672">.</span>sum())<span style="color:#f92672">.</span>round(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>RFMStats
</span></span></code></pre></div><pre><code>---------------------------------------------------------------------------

NameError                                 Traceback (most recent call last)

&lt;ipython-input-1-b71d698e9772&gt; in &lt;module&gt;
----&gt; 1 RFMStats = rfm_segmentation[[&quot;RFM_Segment&quot;, &quot;Recency&quot;, &quot;Frequency&quot;, &quot;Monetary&quot;]].groupby(&quot;RFM_Segment&quot;).agg(['mean','median', 'min', 'max', 'count'])
      2 RFMStats['Ratio']= (100*RFMStats['Monetary'][&quot;count&quot;]/RFMStats['Monetary'][&quot;count&quot;].sum()).round(2)
      3 RFMStats


NameError: name 'rfm_segmentation' is not defined
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">18</span>,<span style="color:#ae81ff">12</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>rc(<span style="color:#e6db74">&#39;font&#39;</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>)
</span></span><span style="display:flex;"><span>squarify<span style="color:#f92672">.</span>plot(sizes<span style="color:#f92672">=</span>RFMStats[<span style="color:#e6db74">&#34;Recency&#34;</span>][<span style="color:#e6db74">&#34;count&#34;</span>], label<span style="color:#f92672">=</span>RFMStats<span style="color:#f92672">.</span>index, 
</span></span><span style="display:flex;"><span>              color<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;red&#34;</span>,<span style="color:#e6db74">&#34;orange&#34;</span>,<span style="color:#e6db74">&#34;blue&#34;</span>, <span style="color:#e6db74">&#34;forestgreen&#34;</span>, <span style="color:#e6db74">&#34;yellow&#34;</span>, <span style="color:#e6db74">&#34;purple&#34;</span>, <span style="color:#e6db74">&#34;cornsilk&#34;</span>,<span style="color:#e6db74">&#34;royalblue&#34;</span>, <span style="color:#e6db74">&#34;pink&#34;</span>, <span style="color:#e6db74">&#34;brown&#34;</span>], alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">.55</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>suptitle(<span style="color:#e6db74">&#34;Recency and Frequency Grid&#34;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">25</span>);
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_278_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#plt.rc(&#39;font&#39;, size=20)</span>
</span></span><span style="display:flex;"><span>per<span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>barplot(x<span style="color:#f92672">=</span>RFMStats[<span style="color:#e6db74">&#39;Ratio&#39;</span>], y<span style="color:#f92672">=</span>RFMStats<span style="color:#f92672">.</span>index, data<span style="color:#f92672">=</span>RFMStats, palette<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bright&#34;</span>)
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>despine(bottom <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>, left <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, v <span style="color:#f92672">in</span> enumerate(RFMStats[<span style="color:#e6db74">&#39;Ratio&#39;</span>]):
</span></span><span style="display:flex;"><span>    per<span style="color:#f92672">.</span>text(v, i<span style="color:#f92672">+</span><span style="color:#ae81ff">.20</span>,<span style="color:#e6db74">&#34;  </span><span style="color:#e6db74">{:.2f}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(v)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;%&#34;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>, ha<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;left&#34;</span>)
</span></span><span style="display:flex;"><span>per<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Segments&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">25</span>)
</span></span><span style="display:flex;"><span>per<span style="color:#f92672">.</span>set(xticks<span style="color:#f92672">=</span>[])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Distribution of Segments&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">35</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_279_0.png" alt="png"></p>
<p>Seperti yang dapat kita amati dari barchart dan treemap di atas, sebagian pelanggan di Olist, yakni <strong>10.78%</strong> dari total pelanggan, adalah <strong>&ldquo;Lost Customers&rdquo;</strong> yang ditandai dengan skor Recency, Frequency, dan Monetary yang rendah. Pelanggan ini telah churn (churned), oleh karena itu mereka berhenti membeli di olist online dan telah memutuskan untuk menggunakan alternatif lain sebagai gantinya.</p>
<p><strong>&ldquo;Loyal Customers&rdquo;</strong>, sebanyak 13.91% dari total pelanggan. Pelanggan di segmen ini senang dengan produk dan tidak akan beralih ke alternatif lain. Mereka membeli setiap 139 hari dan menempatkan sekitar 1 pesanan dengan pengeluaran rata-rata 309. Penting untuk membuat pelanggan ini merasa dihargai.</p>
<p><strong>&ldquo;Potential Loyalist&rdquo;</strong> terdiri dari 25.29% pelanggan, ini adalah segmen terbesar, dimana mereka baru-baru ini melakukan transaksi dengan nilai cukup tinggi, tetapi dengan frekuensi rendah. Secara keseluruhan, mereka adalah pelanggan dengan pembelanjaan tinggi yang perlu merasa dihargai untuk terus berkontribusi lebih jauh. Cara terbaik untuk mencegah churn adalah dengan menawarkan keanggotaan, program loyalitas, atau merekomendasikan produk lain.</p>
<p>Pelanggan <strong>&ldquo;At Risk&rdquo; (22.42%)</strong> dan <strong>&ldquo;About to Sleep&rdquo; (8.3%)</strong>, adalah pelanggan lama yang sudah lama tidak melakukan pembelian dan berada di ambang churn, perusahaan perlu melakukan dorongan terakhir untuk memastikan retensi pelanggan dan membuat pesan yang paling relevan untuk melakukannya.</p>
<p>Pelanggan <strong>&ldquo;Hibernating&rdquo; (5.55%)</strong> , <strong>&ldquo;Need Attention&rdquo; (7.08%)</strong>, dan <strong>&ldquo;Promising&rdquo; (2.38%)</strong> ditandai dengan frekuensi rendah dan perlu mendapat perhatian khusus karena mereka lebih cenderung churn.</p>
<p>Terakhir, <strong>&ldquo;Champions&rdquo;</strong>, lebih dikenal sebagai pelanggan impian, terdiri dari 1,03% dari total pelanggan (sangat sedikit), memiliki skor tinggi di ketiga kategori RFM.</p>
<p>Berikut adalah penjelasan lebih lanjut dari tiap segmen</p>
<p><img src="https://global-uploads.webflow.com/5c90ba896f6f886d5e9d28d7/5de78a6b95253cead1deb90e_sambaSimpleRFMList.png" alt="rfm"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RFMStats <span style="color:#f92672">=</span> rfm_segmentation[[<span style="color:#e6db74">&#34;RFM_Segment&#34;</span>, <span style="color:#e6db74">&#34;Recency&#34;</span>, <span style="color:#e6db74">&#34;Frequency&#34;</span>, <span style="color:#e6db74">&#34;Monetary&#34;</span>]]<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#34;RFM_Segment&#34;</span>)<span style="color:#f92672">.</span>agg([<span style="color:#e6db74">&#39;mean&#39;</span>,<span style="color:#e6db74">&#39;median&#39;</span>, <span style="color:#e6db74">&#39;min&#39;</span>, <span style="color:#e6db74">&#39;max&#39;</span>, <span style="color:#e6db74">&#39;count&#39;</span>])
</span></span><span style="display:flex;"><span>RFMStats[<span style="color:#e6db74">&#39;Ratio&#39;</span>]<span style="color:#f92672">=</span> (<span style="color:#ae81ff">100</span><span style="color:#f92672">*</span>RFMStats[<span style="color:#e6db74">&#39;Monetary&#39;</span>][<span style="color:#e6db74">&#34;count&#34;</span>]<span style="color:#f92672">/</span>RFMStats[<span style="color:#e6db74">&#39;Monetary&#39;</span>][<span style="color:#e6db74">&#34;count&#34;</span>]<span style="color:#f92672">.</span>sum())<span style="color:#f92672">.</span>round(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>RFMStats
</span></span></code></pre></div>  <div id="df-c9ab91db-92d9-485a-b8b1-10c9956bcd2b">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead tr th {
    text-align: left;
}

.dataframe thead tr:last-of-type th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="5" halign="left">Recency</th>
      <th colspan="5" halign="left">Frequency</th>
      <th colspan="5" halign="left">Monetary</th>
      <th>Ratio</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>median</th>
      <th>min</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>median</th>
      <th>min</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>median</th>
      <th>min</th>
      <th>max</th>
      <th>count</th>
      <th></th>
    </tr>
    <tr>
      <th>RFM_Segment</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>About to Sleep</th>
      <td>219.615850</td>
      <td>219.0</td>
      <td>177</td>
      <td>268</td>
      <td>7609</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>7609</td>
      <td>76.246473</td>
      <td>64.09</td>
      <td>14.08</td>
      <td>229.50</td>
      <td>7609</td>
      <td>8.30</td>
    </tr>
    <tr>
      <th>At Risk</th>
      <td>390.498882</td>
      <td>375.0</td>
      <td>269</td>
      <td>695</td>
      <td>20564</td>
      <td>1.037639</td>
      <td>1.0</td>
      <td>1</td>
      <td>6</td>
      <td>20564</td>
      <td>235.996512</td>
      <td>159.03</td>
      <td>12.89</td>
      <td>1605.14</td>
      <td>20564</td>
      <td>22.42</td>
    </tr>
    <tr>
      <th>Can't Lose</th>
      <td>473.530321</td>
      <td>467.0</td>
      <td>382</td>
      <td>694</td>
      <td>841</td>
      <td>1.279429</td>
      <td>1.0</td>
      <td>1</td>
      <td>4</td>
      <td>841</td>
      <td>488.409536</td>
      <td>377.24</td>
      <td>229.83</td>
      <td>1546.88</td>
      <td>841</td>
      <td>0.92</td>
    </tr>
    <tr>
      <th>Champions</th>
      <td>45.847134</td>
      <td>42.0</td>
      <td>1</td>
      <td>91</td>
      <td>942</td>
      <td>1.433121</td>
      <td>1.0</td>
      <td>1</td>
      <td>15</td>
      <td>942</td>
      <td>512.730828</td>
      <td>404.52</td>
      <td>230.13</td>
      <td>1590.76</td>
      <td>942</td>
      <td>1.03</td>
    </tr>
    <tr>
      <th>Hibernating</th>
      <td>316.477987</td>
      <td>313.0</td>
      <td>269</td>
      <td>381</td>
      <td>5088</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>5088</td>
      <td>87.589037</td>
      <td>76.26</td>
      <td>10.07</td>
      <td>228.98</td>
      <td>5088</td>
      <td>5.55</td>
    </tr>
    <tr>
      <th>Lost</th>
      <td>437.694439</td>
      <td>440.0</td>
      <td>269</td>
      <td>695</td>
      <td>9890</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>9890</td>
      <td>70.905179</td>
      <td>59.74</td>
      <td>11.63</td>
      <td>229.81</td>
      <td>9890</td>
      <td>10.78</td>
    </tr>
    <tr>
      <th>Loyal Customers</th>
      <td>139.911820</td>
      <td>142.0</td>
      <td>1</td>
      <td>268</td>
      <td>12758</td>
      <td>1.111146</td>
      <td>1.0</td>
      <td>1</td>
      <td>7</td>
      <td>12758</td>
      <td>309.045916</td>
      <td>215.79</td>
      <td>88.80</td>
      <td>1602.25</td>
      <td>12758</td>
      <td>13.91</td>
    </tr>
    <tr>
      <th>Need Attention</th>
      <td>220.445282</td>
      <td>220.0</td>
      <td>177</td>
      <td>268</td>
      <td>6497</td>
      <td>1.004002</td>
      <td>1.0</td>
      <td>1</td>
      <td>3</td>
      <td>6497</td>
      <td>180.722992</td>
      <td>119.93</td>
      <td>13.78</td>
      <td>1599.88</td>
      <td>6497</td>
      <td>7.08</td>
    </tr>
    <tr>
      <th>New Customers</th>
      <td>44.127630</td>
      <td>41.0</td>
      <td>0</td>
      <td>91</td>
      <td>2139</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>2139</td>
      <td>49.978593</td>
      <td>47.53</td>
      <td>9.59</td>
      <td>88.76</td>
      <td>2139</td>
      <td>2.33</td>
    </tr>
    <tr>
      <th>Potential Loyalists</th>
      <td>89.304355</td>
      <td>91.0</td>
      <td>0</td>
      <td>176</td>
      <td>23190</td>
      <td>1.003062</td>
      <td>1.0</td>
      <td>1</td>
      <td>3</td>
      <td>23190</td>
      <td>145.631235</td>
      <td>100.45</td>
      <td>10.89</td>
      <td>1600.51</td>
      <td>23190</td>
      <td>25.29</td>
    </tr>
    <tr>
      <th>Promising</th>
      <td>135.686328</td>
      <td>135.0</td>
      <td>92</td>
      <td>176</td>
      <td>2187</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>2187</td>
      <td>49.879813</td>
      <td>47.52</td>
      <td>13.29</td>
      <td>88.78</td>
      <td>2187</td>
      <td>2.38</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c9ab91db-92d9-485a-b8b1-10c9956bcd2b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-c9ab91db-92d9-485a-b8b1-10c9956bcd2b button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-c9ab91db-92d9-485a-b8b1-10c9956bcd2b');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<p>Berdasarkan Descriptive Statistic, Ada 3 segmen yang akan saya jelaskan lebih lanjut, yakni Champions, About to Sleep, dan Can&rsquo;t Loose Them.</p>
<ul>
<li><strong>Champions</strong> <br>
Ada 942 orang, atau 1.03% dari total customer, jumlah yang sangat sedikit dibandingkan dengan segmen lain. Mereka tidak berbelanja rata-rata 46 hari, dengan frekuensi transaksi a rata-rata 1,43 kali. Mereka menghabiskan uang rata-rata 512.73 unit. <br><strong>Keputusan Tindakan Yang Bisa Diambil :</strong> <br>
Pelanggan terbaik adalah yang aktif, yang paling sering dan yang paling banyak memberikan kontribusi kepada perusahaan. Olist dapat memberi penghargaan kepada pelanggan ini dengan berbagai peluang dan kampanye. Misalnya, diskon khusus yang dibuat untuk ulang tahun mereka. Pelanggan di segmen champion ini sangat berharga.</li>
<li><strong>About to Sleep</strong> <br>
Ada 7609 orang di segmen ini. Mereka tidak berbelanja rata-rata 220 hari, dengan frekuensi rata-rata transaksi sebanyak 1 kali. Mereka menghabiskan rata-rata 76.24 unit uang.
<br><strong>Keputusan Tindakan Yang Bisa Diambil :</strong> <br> Olist perlu tetap berhubungan dengan orang-orang di segmen ini dan kita dapat merekomendasikan produk / pembaruan populer dengan diskon, berhubungan kembali dengan mereka dan menjadikan mereka pelanggan kita.</li>
<li><strong>Can&rsquo;t Loose</strong> <br>
Ada 841 orang di segmen ini. Mereka tidak berbelanja rata-rata 474 hari, dengan frekuensi rata-rata 1 kali. Mereka mengeluarkan rata-rata 488 unit uang.
<br><strong>Keputusan Tindakan Yang Bisa Diambil :</strong> <br> Ini adalah salah satu segmen yang harus diberikan kepentingan. Kita tidak ingin segmen ini menjadi Lost. Melihat fakta buruk bahwa pembelian terakhir mereka dilakukan 474 hari yang lalu. Namun, jumlah total pembelian yang dilakukan adalah angka yang cukup tinggi. Olist dapat memenangkan kembali orang-orang di segmen ini dengan menawarkan pembaruan, produk baru, atau dengan memberikan promosi khusus dan poin tunai kecil kepada kelas ini.</li>
</ul>
<h3 id="k-means-clustering">K-Means Clustering</h3>
<p>K-means adalah algoritma unsupervised learning, yang digunakan untuk pengelompokan data. Dalam algoritma k-means, jumlah cluster K telah ditentukan sebelumnya dan algoritma secara iteratif memberikan setiap titik data ke salah satu cluster K berdasarkan kesamaan fitur.</p>
<h4 id="implementasi-k-means-clustering">Implementasi K Means Clustering</h4>
<h4 id="langkah-">Langkah :</h4>
<ul>
<li>Pre-Processing Data</li>
<li>Tentukan Jumlah Cluster</li>
<li>Menjalankan K Berarti Pengelompokan pada Data yang Diproses sebelumnya</li>
<li>Analisis cluster</li>
</ul>
<h4 id="k-means-memberikan-hasil-terbaik-dalam-kondisi-berikut">K-means memberikan hasil terbaik dalam kondisi berikut:</h4>
<ul>
<li>Distribusi data tidak miring (skew).</li>
<li>Data distandarisasi (yaitu rata-rata 0 dan standar deviasi 1).</li>
</ul>
<p>Oleh karena itu, kita akan memeriksa distribusi data untuk setiap fitur yang baru dihitung (RFM).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RFM_df<span style="color:#f92672">.</span>head()
</span></span></code></pre></div>  <div id="df-39c0c976-e10d-4e0b-bf04-d5816b4e353a">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>RFM_Score</th>
      <th>FM</th>
      <th>RFM_Segment</th>
    </tr>
    <tr>
      <th>customer_unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0000366f3b9a7992bf8c76cfdf3221e2</th>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>414</td>
      <td>2</td>
      <td>Potential Loyalists</td>
    </tr>
    <tr>
      <th>0000b849f77a49e4a4ce2b2a4ca5be3f</th>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>411</td>
      <td>1</td>
      <td>Promising</td>
    </tr>
    <tr>
      <th>0000f46a3911fa3c0805444483337064</th>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>112</td>
      <td>1</td>
      <td>Lost</td>
    </tr>
    <tr>
      <th>0000f6ccb0745a6a4b88665a16c9f078</th>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>211</td>
      <td>1</td>
      <td>Lost</td>
    </tr>
    <tr>
      <th>0004aac84e0df4da2b147fca70cf8255</th>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>214</td>
      <td>2</td>
      <td>Hibernating</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-39c0c976-e10d-4e0b-bf04-d5816b4e353a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-39c0c976-e10d-4e0b-bf04-d5816b4e353a button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-39c0c976-e10d-4e0b-bf04-d5816b4e353a');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># RFM Table</span>
</span></span><span style="display:flex;"><span>rfm_kmeans<span style="color:#f92672">=</span> rfm_segmentation[[<span style="color:#e6db74">&#39;Recency&#39;</span>,<span style="color:#e6db74">&#39;Frequency&#39;</span>,<span style="color:#e6db74">&#39;Monetary&#39;</span>]]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Plot RFM Distributions</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">12</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>); sns<span style="color:#f92672">.</span>histplot(rfm_kmeans[<span style="color:#e6db74">&#39;Recency&#39;</span>], kde<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,  linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)<span style="color:#75715e"># Plot distribution of R</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>); sns<span style="color:#f92672">.</span>histplot(rfm_kmeans[<span style="color:#e6db74">&#39;Frequency&#39;</span>], kde<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,  linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)<span style="color:#75715e"># Plot distribution of F</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>); sns<span style="color:#f92672">.</span>histplot(rfm_kmeans[<span style="color:#e6db74">&#39;Monetary&#39;</span>], kde<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,  linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)<span style="color:#75715e"># Plot distribution of M</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()<span style="color:#75715e"># Show the plot</span>
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_289_0.png" alt="png"></p>
<p>Seperti yang kita amati pada gambar di atas, ketiga variabel, Recency, Frequency, dan Monetary miring ke kanan (right skewed). Oleh karena itu, perlu dilakukan normalisasi data. Tujuan normalisasi adalah untuk mengubah nilai kolom numerik dalam kumpulan data untuk menggunakan skala standar, tanpa mendistorsi perbedaan dalam rentang nilai atau kehilangan informasi.</p>
<h5 id="apply-square-root-transformation">Apply Square Root Transformation</h5>
<p>Seperti yang kita amati di atas bahwa distribusi data tidak simetris, maka perlu diterapkan <em>square root transfromation</em> untuk menormalkan skewness.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rfm_sqrt <span style="color:#f92672">=</span> rfm_kmeans[[<span style="color:#e6db74">&#39;Recency&#39;</span>, <span style="color:#e6db74">&#39;Frequency&#39;</span>, <span style="color:#e6db74">&#39;Monetary&#39;</span>]]<span style="color:#f92672">.</span>apply(np<span style="color:#f92672">.</span>sqrt, axis <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>round(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>f,ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>); sns<span style="color:#f92672">.</span>distplot(rfm_sqrt<span style="color:#f92672">.</span>Recency, label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Recency&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>); sns<span style="color:#f92672">.</span>distplot(rfm_sqrt<span style="color:#f92672">.</span>Frequency, label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Frequency&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>); sns<span style="color:#f92672">.</span>distplot(rfm_sqrt<span style="color:#f92672">.</span>Monetary, label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Monetary&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>style<span style="color:#f92672">.</span>use(<span style="color:#e6db74">&#39;fivethirtyeight&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_292_0.png" alt="png"></p>
<h5 id="preprocessing-the-data">Preprocessing the Data</h5>
<p>Pertama-tama kita perlu menstandarisasi semua parameter</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> StandardScaler
</span></span><span style="display:flex;"><span>standard_scaler <span style="color:#f92672">=</span> StandardScaler()
</span></span><span style="display:flex;"><span>rfm_norm <span style="color:#f92672">=</span> standard_scaler<span style="color:#f92672">.</span>fit_transform(rfm_sqrt)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rfm_norm <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(rfm_norm)
</span></span><span style="display:flex;"><span>rfm_norm<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Recency&#39;</span>, <span style="color:#e6db74">&#39;Frequency&#39;</span>, <span style="color:#e6db74">&#39;Monetary&#39;</span>]
</span></span><span style="display:flex;"><span>rfm_norm<span style="color:#f92672">.</span>head()
</span></span></code></pre></div>  <div id="df-567fe7b0-f95f-4e70-b795-80dac2921f84">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.720234</td>
      <td>-0.16625</td>
      <td>-0.006328</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.694130</td>
      <td>-0.16625</td>
      <td>-1.160017</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.619324</td>
      <td>-0.16625</td>
      <td>-0.458813</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.646066</td>
      <td>-0.16625</td>
      <td>-0.920426</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.471113</td>
      <td>-0.16625</td>
      <td>0.358829</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-567fe7b0-f95f-4e70-b795-80dac2921f84')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-567fe7b0-f95f-4e70-b795-80dac2921f84 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-567fe7b0-f95f-4e70-b795-80dac2921f84');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h5 id="determine-optimal-number-of-clusters">Determine Optimal Number of Clusters</h5>
<p>Langkah selanjutnya, kita akan menggunakan <em>elbow method</em> untuk menentukan nilai k yang optimal. Ketika kita memplot WCSS ( Within-Cluster Sum of Square ), plot tersebut dapat dilihat sebagai siku-siku. Saat menganalisis plot, kita akan melihat bagaimana pada suatu titik grafik dengan cepat kehilangan bentuk sikunya. Pada titik itulah kita dapat menentukan nilai-k.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>wcss <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>): <span style="color:#75715e">#15 cluster</span>
</span></span><span style="display:flex;"><span>    kmeans <span style="color:#f92672">=</span> KMeans(n_clusters <span style="color:#f92672">=</span> i, init<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;k-means++&#39;</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>) 
</span></span><span style="display:flex;"><span>    kmeans<span style="color:#f92672">.</span>fit(rfm_norm)
</span></span><span style="display:flex;"><span>    wcss<span style="color:#f92672">.</span>append(kmeans<span style="color:#f92672">.</span>inertia_)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>),wcss,  marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;D&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Elbow Method&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Number of clusters&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;wcss&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_297_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> kneed <span style="color:#f92672">import</span> KneeLocator
</span></span><span style="display:flex;"><span>kl <span style="color:#f92672">=</span> KneeLocator(range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>), wcss, curve<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;convex&#34;</span>, direction<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;decreasing&#34;</span>)
</span></span><span style="display:flex;"><span>kl<span style="color:#f92672">.</span>elbow
</span></span></code></pre></div><pre><code>4
</code></pre>
<p>Kita akan menggunakan Nilai K optimal dari hasil kneed, yakni adalah 4.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># K-means clustering</span>
</span></span><span style="display:flex;"><span>kc <span style="color:#f92672">=</span> KMeans(n_clusters<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>,random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>kc<span style="color:#f92672">.</span>fit(rfm_norm)
</span></span></code></pre></div><pre><code>KMeans(n_clusters=4, random_state=0)
</code></pre>
<p>Fungsi dibawah ini akan digunakan untuk membuat plot 3d yang merepresentasikan cluster.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plots_model</span>():    
</span></span><span style="display:flex;"><span>    fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">12</span>))
</span></span><span style="display:flex;"><span>    ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>add_subplot(<span style="color:#ae81ff">111</span>, projection<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;3d&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> rfm_norm<span style="color:#f92672">.</span>groups<span style="color:#f92672">.</span>unique():        
</span></span><span style="display:flex;"><span>        xs <span style="color:#f92672">=</span> rfm_norm[rfm_norm<span style="color:#f92672">.</span>groups <span style="color:#f92672">==</span> x][<span style="color:#e6db74">&#39;Recency&#39;</span>]
</span></span><span style="display:flex;"><span>        zs <span style="color:#f92672">=</span> rfm_norm[rfm_norm<span style="color:#f92672">.</span>groups <span style="color:#f92672">==</span> x][<span style="color:#e6db74">&#39;Frequency&#39;</span>]
</span></span><span style="display:flex;"><span>        ys <span style="color:#f92672">=</span> rfm_norm[rfm_norm<span style="color:#f92672">.</span>groups <span style="color:#f92672">==</span> x][<span style="color:#e6db74">&#39;Monetary&#39;</span>]
</span></span><span style="display:flex;"><span>        ax<span style="color:#f92672">.</span>scatter(xs, ys, zs, s<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.6</span>, edgecolors<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;w&#39;</span>, label <span style="color:#f92672">=</span> x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Recency&#39;</span>)
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>set_zlabel(<span style="color:#e6db74">&#39;Frequency&#39;</span>)
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Monetary&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Visualization of created groups&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>model_1 <span style="color:#f92672">=</span> KMeans(n_clusters<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>, init<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;k-means++&#39;</span>, max_iter<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>)
</span></span><span style="display:flex;"><span>groups <span style="color:#f92672">=</span> model_1<span style="color:#f92672">.</span>fit_predict(rfm_norm)
</span></span><span style="display:flex;"><span>rfm_norm[<span style="color:#e6db74">&#39;groups&#39;</span>] <span style="color:#f92672">=</span> groups
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plots_model()
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_304_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rfm_segmentation[<span style="color:#e6db74">&#39;K_Cluster&#39;</span>] <span style="color:#f92672">=</span> kc<span style="color:#f92672">.</span>labels_
</span></span><span style="display:flex;"><span>rfm_segmentation
</span></span></code></pre></div>  <div id="df-76d55358-f965-42ca-9cbc-20eaa974fb76">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>RFM_Score</th>
      <th>FM</th>
      <th>RFM_Segment</th>
      <th>K_Cluster</th>
    </tr>
    <tr>
      <th>customer_unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0000366f3b9a7992bf8c76cfdf3221e2</th>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>414</td>
      <td>2</td>
      <td>Potential Loyalists</td>
      <td>2</td>
    </tr>
    <tr>
      <th>0000b849f77a49e4a4ce2b2a4ca5be3f</th>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>411</td>
      <td>1</td>
      <td>Promising</td>
      <td>2</td>
    </tr>
    <tr>
      <th>0000f46a3911fa3c0805444483337064</th>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>112</td>
      <td>1</td>
      <td>Lost</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0000f6ccb0745a6a4b88665a16c9f078</th>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>211</td>
      <td>1</td>
      <td>Lost</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0004aac84e0df4da2b147fca70cf8255</th>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>214</td>
      <td>2</td>
      <td>Hibernating</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>fffbf87b7a1a6fa8b03f081c5f51a201</th>
      <td>245</td>
      <td>1</td>
      <td>167.32</td>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>354</td>
      <td>4</td>
      <td>Loyal Customers</td>
      <td>0</td>
    </tr>
    <tr>
      <th>fffea47cd6d3cc0a88bd621562a9d061</th>
      <td>262</td>
      <td>1</td>
      <td>84.58</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>352</td>
      <td>3</td>
      <td>Need Attention</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ffff371b4d645b6ecea244b27531430a</th>
      <td>568</td>
      <td>1</td>
      <td>112.46</td>
      <td>1</td>
      <td>5</td>
      <td>3</td>
      <td>153</td>
      <td>4</td>
      <td>At Risk</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ffff5962728ec6157033ef9805bacc48</th>
      <td>119</td>
      <td>1</td>
      <td>133.69</td>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>453</td>
      <td>4</td>
      <td>Loyal Customers</td>
      <td>2</td>
    </tr>
    <tr>
      <th>ffffd2657e2aad2907e67c3e9daecbeb</th>
      <td>484</td>
      <td>1</td>
      <td>71.56</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>152</td>
      <td>3</td>
      <td>At Risk</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>91705 rows × 10 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-76d55358-f965-42ca-9cbc-20eaa974fb76')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-76d55358-f965-42ca-9cbc-20eaa974fb76 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-76d55358-f965-42ca-9cbc-20eaa974fb76');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Function to visualize clusters</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rfm_clusters_stat</span>(df):
</span></span><span style="display:flex;"><span>    df_new <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;K_Cluster&#39;</span>])<span style="color:#f92672">.</span>agg({
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Recency&#39;</span>  : [<span style="color:#e6db74">&#39;mean&#39;</span>,<span style="color:#e6db74">&#39;median&#39;</span>, <span style="color:#e6db74">&#39;min&#39;</span>, <span style="color:#e6db74">&#39;max&#39;</span>],
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Frequency&#39;</span>: [<span style="color:#e6db74">&#39;mean&#39;</span>,<span style="color:#e6db74">&#39;median&#39;</span>, <span style="color:#e6db74">&#39;min&#39;</span>, <span style="color:#e6db74">&#39;max&#39;</span>],
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Monetary&#39;</span> : [<span style="color:#e6db74">&#39;mean&#39;</span>,<span style="color:#e6db74">&#39;median&#39;</span>, <span style="color:#e6db74">&#39;min&#39;</span>, <span style="color:#e6db74">&#39;max&#39;</span>, <span style="color:#e6db74">&#39;count&#39;</span>]
</span></span><span style="display:flex;"><span>        })<span style="color:#f92672">.</span>round(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> df_new
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rfm_clusters_stat(rfm_segmentation)<span style="color:#f92672">.</span>style<span style="color:#f92672">.</span>background_gradient(cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;YlGnBu&#39;</span>)
</span></span></code></pre></div><style type="text/css">
#T_89c04_row0_col0, #T_89c04_row0_col1, #T_89c04_row0_col2, #T_89c04_row0_col3, #T_89c04_row0_col12, #T_89c04_row1_col4, #T_89c04_row1_col5, #T_89c04_row1_col6, #T_89c04_row1_col7, #T_89c04_row1_col11, #T_89c04_row3_col3, #T_89c04_row3_col8, #T_89c04_row3_col9, #T_89c04_row3_col10, #T_89c04_row3_col11 {
  background-color: #081d58;
  color: #f1f1f1;
}
#T_89c04_row0_col4, #T_89c04_row0_col5, #T_89c04_row0_col6, #T_89c04_row0_col7, #T_89c04_row0_col8, #T_89c04_row0_col9, #T_89c04_row0_col10, #T_89c04_row0_col11, #T_89c04_row1_col12, #T_89c04_row2_col0, #T_89c04_row2_col1, #T_89c04_row2_col2, #T_89c04_row2_col3, #T_89c04_row2_col4, #T_89c04_row2_col5, #T_89c04_row2_col6, #T_89c04_row2_col7, #T_89c04_row2_col10, #T_89c04_row3_col2, #T_89c04_row3_col4, #T_89c04_row3_col5, #T_89c04_row3_col6, #T_89c04_row3_col7 {
  background-color: #ffffd9;
  color: #000000;
}
#T_89c04_row1_col0 {
  background-color: #46b8c3;
  color: #f1f1f1;
}
#T_89c04_row1_col1 {
  background-color: #61c2bf;
  color: #000000;
}
#T_89c04_row1_col2 {
  background-color: #feffd8;
  color: #000000;
}
#T_89c04_row1_col3 {
  background-color: #0a1e5c;
  color: #f1f1f1;
}
#T_89c04_row1_col8, #T_89c04_row3_col1 {
  background-color: #37acc3;
  color: #f1f1f1;
}
#T_89c04_row1_col9 {
  background-color: #65c3bf;
  color: #000000;
}
#T_89c04_row1_col10 {
  background-color: #eff9b6;
  color: #000000;
}
#T_89c04_row2_col8 {
  background-color: #fdfed5;
  color: #000000;
}
#T_89c04_row2_col9 {
  background-color: #fdfed4;
  color: #000000;
}
#T_89c04_row2_col11 {
  background-color: #f4fbc1;
  color: #000000;
}
#T_89c04_row2_col12 {
  background-color: #2258a5;
  color: #f1f1f1;
}
#T_89c04_row3_col0 {
  background-color: #2b9fc2;
  color: #f1f1f1;
}
#T_89c04_row3_col12 {
  background-color: #cfecb3;
  color: #000000;
}
</style>
<table id="T_89c04_" class="dataframe">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th class="col_heading level0 col0" colspan="4">Recency</th>
      <th class="col_heading level0 col4" colspan="4">Frequency</th>
      <th class="col_heading level0 col8" colspan="5">Monetary</th>
    </tr>
    <tr>
      <th class="blank level1" >&nbsp;</th>
      <th class="col_heading level1 col0" >mean</th>
      <th class="col_heading level1 col1" >median</th>
      <th class="col_heading level1 col2" >min</th>
      <th class="col_heading level1 col3" >max</th>
      <th class="col_heading level1 col4" >mean</th>
      <th class="col_heading level1 col5" >median</th>
      <th class="col_heading level1 col6" >min</th>
      <th class="col_heading level1 col7" >max</th>
      <th class="col_heading level1 col8" >mean</th>
      <th class="col_heading level1 col9" >median</th>
      <th class="col_heading level1 col10" >min</th>
      <th class="col_heading level1 col11" >max</th>
      <th class="col_heading level1 col12" >count</th>
    </tr>
    <tr>
      <th class="index_name level0" >K_Cluster</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
      <th class="blank col5" >&nbsp;</th>
      <th class="blank col6" >&nbsp;</th>
      <th class="blank col7" >&nbsp;</th>
      <th class="blank col8" >&nbsp;</th>
      <th class="blank col9" >&nbsp;</th>
      <th class="blank col10" >&nbsp;</th>
      <th class="blank col11" >&nbsp;</th>
      <th class="blank col12" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_89c04_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_89c04_row0_col0" class="data row0 col0" >348.000000</td>
      <td id="T_89c04_row0_col1" class="data row0 col1" >328.000000</td>
      <td id="T_89c04_row0_col2" class="data row0 col2" >188</td>
      <td id="T_89c04_row0_col3" class="data row0 col3" >695</td>
      <td id="T_89c04_row0_col4" class="data row0 col4" >1.000000</td>
      <td id="T_89c04_row0_col5" class="data row0 col5" >1.000000</td>
      <td id="T_89c04_row0_col6" class="data row0 col6" >1</td>
      <td id="T_89c04_row0_col7" class="data row0 col7" >1</td>
      <td id="T_89c04_row0_col8" class="data row0 col8" >108.000000</td>
      <td id="T_89c04_row0_col9" class="data row0 col9" >91.000000</td>
      <td id="T_89c04_row0_col10" class="data row0 col10" >10.000000</td>
      <td id="T_89c04_row0_col11" class="data row0 col11" >364.000000</td>
      <td id="T_89c04_row0_col12" class="data row0 col12" >43342</td>
    </tr>
    <tr>
      <th id="T_89c04_level0_row1" class="row_heading level0 row1" >1</th>
      <td id="T_89c04_row1_col0" class="data row1 col0" >220.000000</td>
      <td id="T_89c04_row1_col1" class="data row1 col1" >199.000000</td>
      <td id="T_89c04_row1_col2" class="data row1 col2" >1</td>
      <td id="T_89c04_row1_col3" class="data row1 col3" >691</td>
      <td id="T_89c04_row1_col4" class="data row1 col4" >2.000000</td>
      <td id="T_89c04_row1_col5" class="data row1 col5" >2.000000</td>
      <td id="T_89c04_row1_col6" class="data row1 col6" >2</td>
      <td id="T_89c04_row1_col7" class="data row1 col7" >15</td>
      <td id="T_89c04_row1_col8" class="data row1 col8" >354.000000</td>
      <td id="T_89c04_row1_col9" class="data row1 col9" >254.000000</td>
      <td id="T_89c04_row1_col10" class="data row1 col10" >37.000000</td>
      <td id="T_89c04_row1_col11" class="data row1 col11" >1601.000000</td>
      <td id="T_89c04_row1_col12" class="data row1 col12" >2660</td>
    </tr>
    <tr>
      <th id="T_89c04_level0_row2" class="row_heading level0 row2" >2</th>
      <td id="T_89c04_row2_col0" class="data row2 col0" >96.000000</td>
      <td id="T_89c04_row2_col1" class="data row2 col1" >100.000000</td>
      <td id="T_89c04_row2_col2" class="data row2 col2" >0</td>
      <td id="T_89c04_row2_col3" class="data row2 col3" >195</td>
      <td id="T_89c04_row2_col4" class="data row2 col4" >1.000000</td>
      <td id="T_89c04_row2_col5" class="data row2 col5" >1.000000</td>
      <td id="T_89c04_row2_col6" class="data row2 col6" >1</td>
      <td id="T_89c04_row2_col7" class="data row2 col7" >1</td>
      <td id="T_89c04_row2_col8" class="data row2 col8" >114.000000</td>
      <td id="T_89c04_row2_col9" class="data row2 col9" >98.000000</td>
      <td id="T_89c04_row2_col10" class="data row2 col10" >10.000000</td>
      <td id="T_89c04_row2_col11" class="data row2 col11" >459.000000</td>
      <td id="T_89c04_row2_col12" class="data row2 col12" >33945</td>
    </tr>
    <tr>
      <th id="T_89c04_level0_row3" class="row_heading level0 row3" >3</th>
      <td id="T_89c04_row3_col0" class="data row3 col0" >241.000000</td>
      <td id="T_89c04_row3_col1" class="data row3 col1" >222.000000</td>
      <td id="T_89c04_row3_col2" class="data row3 col2" >0</td>
      <td id="T_89c04_row3_col3" class="data row3 col3" >694</td>
      <td id="T_89c04_row3_col4" class="data row3 col4" >1.000000</td>
      <td id="T_89c04_row3_col5" class="data row3 col5" >1.000000</td>
      <td id="T_89c04_row3_col6" class="data row3 col6" >1</td>
      <td id="T_89c04_row3_col7" class="data row3 col7" >1</td>
      <td id="T_89c04_row3_col8" class="data row3 col8" >570.000000</td>
      <td id="T_89c04_row3_col9" class="data row3 col9" >472.000000</td>
      <td id="T_89c04_row3_col10" class="data row3 col10" >249.000000</td>
      <td id="T_89c04_row3_col11" class="data row3 col11" >1605.000000</td>
      <td id="T_89c04_row3_col12" class="data row3 col12" >11758</td>
    </tr>
  </tbody>
</table>
<h5 id="cluster-description">Cluster Description</h5>
<h6 id="cluster-0">Cluster 0</h6>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rfm_segmentation[rfm_segmentation<span style="color:#f92672">.</span>K_Cluster <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;RFM_Segment&#39;</span>]<span style="color:#f92672">.</span>value_counts()
</span></span></code></pre></div><pre><code>At Risk            15557
Lost                9890
About to Sleep      6307
Hibernating         5088
Need Attention      4388
Loyal Customers     1863
Can't Lose           249
Name: RFM_Segment, dtype: int64
</code></pre>
<p>Cluster 0 merepresentasikan customer yang tidak aktif (paling buruk dan beresiko). Cluster ini memiliki banyak customer yang Lost (9890 orang), dan At Risk (15557 orang). Dilihat dari summary statistic, Cluster 0 memiliki nilai Recency paling tinggi (348 hari), dan Rata&rdquo; Nilai Monetary paling rendah (108 unit), dimana ini merupakan kondisi paling buruk dari semua cluster. Sayangnya, jumlah cluster 0 ini adalah yang paling banyak diantara semua cluster, yakni 43342 orang.</p>
<h6 id="cluster-1">Cluster 1</h6>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rfm_segmentation[rfm_segmentation<span style="color:#f92672">.</span>K_Cluster <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>][<span style="color:#e6db74">&#39;RFM_Segment&#39;</span>]<span style="color:#f92672">.</span>value_counts()
</span></span></code></pre></div><pre><code>Loyal Customers        1290
At Risk                 720
Champions               336
Can't Lose              219
Potential Loyalists      70
Need Attention           25
Name: RFM_Segment, dtype: int64
</code></pre>
<p>Cluster 1 merepresentasikan customer yang paling aktif, dan pelanggan terbaik. Cluster ini didominasi oleh Loyal Customer (1290) orang. Cluster ini menjadi paling aktif, karena memiliki rata-rata frekuensi transaksi tertinggi dari semua cluster, serta memiliki rata-rata Recency dan Monetary yang bagus. Sayangnya, Cluster 1 adalah cluster yang paling sedikit orangnya, yakni hanya 2660 orang.</p>
<h6 id="cluster-2">Cluster 2</h6>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rfm_segmentation[rfm_segmentation<span style="color:#f92672">.</span>K_Cluster <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>][<span style="color:#e6db74">&#39;RFM_Segment&#39;</span>]<span style="color:#f92672">.</span>value_counts()
</span></span></code></pre></div><pre><code>Potential Loyalists    21365
Loyal Customers         5697
Promising               2187
New Customers           2139
About to Sleep          1302
Need Attention           975
Champions                280
Name: RFM_Segment, dtype: int64
</code></pre>
<p>Cluster 2 dapat dikatakan sebagai cluster baby. Ini dikarenakan customer ini didominasi oleh customer baru, yang berpotensial untuk menjadi pelanggan tetap atau malah pelanggan tidak aktif (churn). Cluster 2 memiliki rata-rata recency paling sedikit, artinya mereka adalah yang paling baru melakukan aktivitas transaksi akhir-akhir ini. Dilihat dari summary statistic, cluster ini memiliki nilai monetary yang tidak terlalu tinggi, dimana hal ini masuk akal karena customer baru cenderung membeli barang yang bernilai kecil di awal waktu. Cluster 2 adalah pelanggan yang perlu di threat dengan baik, seperti memberi promo, diskon, atau bonus agar mereka yakin dan betah untuk bertransaksi di Olist, sehingga diharapkan bisa menjadi customer yang loyal bahkan champion.</p>
<h6 id="cluster-3">Cluster 3</h6>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rfm_segmentation[rfm_segmentation<span style="color:#f92672">.</span>K_Cluster <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>][<span style="color:#e6db74">&#39;RFM_Segment&#39;</span>]<span style="color:#f92672">.</span>value_counts()
</span></span></code></pre></div><pre><code>At Risk                4287
Loyal Customers        3908
Potential Loyalists    1755
Need Attention         1109
Can't Lose              373
Champions               326
Name: RFM_Segment, dtype: int64
</code></pre>
<p>Cluster 3 adalah cluster yang perlu ditreatment dengan baik pula. Cluster ini berisi pelanggan lama, dengan nilai transaksi (monetary) paling besar. Akan tetapi pelanggan ini tidak terlalu aktif, atau memiliki waktu recency yang cukup besar, oleh karena itulah Cluster ini didominasi oleh segmen At Risk, dimana sangat rawan untuk menjadi churn. Olist perlu mentreat cluster ini dengan baik, seperti membuat promo menarik, promo event, flashsale, dll agar cluster ini lebih sering melakukan transaksi dengan recency yang sedikit.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>RFM_stats<span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(rfm_clusters_stat(rfm_segmentation))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Visualize Segments</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>squarify<span style="color:#f92672">.</span>plot(sizes<span style="color:#f92672">=</span>RFM_stats[<span style="color:#e6db74">&#34;Monetary&#34;</span>][<span style="color:#e6db74">&#34;count&#34;</span>], label<span style="color:#f92672">=</span>RFM_stats<span style="color:#f92672">.</span>index, color<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;b&#34;</span>,<span style="color:#e6db74">&#34;g&#34;</span>,<span style="color:#e6db74">&#34;r&#34;</span>,<span style="color:#e6db74">&#34;m&#34;</span>,<span style="color:#e6db74">&#34;c&#34;</span>, <span style="color:#e6db74">&#34;y&#34;</span>], alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.7</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>suptitle(<span style="color:#e6db74">&#34;Segments of Customers&#34;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">25</span>)
</span></span></code></pre></div><pre><code>Text(0.5, 0.98, 'Segments of Customers')
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_322_1.png" alt="png"></p>
<h5 id="final-features">Final Features</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rfm_cluster <span style="color:#f92672">=</span> rfm_segmentation<span style="color:#f92672">.</span>loc[:, [<span style="color:#e6db74">&#39;R&#39;</span>, <span style="color:#e6db74">&#39;F&#39;</span>, <span style="color:#e6db74">&#39;M&#39;</span>, <span style="color:#e6db74">&#39;K_Cluster&#39;</span>]]
</span></span><span style="display:flex;"><span>rfm_cluster
</span></span></code></pre></div>  <div id="df-7a1fe57e-5683-411f-aac8-a6549558bfe8">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>K_Cluster</th>
    </tr>
    <tr>
      <th>customer_unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0000366f3b9a7992bf8c76cfdf3221e2</th>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>0000b849f77a49e4a4ce2b2a4ca5be3f</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>0000f46a3911fa3c0805444483337064</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0000f6ccb0745a6a4b88665a16c9f078</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0004aac84e0df4da2b147fca70cf8255</th>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>fffbf87b7a1a6fa8b03f081c5f51a201</th>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>fffea47cd6d3cc0a88bd621562a9d061</th>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ffff371b4d645b6ecea244b27531430a</th>
      <td>1</td>
      <td>5</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ffff5962728ec6157033ef9805bacc48</th>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>ffffd2657e2aad2907e67c3e9daecbeb</th>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>91705 rows × 4 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7a1fe57e-5683-411f-aac8-a6549558bfe8')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-7a1fe57e-5683-411f-aac8-a6549558bfe8 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-7a1fe57e-5683-411f-aac8-a6549558bfe8');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rfm_cluster <span style="color:#f92672">=</span> rfm_cluster<span style="color:#f92672">.</span>reset_index(drop<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>rfm_cluster
</span></span></code></pre></div>  <div id="df-3c83f7e0-da93-4e02-b49b-819a091de8c6">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_unique_id</th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>K_Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000366f3b9a7992bf8c76cfdf3221e2</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000b849f77a49e4a4ce2b2a4ca5be3f</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000f46a3911fa3c0805444483337064</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000f6ccb0745a6a4b88665a16c9f078</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0004aac84e0df4da2b147fca70cf8255</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>91700</th>
      <td>fffbf87b7a1a6fa8b03f081c5f51a201</td>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>91701</th>
      <td>fffea47cd6d3cc0a88bd621562a9d061</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>91702</th>
      <td>ffff371b4d645b6ecea244b27531430a</td>
      <td>1</td>
      <td>5</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>91703</th>
      <td>ffff5962728ec6157033ef9805bacc48</td>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>91704</th>
      <td>ffffd2657e2aad2907e67c3e9daecbeb</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>91705 rows × 5 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-3c83f7e0-da93-4e02-b49b-819a091de8c6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-3c83f7e0-da93-4e02-b49b-819a091de8c6 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-3c83f7e0-da93-4e02-b49b-819a091de8c6');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>final_features
</span></span></code></pre></div>  <div id="df-267ae79d-278b-45d4-958f-fcd6b9e10811">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_unique_id</th>
      <th>avg_shipping_length</th>
      <th>avg_delivery_time</th>
      <th>product_quantity</th>
      <th>avg_price</th>
      <th>avg_freight_value</th>
      <th>avg_payment_value</th>
      <th>avg_review_score</th>
      <th>avg_product_weight_g</th>
      <th>avg_product_volume</th>
      <th>avg_product_desc_length</th>
      <th>avg_product_photos_qty</th>
      <th>avg_estimated_delivery_delta</th>
      <th>avg_del_carrier_approved_delta</th>
      <th>avg_shipping_limit_carrier_delta</th>
      <th>avg_approved_purchase_delta</th>
      <th>avg_review_ans_delta</th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>trans_age</th>
      <th>payment_boleto</th>
      <th>payment_credit_card</th>
      <th>payment_debit_card</th>
      <th>payment_voucher</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0000366f3b9a7992bf8c76cfdf3221e2</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1</td>
      <td>129.90</td>
      <td>12.00</td>
      <td>141.90</td>
      <td>5.0</td>
      <td>1500.0</td>
      <td>7616.0</td>
      <td>236.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>891.0</td>
      <td>395088.0</td>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0000b849f77a49e4a4ce2b2a4ca5be3f</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>18.90</td>
      <td>8.29</td>
      <td>27.19</td>
      <td>4.0</td>
      <td>375.0</td>
      <td>5148.0</td>
      <td>635.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>26057.0</td>
      <td>80965.0</td>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0000f46a3911fa3c0805444483337064</td>
      <td>23.0</td>
      <td>25.0</td>
      <td>1</td>
      <td>69.00</td>
      <td>17.22</td>
      <td>86.22</td>
      <td>3.0</td>
      <td>1500.0</td>
      <td>43750.0</td>
      <td>177.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>91184.0</td>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0000f6ccb0745a6a4b88665a16c9f078</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>1</td>
      <td>25.99</td>
      <td>17.63</td>
      <td>43.62</td>
      <td>4.0</td>
      <td>150.0</td>
      <td>1045.0</td>
      <td>1741.0</td>
      <td>5.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1176.0</td>
      <td>87471.0</td>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0004aac84e0df4da2b147fca70cf8255</td>
      <td>11.0</td>
      <td>13.0</td>
      <td>1</td>
      <td>180.00</td>
      <td>16.89</td>
      <td>196.89</td>
      <td>5.0</td>
      <td>6050.0</td>
      <td>528.0</td>
      <td>794.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>1270.0</td>
      <td>426575.0</td>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>92720</th>
      <td>fffcf5a5ff07b0908bd4e2dbc735a684</td>
      <td>13.0</td>
      <td>27.0</td>
      <td>2</td>
      <td>785.00</td>
      <td>248.71</td>
      <td>2067.42</td>
      <td>5.0</td>
      <td>30000.0</td>
      <td>251625.0</td>
      <td>478.5</td>
      <td>1.0</td>
      <td>26.0</td>
      <td>14.0</td>
      <td>2.0</td>
      <td>880.0</td>
      <td>386405.0</td>
      <td>447</td>
      <td>1</td>
      <td>4134.84</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>92721</th>
      <td>fffea47cd6d3cc0a88bd621562a9d061</td>
      <td>19.0</td>
      <td>30.0</td>
      <td>1</td>
      <td>64.89</td>
      <td>19.69</td>
      <td>84.58</td>
      <td>4.0</td>
      <td>1720.0</td>
      <td>32076.0</td>
      <td>506.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>-7.0</td>
      <td>504.0</td>
      <td>474719.0</td>
      <td>262</td>
      <td>1</td>
      <td>84.58</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>92722</th>
      <td>ffff371b4d645b6ecea244b27531430a</td>
      <td>14.0</td>
      <td>14.0</td>
      <td>1</td>
      <td>89.90</td>
      <td>22.56</td>
      <td>112.46</td>
      <td>5.0</td>
      <td>600.0</td>
      <td>3315.0</td>
      <td>716.0</td>
      <td>5.0</td>
      <td>29.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>808.0</td>
      <td>227001.0</td>
      <td>568</td>
      <td>1</td>
      <td>112.46</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>92723</th>
      <td>ffff5962728ec6157033ef9805bacc48</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>1</td>
      <td>115.00</td>
      <td>18.69</td>
      <td>133.69</td>
      <td>5.0</td>
      <td>444.0</td>
      <td>4480.0</td>
      <td>591.0</td>
      <td>3.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>2466.0</td>
      <td>227780.0</td>
      <td>119</td>
      <td>1</td>
      <td>133.69</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>92724</th>
      <td>ffffd2657e2aad2907e67c3e9daecbeb</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>1</td>
      <td>56.99</td>
      <td>14.57</td>
      <td>71.56</td>
      <td>5.0</td>
      <td>400.0</td>
      <td>2178.0</td>
      <td>1003.0</td>
      <td>2.0</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>68188.0</td>
      <td>212124.0</td>
      <td>484</td>
      <td>1</td>
      <td>71.56</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>92725 rows × 25 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-267ae79d-278b-45d4-958f-fcd6b9e10811')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-267ae79d-278b-45d4-958f-fcd6b9e10811 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-267ae79d-278b-45d4-958f-fcd6b9e10811');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ready <span style="color:#f92672">=</span> rfm_cluster<span style="color:#f92672">.</span>merge(final_features, on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;customer_unique_id&#39;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ready<span style="color:#f92672">.</span>shape
</span></span></code></pre></div><pre><code>(91705, 29)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ready<span style="color:#f92672">.</span>describe()
</span></span></code></pre></div>  <div id="df-6fb9ca05-eb51-4621-a130-e2c75b5bf5fd">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>K_Cluster</th>
      <th>avg_shipping_length</th>
      <th>avg_delivery_time</th>
      <th>product_quantity</th>
      <th>avg_price</th>
      <th>avg_freight_value</th>
      <th>avg_payment_value</th>
      <th>avg_review_score</th>
      <th>avg_product_weight_g</th>
      <th>avg_product_volume</th>
      <th>avg_product_desc_length</th>
      <th>avg_product_photos_qty</th>
      <th>avg_estimated_delivery_delta</th>
      <th>avg_del_carrier_approved_delta</th>
      <th>avg_shipping_limit_carrier_delta</th>
      <th>avg_approved_purchase_delta</th>
      <th>avg_review_ans_delta</th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>trans_age</th>
      <th>payment_boleto</th>
      <th>payment_credit_card</th>
      <th>payment_debit_card</th>
      <th>payment_voucher</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>9.170500e+04</td>
      <td>9.170500e+04</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.003664</td>
      <td>3.000000</td>
      <td>2.999989</td>
      <td>1.153961</td>
      <td>9.262811</td>
      <td>12.044696</td>
      <td>1.210196</td>
      <td>118.352967</td>
      <td>19.927310</td>
      <td>145.546748</td>
      <td>4.160134</td>
      <td>2051.961383</td>
      <td>14892.993453</td>
      <td>780.481248</td>
      <td>2.227249</td>
      <td>10.876530</td>
      <td>2.269577</td>
      <td>2.843747</td>
      <td>3.675545e+04</td>
      <td>2.724672e+05</td>
      <td>237.294281</td>
      <td>1.031972</td>
      <td>176.478780</td>
      <td>3.557603</td>
      <td>0.231274</td>
      <td>0.895207</td>
      <td>0.017829</td>
      <td>0.065885</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.413276</td>
      <td>1.414221</td>
      <td>1.414233</td>
      <td>1.154102</td>
      <td>8.710440</td>
      <td>9.455751</td>
      <td>0.742539</td>
      <td>145.060088</td>
      <td>14.864985</td>
      <td>153.244927</td>
      <td>1.274701</td>
      <td>3630.769036</td>
      <td>22459.834791</td>
      <td>646.962695</td>
      <td>1.745127</td>
      <td>10.057963</td>
      <td>3.463953</td>
      <td>4.047151</td>
      <td>7.297649e+04</td>
      <td>8.481543e+05</td>
      <td>152.538141</td>
      <td>0.201632</td>
      <td>202.981335</td>
      <td>24.667921</td>
      <td>0.518205</td>
      <td>0.661343</td>
      <td>0.152398</td>
      <td>0.560579</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>-16.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.850000</td>
      <td>0.000000</td>
      <td>1.856818</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>168.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-189.000000</td>
      <td>-172.000000</td>
      <td>-96.000000</td>
      <td>0.000000e+00</td>
      <td>7.709000e+03</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>9.590000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>4.000000</td>
      <td>6.000000</td>
      <td>1.000000</td>
      <td>42.000000</td>
      <td>13.370000</td>
      <td>60.100000</td>
      <td>4.000000</td>
      <td>300.000000</td>
      <td>2816.000000</td>
      <td>347.000000</td>
      <td>1.000000</td>
      <td>6.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>7.780000e+02</td>
      <td>8.777600e+04</td>
      <td>114.000000</td>
      <td>1.000000</td>
      <td>63.290000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>7.000000</td>
      <td>10.000000</td>
      <td>1.000000</td>
      <td>79.000000</td>
      <td>16.350000</td>
      <td>102.530000</td>
      <td>5.000000</td>
      <td>700.000000</td>
      <td>6400.000000</td>
      <td>602.000000</td>
      <td>2.000000</td>
      <td>11.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>1.241000e+03</td>
      <td>1.467450e+05</td>
      <td>218.000000</td>
      <td>1.000000</td>
      <td>111.810000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>2.000000</td>
      <td>12.000000</td>
      <td>15.000000</td>
      <td>1.000000</td>
      <td>139.000000</td>
      <td>21.130000</td>
      <td>171.220000</td>
      <td>5.000000</td>
      <td>1800.000000</td>
      <td>18000.000000</td>
      <td>984.000000</td>
      <td>3.000000</td>
      <td>16.000000</td>
      <td>3.000000</td>
      <td>5.000000</td>
      <td>5.166300e+04</td>
      <td>2.686990e+05</td>
      <td>346.000000</td>
      <td>1.000000</td>
      <td>197.060000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>3.000000</td>
      <td>205.000000</td>
      <td>208.000000</td>
      <td>75.000000</td>
      <td>1561.000000</td>
      <td>409.680000</td>
      <td>1605.140000</td>
      <td>5.000000</td>
      <td>40425.000000</td>
      <td>296208.000000</td>
      <td>3992.000000</td>
      <td>20.000000</td>
      <td>146.000000</td>
      <td>107.000000</td>
      <td>525.000000</td>
      <td>2.669197e+06</td>
      <td>4.481561e+07</td>
      <td>695.000000</td>
      <td>15.000000</td>
      <td>1605.140000</td>
      <td>634.000000</td>
      <td>8.000000</td>
      <td>15.000000</td>
      <td>6.000000</td>
      <td>75.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6fb9ca05-eb51-4621-a130-e2c75b5bf5fd')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-6fb9ca05-eb51-4621-a130-e2c75b5bf5fd button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-6fb9ca05-eb51-4621-a130-e2c75b5bf5fd');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ready <span style="color:#f92672">=</span> ready<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;customer_unique_id&#39;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ready
</span></span></code></pre></div>  <div id="df-b1f1110a-d156-45bd-a68f-017b01c04b38">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>K_Cluster</th>
      <th>avg_shipping_length</th>
      <th>avg_delivery_time</th>
      <th>product_quantity</th>
      <th>avg_price</th>
      <th>avg_freight_value</th>
      <th>avg_payment_value</th>
      <th>avg_review_score</th>
      <th>avg_product_weight_g</th>
      <th>avg_product_volume</th>
      <th>avg_product_desc_length</th>
      <th>avg_product_photos_qty</th>
      <th>avg_estimated_delivery_delta</th>
      <th>avg_del_carrier_approved_delta</th>
      <th>avg_shipping_limit_carrier_delta</th>
      <th>avg_approved_purchase_delta</th>
      <th>avg_review_ans_delta</th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>trans_age</th>
      <th>payment_boleto</th>
      <th>payment_credit_card</th>
      <th>payment_debit_card</th>
      <th>payment_voucher</th>
    </tr>
    <tr>
      <th>customer_unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0000366f3b9a7992bf8c76cfdf3221e2</th>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1</td>
      <td>129.90</td>
      <td>12.00</td>
      <td>141.90</td>
      <td>5.0</td>
      <td>1500.0</td>
      <td>7616.0</td>
      <td>236.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>891.0</td>
      <td>395088.0</td>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0000b849f77a49e4a4ce2b2a4ca5be3f</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>18.90</td>
      <td>8.29</td>
      <td>27.19</td>
      <td>4.0</td>
      <td>375.0</td>
      <td>5148.0</td>
      <td>635.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>26057.0</td>
      <td>80965.0</td>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0000f46a3911fa3c0805444483337064</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>23.0</td>
      <td>25.0</td>
      <td>1</td>
      <td>69.00</td>
      <td>17.22</td>
      <td>86.22</td>
      <td>3.0</td>
      <td>1500.0</td>
      <td>43750.0</td>
      <td>177.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>91184.0</td>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0000f6ccb0745a6a4b88665a16c9f078</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>1</td>
      <td>25.99</td>
      <td>17.63</td>
      <td>43.62</td>
      <td>4.0</td>
      <td>150.0</td>
      <td>1045.0</td>
      <td>1741.0</td>
      <td>5.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1176.0</td>
      <td>87471.0</td>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0004aac84e0df4da2b147fca70cf8255</th>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>11.0</td>
      <td>13.0</td>
      <td>1</td>
      <td>180.00</td>
      <td>16.89</td>
      <td>196.89</td>
      <td>5.0</td>
      <td>6050.0</td>
      <td>528.0</td>
      <td>794.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>1270.0</td>
      <td>426575.0</td>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>fffbf87b7a1a6fa8b03f081c5f51a201</th>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
      <td>10.0</td>
      <td>18.0</td>
      <td>1</td>
      <td>149.00</td>
      <td>18.32</td>
      <td>167.32</td>
      <td>5.0</td>
      <td>350.0</td>
      <td>704.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>13.0</td>
      <td>8.0</td>
      <td>-2.0</td>
      <td>663.0</td>
      <td>255288.0</td>
      <td>245</td>
      <td>1</td>
      <td>167.32</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>fffea47cd6d3cc0a88bd621562a9d061</th>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>19.0</td>
      <td>30.0</td>
      <td>1</td>
      <td>64.89</td>
      <td>19.69</td>
      <td>84.58</td>
      <td>4.0</td>
      <td>1720.0</td>
      <td>32076.0</td>
      <td>506.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>-7.0</td>
      <td>504.0</td>
      <td>474719.0</td>
      <td>262</td>
      <td>1</td>
      <td>84.58</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ffff371b4d645b6ecea244b27531430a</th>
      <td>1</td>
      <td>5</td>
      <td>3</td>
      <td>0</td>
      <td>14.0</td>
      <td>14.0</td>
      <td>1</td>
      <td>89.90</td>
      <td>22.56</td>
      <td>112.46</td>
      <td>5.0</td>
      <td>600.0</td>
      <td>3315.0</td>
      <td>716.0</td>
      <td>5.0</td>
      <td>29.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>808.0</td>
      <td>227001.0</td>
      <td>568</td>
      <td>1</td>
      <td>112.46</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ffff5962728ec6157033ef9805bacc48</th>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>2</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>1</td>
      <td>115.00</td>
      <td>18.69</td>
      <td>133.69</td>
      <td>5.0</td>
      <td>444.0</td>
      <td>4480.0</td>
      <td>591.0</td>
      <td>3.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>2466.0</td>
      <td>227780.0</td>
      <td>119</td>
      <td>1</td>
      <td>133.69</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ffffd2657e2aad2907e67c3e9daecbeb</th>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>1</td>
      <td>56.99</td>
      <td>14.57</td>
      <td>71.56</td>
      <td>5.0</td>
      <td>400.0</td>
      <td>2178.0</td>
      <td>1003.0</td>
      <td>2.0</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>68188.0</td>
      <td>212124.0</td>
      <td>484</td>
      <td>1</td>
      <td>71.56</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>91705 rows × 28 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b1f1110a-d156-45bd-a68f-017b01c04b38')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-b1f1110a-d156-45bd-a68f-017b01c04b38 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-b1f1110a-d156-45bd-a68f-017b01c04b38');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h3 id="churn-definition">Churn Definition</h3>
<p>Pada proyek ini, saya mendefinisikan bahwa customer yang tergolong churn adalah mereka yang tidak melakukan transaksi dalam 3 bulan terakhir (3 bulan sebelum tangggal transaksi terakhir)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">churnLabel</span>(recency):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> recency <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">90</span> :
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> :
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ready[<span style="color:#e6db74">&#39;is_churn&#39;</span>] <span style="color:#f92672">=</span> ready[<span style="color:#e6db74">&#39;Recency&#39;</span>]<span style="color:#f92672">.</span>apply(churnLabel)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ready<span style="color:#f92672">.</span>head()
</span></span></code></pre></div>  <div id="df-63f6cee5-2cfb-40c0-950d-285836386fc4">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>K_Cluster</th>
      <th>avg_shipping_length</th>
      <th>avg_delivery_time</th>
      <th>product_quantity</th>
      <th>avg_price</th>
      <th>avg_freight_value</th>
      <th>avg_payment_value</th>
      <th>avg_review_score</th>
      <th>avg_product_weight_g</th>
      <th>avg_product_volume</th>
      <th>avg_product_desc_length</th>
      <th>avg_product_photos_qty</th>
      <th>avg_estimated_delivery_delta</th>
      <th>avg_del_carrier_approved_delta</th>
      <th>avg_shipping_limit_carrier_delta</th>
      <th>avg_approved_purchase_delta</th>
      <th>avg_review_ans_delta</th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>trans_age</th>
      <th>payment_boleto</th>
      <th>payment_credit_card</th>
      <th>payment_debit_card</th>
      <th>payment_voucher</th>
      <th>is_churn</th>
    </tr>
    <tr>
      <th>customer_unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0000366f3b9a7992bf8c76cfdf3221e2</th>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1</td>
      <td>129.90</td>
      <td>12.00</td>
      <td>141.90</td>
      <td>5.0</td>
      <td>1500.0</td>
      <td>7616.0</td>
      <td>236.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>891.0</td>
      <td>395088.0</td>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0000b849f77a49e4a4ce2b2a4ca5be3f</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>18.90</td>
      <td>8.29</td>
      <td>27.19</td>
      <td>4.0</td>
      <td>375.0</td>
      <td>5148.0</td>
      <td>635.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>26057.0</td>
      <td>80965.0</td>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0000f46a3911fa3c0805444483337064</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>23.0</td>
      <td>25.0</td>
      <td>1</td>
      <td>69.00</td>
      <td>17.22</td>
      <td>86.22</td>
      <td>3.0</td>
      <td>1500.0</td>
      <td>43750.0</td>
      <td>177.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>91184.0</td>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0000f6ccb0745a6a4b88665a16c9f078</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>1</td>
      <td>25.99</td>
      <td>17.63</td>
      <td>43.62</td>
      <td>4.0</td>
      <td>150.0</td>
      <td>1045.0</td>
      <td>1741.0</td>
      <td>5.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1176.0</td>
      <td>87471.0</td>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0004aac84e0df4da2b147fca70cf8255</th>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>11.0</td>
      <td>13.0</td>
      <td>1</td>
      <td>180.00</td>
      <td>16.89</td>
      <td>196.89</td>
      <td>5.0</td>
      <td>6050.0</td>
      <td>528.0</td>
      <td>794.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>1270.0</td>
      <td>426575.0</td>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-63f6cee5-2cfb-40c0-950d-285836386fc4')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-63f6cee5-2cfb-40c0-950d-285836386fc4 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-63f6cee5-2cfb-40c0-950d-285836386fc4');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>ready[<span style="color:#e6db74">&#39;is_churn&#39;</span>]<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>plot<span style="color:#f92672">.</span>pie(autopct<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%1.2f%%</span><span style="color:#e6db74">&#39;</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">8</span>))
</span></span></code></pre></div><pre><code>&lt;AxesSubplot:ylabel='is_churn'&gt;
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_337_1.png" alt="png"></p>
<p>Diketahui bahwa sebanyak 80.26% pelanggan tergolong churn, dan 19.74% pelannggan tergolong tidak churn.</p>
<h2 id="modeling-for-churn">Modeling for Churn</h2>
<h4 id="survival-analysis">Survival Analysis</h4>
<p>Survival Analysis adalah salah satu metode pemodelan regresi untuk menentukan kemungkinan customer untuk churn, dilihat dari telah berapa lama customer itu melakukan transaksi. Survival Analysis bekerja dengan baik dalam situasi di mana kita dapat mendefinisikan:</p>
<ul>
<li>&lsquo;Birth&rsquo; Event: ini akan menjadi waktu dimana pelanggan melakukan transaksi pertama mereka</li>
<li>&lsquo;Death&rsquo; Event: ini akan menjadi waktu dimana pelanggan melakukan transaksi terakhir mereka</li>
</ul>
<p>Komponen yang membuat Survival Analysis lebih unggul dari model regresi lainnya adalah kemampuannya untuk menangani sensor dalam data. Dalam pengertian tradisional, penyensoran dapat merujuk pada kehilangan jejak individu atau individu yang tidak meninggal sebelum akhir periode pengamatan. Data ini &lsquo;disensor&rsquo; karena semua orang pada akhirnya mati, kami hanya kehilangan data.</p>
<p>Untuk setiap pelanggan, kita memerlukan dua fitur utama untuk Survival Analysis:</p>
<ul>
<li>&rsquo;trans_age&rsquo;: berapa lama mereka menjadi pelanggan saat data diamati (transaksi terakhir - transaksi pertama)</li>
<li>&lsquo;Churn&rsquo;: apakah pelanggan pergi atau tidak saat data diamati</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ready<span style="color:#f92672">.</span>describe()
</span></span></code></pre></div>  <div id="df-31ecedc9-1e8d-4d60-b559-f6289fd4415b">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>K_Cluster</th>
      <th>avg_shipping_length</th>
      <th>avg_delivery_time</th>
      <th>product_quantity</th>
      <th>avg_price</th>
      <th>avg_freight_value</th>
      <th>avg_payment_value</th>
      <th>avg_review_score</th>
      <th>avg_product_weight_g</th>
      <th>avg_product_volume</th>
      <th>avg_product_desc_length</th>
      <th>avg_product_photos_qty</th>
      <th>avg_estimated_delivery_delta</th>
      <th>avg_del_carrier_approved_delta</th>
      <th>avg_shipping_limit_carrier_delta</th>
      <th>avg_approved_purchase_delta</th>
      <th>avg_review_ans_delta</th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>trans_age</th>
      <th>payment_boleto</th>
      <th>payment_credit_card</th>
      <th>payment_debit_card</th>
      <th>payment_voucher</th>
      <th>is_churn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>9.170500e+04</td>
      <td>9.170500e+04</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
      <td>91705.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.003664</td>
      <td>3.000000</td>
      <td>2.999989</td>
      <td>1.153961</td>
      <td>9.262811</td>
      <td>12.044696</td>
      <td>1.210196</td>
      <td>118.352967</td>
      <td>19.927310</td>
      <td>145.546748</td>
      <td>4.160134</td>
      <td>2051.961383</td>
      <td>14892.993453</td>
      <td>780.481248</td>
      <td>2.227249</td>
      <td>10.876530</td>
      <td>2.269577</td>
      <td>2.843747</td>
      <td>3.675545e+04</td>
      <td>2.724672e+05</td>
      <td>237.294281</td>
      <td>1.031972</td>
      <td>176.478780</td>
      <td>3.557603</td>
      <td>0.231274</td>
      <td>0.895207</td>
      <td>0.017829</td>
      <td>0.065885</td>
      <td>0.802552</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.413276</td>
      <td>1.414221</td>
      <td>1.414233</td>
      <td>1.154102</td>
      <td>8.710440</td>
      <td>9.455751</td>
      <td>0.742539</td>
      <td>145.060088</td>
      <td>14.864985</td>
      <td>153.244927</td>
      <td>1.274701</td>
      <td>3630.769036</td>
      <td>22459.834791</td>
      <td>646.962695</td>
      <td>1.745127</td>
      <td>10.057963</td>
      <td>3.463953</td>
      <td>4.047151</td>
      <td>7.297649e+04</td>
      <td>8.481543e+05</td>
      <td>152.538141</td>
      <td>0.201632</td>
      <td>202.981335</td>
      <td>24.667921</td>
      <td>0.518205</td>
      <td>0.661343</td>
      <td>0.152398</td>
      <td>0.560579</td>
      <td>0.398076</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>-16.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.850000</td>
      <td>0.000000</td>
      <td>1.856818</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>168.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-189.000000</td>
      <td>-172.000000</td>
      <td>-96.000000</td>
      <td>0.000000e+00</td>
      <td>7.709000e+03</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>9.590000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>4.000000</td>
      <td>6.000000</td>
      <td>1.000000</td>
      <td>42.000000</td>
      <td>13.370000</td>
      <td>60.100000</td>
      <td>4.000000</td>
      <td>300.000000</td>
      <td>2816.000000</td>
      <td>347.000000</td>
      <td>1.000000</td>
      <td>6.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>7.780000e+02</td>
      <td>8.777600e+04</td>
      <td>114.000000</td>
      <td>1.000000</td>
      <td>63.290000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>7.000000</td>
      <td>10.000000</td>
      <td>1.000000</td>
      <td>79.000000</td>
      <td>16.350000</td>
      <td>102.530000</td>
      <td>5.000000</td>
      <td>700.000000</td>
      <td>6400.000000</td>
      <td>602.000000</td>
      <td>2.000000</td>
      <td>11.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>1.241000e+03</td>
      <td>1.467450e+05</td>
      <td>218.000000</td>
      <td>1.000000</td>
      <td>111.810000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>2.000000</td>
      <td>12.000000</td>
      <td>15.000000</td>
      <td>1.000000</td>
      <td>139.000000</td>
      <td>21.130000</td>
      <td>171.220000</td>
      <td>5.000000</td>
      <td>1800.000000</td>
      <td>18000.000000</td>
      <td>984.000000</td>
      <td>3.000000</td>
      <td>16.000000</td>
      <td>3.000000</td>
      <td>5.000000</td>
      <td>5.166300e+04</td>
      <td>2.686990e+05</td>
      <td>346.000000</td>
      <td>1.000000</td>
      <td>197.060000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>3.000000</td>
      <td>205.000000</td>
      <td>208.000000</td>
      <td>75.000000</td>
      <td>1561.000000</td>
      <td>409.680000</td>
      <td>1605.140000</td>
      <td>5.000000</td>
      <td>40425.000000</td>
      <td>296208.000000</td>
      <td>3992.000000</td>
      <td>20.000000</td>
      <td>146.000000</td>
      <td>107.000000</td>
      <td>525.000000</td>
      <td>2.669197e+06</td>
      <td>4.481561e+07</td>
      <td>695.000000</td>
      <td>15.000000</td>
      <td>1605.140000</td>
      <td>634.000000</td>
      <td>8.000000</td>
      <td>15.000000</td>
      <td>6.000000</td>
      <td>75.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-31ecedc9-1e8d-4d60-b559-f6289fd4415b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-31ecedc9-1e8d-4d60-b559-f6289fd4415b button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-31ecedc9-1e8d-4d60-b559-f6289fd4415b');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># transform tenure and churn features</span>
</span></span><span style="display:flex;"><span>SA <span style="color:#f92672">=</span> ready<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>SA[<span style="color:#e6db74">&#39;trans_age&#39;</span>] <span style="color:#f92672">=</span> SA[<span style="color:#e6db74">&#39;trans_age&#39;</span>]<span style="color:#f92672">.</span>astype(float)
</span></span><span style="display:flex;"><span>SA[<span style="color:#e6db74">&#39;is_churn&#39;</span>] <span style="color:#f92672">=</span> SA[<span style="color:#e6db74">&#39;is_churn&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>SA<span style="color:#f92672">.</span>head()
</span></span></code></pre></div>  <div id="df-7629a0e4-01e8-40aa-b650-ae6f80a23af2">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>K_Cluster</th>
      <th>avg_shipping_length</th>
      <th>avg_delivery_time</th>
      <th>product_quantity</th>
      <th>avg_price</th>
      <th>avg_freight_value</th>
      <th>avg_payment_value</th>
      <th>avg_review_score</th>
      <th>avg_product_weight_g</th>
      <th>avg_product_volume</th>
      <th>avg_product_desc_length</th>
      <th>avg_product_photos_qty</th>
      <th>avg_estimated_delivery_delta</th>
      <th>avg_del_carrier_approved_delta</th>
      <th>avg_shipping_limit_carrier_delta</th>
      <th>avg_approved_purchase_delta</th>
      <th>avg_review_ans_delta</th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>trans_age</th>
      <th>payment_boleto</th>
      <th>payment_credit_card</th>
      <th>payment_debit_card</th>
      <th>payment_voucher</th>
      <th>is_churn</th>
    </tr>
    <tr>
      <th>customer_unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0000366f3b9a7992bf8c76cfdf3221e2</th>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1</td>
      <td>129.90</td>
      <td>12.00</td>
      <td>141.90</td>
      <td>5.0</td>
      <td>1500.0</td>
      <td>7616.0</td>
      <td>236.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>891.0</td>
      <td>395088.0</td>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>0000b849f77a49e4a4ce2b2a4ca5be3f</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>18.90</td>
      <td>8.29</td>
      <td>27.19</td>
      <td>4.0</td>
      <td>375.0</td>
      <td>5148.0</td>
      <td>635.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>26057.0</td>
      <td>80965.0</td>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>0000f46a3911fa3c0805444483337064</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>23.0</td>
      <td>25.0</td>
      <td>1</td>
      <td>69.00</td>
      <td>17.22</td>
      <td>86.22</td>
      <td>3.0</td>
      <td>1500.0</td>
      <td>43750.0</td>
      <td>177.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>91184.0</td>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>0000f6ccb0745a6a4b88665a16c9f078</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>1</td>
      <td>25.99</td>
      <td>17.63</td>
      <td>43.62</td>
      <td>4.0</td>
      <td>150.0</td>
      <td>1045.0</td>
      <td>1741.0</td>
      <td>5.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1176.0</td>
      <td>87471.0</td>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>0004aac84e0df4da2b147fca70cf8255</th>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>11.0</td>
      <td>13.0</td>
      <td>1</td>
      <td>180.00</td>
      <td>16.89</td>
      <td>196.89</td>
      <td>5.0</td>
      <td>6050.0</td>
      <td>528.0</td>
      <td>794.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>1270.0</td>
      <td>426575.0</td>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7629a0e4-01e8-40aa-b650-ae6f80a23af2')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-7629a0e4-01e8-40aa-b650-ae6f80a23af2 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-7629a0e4-01e8-40aa-b650-ae6f80a23af2');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<h6 id="kaplan-meier-curve">Kaplan-Meier Curve</h6>
<p>Sebelum masuk ke analisis lebih lanjut, mari kita lihat survival rate pelanggan menggunakan Kaplan-Meier survival curve.</p>
<p>Dengan menggunakan kode di bawah ini, kita dapat menyesuaikan Kaplan-Meier survival curve dengan data churn pelanggan, dan memplot survival curve dengan confidence interval.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>SA<span style="color:#f92672">.</span>isna()<span style="color:#f92672">.</span>sum()
</span></span></code></pre></div><pre><code>R                                   0
F                                   0
M                                   0
K_Cluster                           0
avg_shipping_length                 0
avg_delivery_time                   0
product_quantity                    0
avg_price                           0
avg_freight_value                   0
avg_payment_value                   0
avg_review_score                    0
avg_product_weight_g                0
avg_product_volume                  0
avg_product_desc_length             0
avg_product_photos_qty              0
avg_estimated_delivery_delta        0
avg_del_carrier_approved_delta      0
avg_shipping_limit_carrier_delta    0
avg_approved_purchase_delta         0
avg_review_ans_delta                0
Recency                             0
Frequency                           0
Monetary                            0
trans_age                           0
payment_boleto                      0
payment_credit_card                 0
payment_debit_card                  0
payment_voucher                     0
is_churn                            0
dtype: int64
</code></pre>
<p>Survival curve bersifat kumulatif. Artinya, pada grafik di bawah ini, peluang pelanggan tidak churn semakin menurun. Artinya kebanyakan pelanggan hanya membeli saat pertama kali (coba-coba).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># fitting kmf to churn data</span>
</span></span><span style="display:flex;"><span>t <span style="color:#f92672">=</span> SA[<span style="color:#e6db74">&#39;trans_age&#39;</span>]<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span>churn <span style="color:#f92672">=</span> SA[<span style="color:#e6db74">&#39;is_churn&#39;</span>]<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span>kmf <span style="color:#f92672">=</span> lifelines<span style="color:#f92672">.</span>KaplanMeierFitter()
</span></span><span style="display:flex;"><span>kmf<span style="color:#f92672">.</span>fit(t, event_observed<span style="color:#f92672">=</span>churn, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Estimate for Average Customer&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># plotting kmf curve</span>
</span></span><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">7</span>))
</span></span><span style="display:flex;"><span>kmf<span style="color:#f92672">.</span>plot(ax<span style="color:#f92672">=</span>ax)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Kaplan-Meier Survival Curve — All Customers&#39;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Customer Transaction Age (days)&#39;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Customer Survival Chance (%)&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_349_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># fitting kmf to churn data</span>
</span></span><span style="display:flex;"><span>t <span style="color:#f92672">=</span> SA[<span style="color:#e6db74">&#39;avg_delivery_time&#39;</span>]<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span>churn <span style="color:#f92672">=</span> SA[<span style="color:#e6db74">&#39;is_churn&#39;</span>]<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span>kmf <span style="color:#f92672">=</span> lifelines<span style="color:#f92672">.</span>KaplanMeierFitter()
</span></span><span style="display:flex;"><span>kmf<span style="color:#f92672">.</span>fit(t, event_observed<span style="color:#f92672">=</span>churn, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Estimate for Average Customer&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># plotting kmf curve</span>
</span></span><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">7</span>))
</span></span><span style="display:flex;"><span>kmf<span style="color:#f92672">.</span>plot(ax<span style="color:#f92672">=</span>ax)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Kaplan-Meier Survival Curve — All Customers&#39;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Customer Delivery Time (Days)&#39;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Customer Survival Chance (%)&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_350_0.png" alt="png"></p>
<h6 id="cox-proportional-hazard-model">Cox Proportional Hazard Model</h6>
<p>Untuk menguji efek dari fitur yang berbeda, kita akan menggunakan Cox&rsquo;s Proportional Hazards Model. Kita dapat menganggap ini sebagai model Survival Regression.</p>
<p><code>'Hazard'</code> dapat dianggap sebagai sesuatu yang akan meningkatkan/menurunkan peluang untuk survive.</p>
<p>Lifeline adalah library yang kita gunakan, dan menawarkan metode check_assumptions bawaan untuk objek CoxPHFitter.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>SA
</span></span></code></pre></div>  <div id="df-8aff1ca3-5df4-4036-a2d8-b65b3c390a78">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>K_Cluster</th>
      <th>avg_shipping_length</th>
      <th>avg_delivery_time</th>
      <th>product_quantity</th>
      <th>avg_price</th>
      <th>avg_freight_value</th>
      <th>avg_payment_value</th>
      <th>avg_review_score</th>
      <th>avg_product_weight_g</th>
      <th>avg_product_volume</th>
      <th>avg_product_desc_length</th>
      <th>avg_product_photos_qty</th>
      <th>avg_estimated_delivery_delta</th>
      <th>avg_del_carrier_approved_delta</th>
      <th>avg_shipping_limit_carrier_delta</th>
      <th>avg_approved_purchase_delta</th>
      <th>avg_review_ans_delta</th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>trans_age</th>
      <th>payment_boleto</th>
      <th>payment_credit_card</th>
      <th>payment_debit_card</th>
      <th>payment_voucher</th>
      <th>is_churn</th>
    </tr>
    <tr>
      <th>customer_unique_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0000366f3b9a7992bf8c76cfdf3221e2</th>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1</td>
      <td>129.90</td>
      <td>12.00</td>
      <td>141.90</td>
      <td>5.0</td>
      <td>1500.0</td>
      <td>7616.0</td>
      <td>236.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>891.0</td>
      <td>395088.0</td>
      <td>111</td>
      <td>1</td>
      <td>141.90</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>0000b849f77a49e4a4ce2b2a4ca5be3f</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>18.90</td>
      <td>8.29</td>
      <td>27.19</td>
      <td>4.0</td>
      <td>375.0</td>
      <td>5148.0</td>
      <td>635.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>26057.0</td>
      <td>80965.0</td>
      <td>114</td>
      <td>1</td>
      <td>27.19</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>0000f46a3911fa3c0805444483337064</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>23.0</td>
      <td>25.0</td>
      <td>1</td>
      <td>69.00</td>
      <td>17.22</td>
      <td>86.22</td>
      <td>3.0</td>
      <td>1500.0</td>
      <td>43750.0</td>
      <td>177.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>91184.0</td>
      <td>537</td>
      <td>1</td>
      <td>86.22</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>0000f6ccb0745a6a4b88665a16c9f078</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>1</td>
      <td>25.99</td>
      <td>17.63</td>
      <td>43.62</td>
      <td>4.0</td>
      <td>150.0</td>
      <td>1045.0</td>
      <td>1741.0</td>
      <td>5.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1176.0</td>
      <td>87471.0</td>
      <td>321</td>
      <td>1</td>
      <td>43.62</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>0004aac84e0df4da2b147fca70cf8255</th>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>11.0</td>
      <td>13.0</td>
      <td>1</td>
      <td>180.00</td>
      <td>16.89</td>
      <td>196.89</td>
      <td>5.0</td>
      <td>6050.0</td>
      <td>528.0</td>
      <td>794.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>1270.0</td>
      <td>426575.0</td>
      <td>288</td>
      <td>1</td>
      <td>196.89</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>fffbf87b7a1a6fa8b03f081c5f51a201</th>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
      <td>10.0</td>
      <td>18.0</td>
      <td>1</td>
      <td>149.00</td>
      <td>18.32</td>
      <td>167.32</td>
      <td>5.0</td>
      <td>350.0</td>
      <td>704.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>13.0</td>
      <td>8.0</td>
      <td>-2.0</td>
      <td>663.0</td>
      <td>255288.0</td>
      <td>245</td>
      <td>1</td>
      <td>167.32</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>fffea47cd6d3cc0a88bd621562a9d061</th>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>19.0</td>
      <td>30.0</td>
      <td>1</td>
      <td>64.89</td>
      <td>19.69</td>
      <td>84.58</td>
      <td>4.0</td>
      <td>1720.0</td>
      <td>32076.0</td>
      <td>506.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>-7.0</td>
      <td>504.0</td>
      <td>474719.0</td>
      <td>262</td>
      <td>1</td>
      <td>84.58</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>ffff371b4d645b6ecea244b27531430a</th>
      <td>1</td>
      <td>5</td>
      <td>3</td>
      <td>0</td>
      <td>14.0</td>
      <td>14.0</td>
      <td>1</td>
      <td>89.90</td>
      <td>22.56</td>
      <td>112.46</td>
      <td>5.0</td>
      <td>600.0</td>
      <td>3315.0</td>
      <td>716.0</td>
      <td>5.0</td>
      <td>29.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>808.0</td>
      <td>227001.0</td>
      <td>568</td>
      <td>1</td>
      <td>112.46</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>ffff5962728ec6157033ef9805bacc48</th>
      <td>4</td>
      <td>5</td>
      <td>3</td>
      <td>2</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>1</td>
      <td>115.00</td>
      <td>18.69</td>
      <td>133.69</td>
      <td>5.0</td>
      <td>444.0</td>
      <td>4480.0</td>
      <td>591.0</td>
      <td>3.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>2466.0</td>
      <td>227780.0</td>
      <td>119</td>
      <td>1</td>
      <td>133.69</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>ffffd2657e2aad2907e67c3e9daecbeb</th>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>1</td>
      <td>56.99</td>
      <td>14.57</td>
      <td>71.56</td>
      <td>5.0</td>
      <td>400.0</td>
      <td>2178.0</td>
      <td>1003.0</td>
      <td>2.0</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>68188.0</td>
      <td>212124.0</td>
      <td>484</td>
      <td>1</td>
      <td>71.56</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>91705 rows × 29 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-8aff1ca3-5df4-4036-a2d8-b65b3c390a78')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-8aff1ca3-5df4-4036-a2d8-b65b3c390a78 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-8aff1ca3-5df4-4036-a2d8-b65b3c390a78');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>SA <span style="color:#f92672">=</span> SA<span style="color:#f92672">.</span>reset_index(drop<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>cph <span style="color:#f92672">=</span> lifelines<span style="color:#f92672">.</span>CoxPHFitter(penalizer<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>)
</span></span><span style="display:flex;"><span>cph<span style="color:#f92672">.</span>fit(SA, duration_col<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;trans_age&#39;</span>, event_col<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;is_churn&#39;</span>, show_progress<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>cph<span style="color:#f92672">.</span>print_summary()
</span></span></code></pre></div><div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <tbody>
    <tr>
      <th>model</th>
      <td>lifelines.CoxPHFitter</td>
    </tr>
    <tr>
      <th>duration col</th>
      <td>'trans_age'</td>
    </tr>
    <tr>
      <th>event col</th>
      <td>'is_churn'</td>
    </tr>
    <tr>
      <th>penalizer</th>
      <td>0.1</td>
    </tr>
    <tr>
      <th>l1 ratio</th>
      <td>0.0</td>
    </tr>
    <tr>
      <th>baseline estimation</th>
      <td>breslow</td>
    </tr>
    <tr>
      <th>number of observations</th>
      <td>91705</td>
    </tr>
    <tr>
      <th>number of events observed</th>
      <td>73598</td>
    </tr>
    <tr>
      <th>partial log-likelihood</th>
      <td>-774948.91</td>
    </tr>
    <tr>
      <th>time fit was run</th>
      <td>2022-11-05 04:48:24 UTC</td>
    </tr>
  </tbody>
</table>
</div><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th style="min-width: 12px;"></th>
      <th style="min-width: 12px;">coef</th>
      <th style="min-width: 12px;">exp(coef)</th>
      <th style="min-width: 12px;">se(coef)</th>
      <th style="min-width: 12px;">coef lower 95%</th>
      <th style="min-width: 12px;">coef upper 95%</th>
      <th style="min-width: 12px;">exp(coef) lower 95%</th>
      <th style="min-width: 12px;">exp(coef) upper 95%</th>
      <th style="min-width: 12px;">cmp to</th>
      <th style="min-width: 12px;">z</th>
      <th style="min-width: 12px;">p</th>
      <th style="min-width: 12px;">-log2(p)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>R</th>
      <td>-0.36</td>
      <td>0.70</td>
      <td>0.00</td>
      <td>-0.37</td>
      <td>-0.35</td>
      <td>0.69</td>
      <td>0.71</td>
      <td>0.00</td>
      <td>-73.38</td>
      <td>&lt;0.005</td>
      <td>inf</td>
    </tr>
    <tr>
      <th>F</th>
      <td>-0.01</td>
      <td>0.99</td>
      <td>0.00</td>
      <td>-0.01</td>
      <td>-0.00</td>
      <td>0.99</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>-2.82</td>
      <td>&lt;0.005</td>
      <td>7.70</td>
    </tr>
    <tr>
      <th>M</th>
      <td>-0.01</td>
      <td>0.99</td>
      <td>0.00</td>
      <td>-0.02</td>
      <td>-0.00</td>
      <td>0.98</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>-2.50</td>
      <td>0.01</td>
      <td>6.35</td>
    </tr>
    <tr>
      <th>K_Cluster</th>
      <td>-0.02</td>
      <td>0.98</td>
      <td>0.00</td>
      <td>-0.03</td>
      <td>-0.02</td>
      <td>0.97</td>
      <td>0.98</td>
      <td>0.00</td>
      <td>-5.55</td>
      <td>&lt;0.005</td>
      <td>25.09</td>
    </tr>
    <tr>
      <th>avg_shipping_length</th>
      <td>0.01</td>
      <td>1.01</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>1.01</td>
      <td>1.01</td>
      <td>0.00</td>
      <td>9.10</td>
      <td>&lt;0.005</td>
      <td>63.22</td>
    </tr>
    <tr>
      <th>avg_delivery_time</th>
      <td>0.01</td>
      <td>1.01</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>1.00</td>
      <td>1.01</td>
      <td>0.00</td>
      <td>6.21</td>
      <td>&lt;0.005</td>
      <td>30.80</td>
    </tr>
    <tr>
      <th>product_quantity</th>
      <td>-0.00</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>-0.02</td>
      <td>0.02</td>
      <td>0.98</td>
      <td>1.02</td>
      <td>0.00</td>
      <td>-0.04</td>
      <td>0.97</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>avg_price</th>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.58</td>
      <td>0.11</td>
      <td>3.13</td>
    </tr>
    <tr>
      <th>avg_freight_value</th>
      <td>-0.01</td>
      <td>0.99</td>
      <td>0.00</td>
      <td>-0.01</td>
      <td>-0.01</td>
      <td>0.99</td>
      <td>0.99</td>
      <td>0.00</td>
      <td>-16.93</td>
      <td>&lt;0.005</td>
      <td>211.28</td>
    </tr>
    <tr>
      <th>avg_payment_value</th>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.53</td>
      <td>0.13</td>
      <td>2.99</td>
    </tr>
    <tr>
      <th>avg_review_score</th>
      <td>-0.01</td>
      <td>0.99</td>
      <td>0.00</td>
      <td>-0.02</td>
      <td>-0.01</td>
      <td>0.98</td>
      <td>0.99</td>
      <td>0.00</td>
      <td>-4.82</td>
      <td>&lt;0.005</td>
      <td>19.39</td>
    </tr>
    <tr>
      <th>avg_product_weight_g</th>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>6.09</td>
      <td>&lt;0.005</td>
      <td>29.72</td>
    </tr>
    <tr>
      <th>avg_product_volume</th>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>3.80</td>
      <td>&lt;0.005</td>
      <td>12.77</td>
    </tr>
    <tr>
      <th>avg_product_desc_length</th>
      <td>-0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>-0.76</td>
      <td>0.45</td>
      <td>1.16</td>
    </tr>
    <tr>
      <th>avg_product_photos_qty</th>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.47</td>
      <td>0.64</td>
      <td>0.66</td>
    </tr>
    <tr>
      <th>avg_estimated_delivery_delta</th>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>5.56</td>
      <td>&lt;0.005</td>
      <td>25.12</td>
    </tr>
    <tr>
      <th>avg_del_carrier_approved_delta</th>
      <td>0.01</td>
      <td>1.01</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>1.00</td>
      <td>1.01</td>
      <td>0.00</td>
      <td>5.04</td>
      <td>&lt;0.005</td>
      <td>21.04</td>
    </tr>
    <tr>
      <th>avg_shipping_limit_carrier_delta</th>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>8.35</td>
      <td>&lt;0.005</td>
      <td>53.71</td>
    </tr>
    <tr>
      <th>avg_approved_purchase_delta</th>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.60</td>
      <td>0.11</td>
      <td>3.19</td>
    </tr>
    <tr>
      <th>avg_review_ans_delta</th>
      <td>-0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>-0.59</td>
      <td>0.56</td>
      <td>0.84</td>
    </tr>
    <tr>
      <th>Recency</th>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>8.94</td>
      <td>&lt;0.005</td>
      <td>61.21</td>
    </tr>
    <tr>
      <th>Frequency</th>
      <td>-1.16</td>
      <td>0.31</td>
      <td>0.03</td>
      <td>-1.21</td>
      <td>-1.11</td>
      <td>0.30</td>
      <td>0.33</td>
      <td>0.00</td>
      <td>-45.24</td>
      <td>&lt;0.005</td>
      <td>inf</td>
    </tr>
    <tr>
      <th>Monetary</th>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.48</td>
      <td>0.63</td>
      <td>0.66</td>
    </tr>
    <tr>
      <th>payment_boleto</th>
      <td>0.01</td>
      <td>1.01</td>
      <td>0.01</td>
      <td>-0.02</td>
      <td>0.03</td>
      <td>0.98</td>
      <td>1.03</td>
      <td>0.00</td>
      <td>0.49</td>
      <td>0.63</td>
      <td>0.68</td>
    </tr>
    <tr>
      <th>payment_credit_card</th>
      <td>0.01</td>
      <td>1.01</td>
      <td>0.01</td>
      <td>-0.01</td>
      <td>0.03</td>
      <td>0.99</td>
      <td>1.03</td>
      <td>0.00</td>
      <td>1.25</td>
      <td>0.21</td>
      <td>2.25</td>
    </tr>
    <tr>
      <th>payment_debit_card</th>
      <td>-0.24</td>
      <td>0.78</td>
      <td>0.03</td>
      <td>-0.30</td>
      <td>-0.19</td>
      <td>0.74</td>
      <td>0.83</td>
      <td>0.00</td>
      <td>-8.42</td>
      <td>&lt;0.005</td>
      <td>54.54</td>
    </tr>
    <tr>
      <th>payment_voucher</th>
      <td>-0.00</td>
      <td>1.00</td>
      <td>0.01</td>
      <td>-0.02</td>
      <td>0.02</td>
      <td>0.98</td>
      <td>1.02</td>
      <td>0.00</td>
      <td>-0.47</td>
      <td>0.64</td>
      <td>0.65</td>
    </tr>
  </tbody>
</table><br><div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <tbody>
    <tr>
      <th>Concordance</th>
      <td>0.99</td>
    </tr>
    <tr>
      <th>Partial AIC</th>
      <td>1549951.82</td>
    </tr>
    <tr>
      <th>log-likelihood ratio test</th>
      <td>34903.70 on 27 df</td>
    </tr>
    <tr>
      <th>-log2(p) of ll-ratio test</th>
      <td>inf</td>
    </tr>
  </tbody>
</table>
</div>
<p>Dalam regresi di atas, output kuncinya adalah <code>exp(coef)</code>. Ini ditafsirkan sebagai skala risiko <code>hazard</code> untuk setiap unit tambahan variabel, skala 1,00 artinya netral.</p>
<p>exp(coef) di bawah 1,0 bagus, artinya pelanggan cenderung tidak churn.</p>
<p>Untuk memvisualisasikan hal di atas dengan lebih baik, kita dapat memplot coeficien output dan confindence intervalnya.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># plotting coefficients</span>
</span></span><span style="display:flex;"><span>fig_coef, ax_coef <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">7</span>))
</span></span><span style="display:flex;"><span>ax_coef<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Survival Regression: Coefficients and Confident Intervals&#39;</span>)
</span></span><span style="display:flex;"><span>cph<span style="color:#f92672">.</span>plot(ax<span style="color:#f92672">=</span>ax_coef);
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_356_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># def plot_categorical_survival(feature, t=&#39;trans-age&#39;, event=&#39;is_churn&#39;, df=SA, ax=None):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     for cat in df[feature].unique():</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         idx = df[feature] == cat</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         kmf = lifelines.KaplanMeierFitter()</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         kmf.fit(df[idx][t], event_observed=df[idx][event], label=cat)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         kmf.plot(ax=ax, label=cat)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ready<span style="color:#f92672">.</span>corr()
</span></span></code></pre></div>  <div id="df-d3ac2c18-d043-4bb9-81bc-c85ca956da6e">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>R</th>
      <th>F</th>
      <th>M</th>
      <th>K_Cluster</th>
      <th>avg_shipping_length</th>
      <th>avg_delivery_time</th>
      <th>product_quantity</th>
      <th>avg_price</th>
      <th>avg_freight_value</th>
      <th>avg_payment_value</th>
      <th>avg_review_score</th>
      <th>avg_product_weight_g</th>
      <th>avg_product_volume</th>
      <th>avg_product_desc_length</th>
      <th>avg_product_photos_qty</th>
      <th>avg_estimated_delivery_delta</th>
      <th>avg_del_carrier_approved_delta</th>
      <th>avg_shipping_limit_carrier_delta</th>
      <th>avg_approved_purchase_delta</th>
      <th>avg_review_ans_delta</th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>trans_age</th>
      <th>payment_boleto</th>
      <th>payment_credit_card</th>
      <th>payment_debit_card</th>
      <th>payment_voucher</th>
      <th>is_churn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>R</th>
      <td>1.000000</td>
      <td>0.005385</td>
      <td>0.015462</td>
      <td>0.619624</td>
      <td>-0.098253</td>
      <td>-0.114600</td>
      <td>-0.010896</td>
      <td>0.001973</td>
      <td>0.055077</td>
      <td>0.009577</td>
      <td>0.018040</td>
      <td>-0.039097</td>
      <td>-0.062742</td>
      <td>0.047756</td>
      <td>0.007003</td>
      <td>-0.032680</td>
      <td>-0.088100</td>
      <td>-0.044541</td>
      <td>0.009681</td>
      <td>-0.036256</td>
      <td>-0.960682</td>
      <td>0.019143</td>
      <td>0.009265</td>
      <td>0.061330</td>
      <td>-0.025382</td>
      <td>0.011016</td>
      <td>0.058630</td>
      <td>-0.019905</td>
      <td>-0.700647</td>
    </tr>
    <tr>
      <th>F</th>
      <td>0.005385</td>
      <td>1.000000</td>
      <td>0.036743</td>
      <td>-0.004817</td>
      <td>-0.000984</td>
      <td>-0.000034</td>
      <td>0.092316</td>
      <td>-0.008702</td>
      <td>0.001364</td>
      <td>-0.005045</td>
      <td>-0.003220</td>
      <td>-0.003735</td>
      <td>-0.002417</td>
      <td>-0.010514</td>
      <td>-0.002197</td>
      <td>0.004670</td>
      <td>0.003606</td>
      <td>0.001501</td>
      <td>-0.004572</td>
      <td>0.001378</td>
      <td>-0.005948</td>
      <td>0.224248</td>
      <td>0.040385</td>
      <td>0.146628</td>
      <td>0.015177</td>
      <td>0.080064</td>
      <td>0.009411</td>
      <td>0.011238</td>
      <td>-0.003971</td>
    </tr>
    <tr>
      <th>M</th>
      <td>0.015462</td>
      <td>0.036743</td>
      <td>1.000000</td>
      <td>0.361321</td>
      <td>0.073802</td>
      <td>0.094891</td>
      <td>0.258796</td>
      <td>0.581063</td>
      <td>0.364398</td>
      <td>0.658007</td>
      <td>-0.065644</td>
      <td>0.355006</td>
      <td>0.316987</td>
      <td>0.155670</td>
      <td>0.001773</td>
      <td>0.041189</td>
      <td>0.076881</td>
      <td>-0.014285</td>
      <td>-0.012025</td>
      <td>0.002654</td>
      <td>-0.014156</td>
      <td>0.149792</td>
      <td>0.690590</td>
      <td>0.099123</td>
      <td>0.021817</td>
      <td>0.270956</td>
      <td>-0.002478</td>
      <td>0.003646</td>
      <td>-0.006686</td>
    </tr>
    <tr>
      <th>K_Cluster</th>
      <td>0.619624</td>
      <td>-0.004817</td>
      <td>0.361321</td>
      <td>1.000000</td>
      <td>-0.037571</td>
      <td>-0.040126</td>
      <td>0.137583</td>
      <td>0.366922</td>
      <td>0.214376</td>
      <td>0.435832</td>
      <td>-0.044174</td>
      <td>0.146237</td>
      <td>0.119657</td>
      <td>0.102279</td>
      <td>0.011901</td>
      <td>-0.035767</td>
      <td>-0.031655</td>
      <td>-0.034617</td>
      <td>0.013610</td>
      <td>-0.020632</td>
      <td>-0.589858</td>
      <td>-0.021154</td>
      <td>0.470604</td>
      <td>-0.013832</td>
      <td>0.013067</td>
      <td>0.144564</td>
      <td>0.030211</td>
      <td>-0.008600</td>
      <td>-0.389959</td>
    </tr>
    <tr>
      <th>avg_shipping_length</th>
      <td>-0.098253</td>
      <td>-0.000984</td>
      <td>0.073802</td>
      <td>-0.037571</td>
      <td>1.000000</td>
      <td>0.927275</td>
      <td>-0.023228</td>
      <td>0.048481</td>
      <td>0.208064</td>
      <td>0.059635</td>
      <td>-0.302039</td>
      <td>0.031485</td>
      <td>0.024570</td>
      <td>0.002259</td>
      <td>-0.014245</td>
      <td>-0.580020</td>
      <td>0.021791</td>
      <td>0.012819</td>
      <td>0.010365</td>
      <td>0.007426</td>
      <td>0.078330</td>
      <td>-0.008264</td>
      <td>0.035847</td>
      <td>-0.009455</td>
      <td>-0.005804</td>
      <td>-0.017214</td>
      <td>-0.020799</td>
      <td>0.000561</td>
      <td>0.192269</td>
    </tr>
    <tr>
      <th>avg_delivery_time</th>
      <td>-0.114600</td>
      <td>-0.000034</td>
      <td>0.094891</td>
      <td>-0.040126</td>
      <td>0.927275</td>
      <td>1.000000</td>
      <td>-0.017066</td>
      <td>0.068483</td>
      <td>0.223767</td>
      <td>0.082513</td>
      <td>-0.336067</td>
      <td>0.079485</td>
      <td>0.071956</td>
      <td>0.002762</td>
      <td>-0.027373</td>
      <td>-0.603802</td>
      <td>0.379526</td>
      <td>-0.192919</td>
      <td>0.079950</td>
      <td>0.008823</td>
      <td>0.096672</td>
      <td>-0.006382</td>
      <td>0.058806</td>
      <td>-0.009574</td>
      <td>0.040324</td>
      <td>-0.046290</td>
      <td>-0.021895</td>
      <td>0.000681</td>
      <td>0.201753</td>
    </tr>
    <tr>
      <th>product_quantity</th>
      <td>-0.010896</td>
      <td>0.092316</td>
      <td>0.258796</td>
      <td>0.137583</td>
      <td>-0.023228</td>
      <td>-0.017066</td>
      <td>1.000000</td>
      <td>-0.068685</td>
      <td>-0.033229</td>
      <td>0.002977</td>
      <td>-0.069872</td>
      <td>-0.013510</td>
      <td>-0.005467</td>
      <td>-0.027990</td>
      <td>-0.037190</td>
      <td>0.026610</td>
      <td>0.013847</td>
      <td>0.002544</td>
      <td>-0.004661</td>
      <td>-0.000917</td>
      <td>0.010146</td>
      <td>0.385998</td>
      <td>0.361052</td>
      <td>0.209277</td>
      <td>0.121036</td>
      <td>0.429371</td>
      <td>0.023641</td>
      <td>0.699728</td>
      <td>0.006235</td>
    </tr>
    <tr>
      <th>avg_price</th>
      <td>0.001973</td>
      <td>-0.008702</td>
      <td>0.581063</td>
      <td>0.366922</td>
      <td>0.048481</td>
      <td>0.068483</td>
      <td>-0.068685</td>
      <td>1.000000</td>
      <td>0.406181</td>
      <td>0.957844</td>
      <td>0.000886</td>
      <td>0.361863</td>
      <td>0.325125</td>
      <td>0.196919</td>
      <td>0.054911</td>
      <td>0.012659</td>
      <td>0.065832</td>
      <td>-0.013742</td>
      <td>0.002059</td>
      <td>0.002331</td>
      <td>0.002266</td>
      <td>-0.022411</td>
      <td>0.723013</td>
      <td>-0.011101</td>
      <td>-0.066539</td>
      <td>-0.007743</td>
      <td>-0.015683</td>
      <td>-0.016073</td>
      <td>0.000715</td>
    </tr>
    <tr>
      <th>avg_freight_value</th>
      <td>0.055077</td>
      <td>0.001364</td>
      <td>0.364398</td>
      <td>0.214376</td>
      <td>0.208064</td>
      <td>0.223767</td>
      <td>-0.033229</td>
      <td>0.406181</td>
      <td>1.000000</td>
      <td>0.473401</td>
      <td>-0.031654</td>
      <td>0.610450</td>
      <td>0.579791</td>
      <td>0.090589</td>
      <td>0.024497</td>
      <td>0.048896</td>
      <td>0.080225</td>
      <td>-0.015136</td>
      <td>0.023730</td>
      <td>0.003004</td>
      <td>-0.046349</td>
      <td>-0.013579</td>
      <td>0.365687</td>
      <td>-0.007631</td>
      <td>-0.021889</td>
      <td>-0.014680</td>
      <td>-0.012281</td>
      <td>-0.003123</td>
      <td>-0.065214</td>
    </tr>
    <tr>
      <th>avg_payment_value</th>
      <td>0.009577</td>
      <td>-0.005045</td>
      <td>0.658007</td>
      <td>0.435832</td>
      <td>0.059635</td>
      <td>0.082513</td>
      <td>0.002977</td>
      <td>0.957844</td>
      <td>0.473401</td>
      <td>1.000000</td>
      <td>-0.029141</td>
      <td>0.400417</td>
      <td>0.363557</td>
      <td>0.189579</td>
      <td>0.042173</td>
      <td>0.025072</td>
      <td>0.074237</td>
      <td>-0.015972</td>
      <td>0.008151</td>
      <td>0.002815</td>
      <td>-0.005269</td>
      <td>-0.016995</td>
      <td>0.848251</td>
      <td>-0.007940</td>
      <td>-0.024200</td>
      <td>0.080037</td>
      <td>-0.007260</td>
      <td>-0.066136</td>
      <td>-0.006259</td>
    </tr>
    <tr>
      <th>avg_review_score</th>
      <td>0.018040</td>
      <td>-0.003220</td>
      <td>-0.065644</td>
      <td>-0.044174</td>
      <td>-0.302039</td>
      <td>-0.336067</td>
      <td>-0.069872</td>
      <td>0.000886</td>
      <td>-0.031654</td>
      <td>-0.029141</td>
      <td>1.000000</td>
      <td>-0.025923</td>
      <td>-0.023127</td>
      <td>0.016352</td>
      <td>0.013858</td>
      <td>0.271097</td>
      <td>-0.156958</td>
      <td>0.102075</td>
      <td>-0.013312</td>
      <td>0.007025</td>
      <td>-0.008316</td>
      <td>0.009950</td>
      <td>-0.074322</td>
      <td>0.014182</td>
      <td>-0.016550</td>
      <td>-0.058981</td>
      <td>0.003880</td>
      <td>-0.008725</td>
      <td>-0.060184</td>
    </tr>
    <tr>
      <th>avg_product_weight_g</th>
      <td>-0.039097</td>
      <td>-0.003735</td>
      <td>0.355006</td>
      <td>0.146237</td>
      <td>0.031485</td>
      <td>0.079485</td>
      <td>-0.013510</td>
      <td>0.361863</td>
      <td>0.610450</td>
      <td>0.400417</td>
      <td>-0.025923</td>
      <td>1.000000</td>
      <td>0.799979</td>
      <td>0.051964</td>
      <td>0.032262</td>
      <td>-0.009151</td>
      <td>0.136897</td>
      <td>-0.025602</td>
      <td>0.005777</td>
      <td>0.003813</td>
      <td>0.038564</td>
      <td>-0.007416</td>
      <td>0.321175</td>
      <td>-0.005605</td>
      <td>-0.020253</td>
      <td>0.000677</td>
      <td>-0.015097</td>
      <td>0.004133</td>
      <td>0.037025</td>
    </tr>
    <tr>
      <th>avg_product_volume</th>
      <td>-0.062742</td>
      <td>-0.002417</td>
      <td>0.316987</td>
      <td>0.119657</td>
      <td>0.024570</td>
      <td>0.071956</td>
      <td>-0.005467</td>
      <td>0.325125</td>
      <td>0.579791</td>
      <td>0.363557</td>
      <td>-0.023127</td>
      <td>0.799979</td>
      <td>1.000000</td>
      <td>0.012676</td>
      <td>0.020257</td>
      <td>-0.009625</td>
      <td>0.134332</td>
      <td>-0.027655</td>
      <td>0.006186</td>
      <td>0.003767</td>
      <td>0.062262</td>
      <td>-0.006902</td>
      <td>0.293368</td>
      <td>-0.007426</td>
      <td>-0.018610</td>
      <td>0.005311</td>
      <td>-0.015865</td>
      <td>0.008009</td>
      <td>0.048317</td>
    </tr>
    <tr>
      <th>avg_product_desc_length</th>
      <td>0.047756</td>
      <td>-0.010514</td>
      <td>0.155670</td>
      <td>0.102279</td>
      <td>0.002259</td>
      <td>0.002762</td>
      <td>-0.027990</td>
      <td>0.196919</td>
      <td>0.090589</td>
      <td>0.189579</td>
      <td>0.016352</td>
      <td>0.051964</td>
      <td>0.012676</td>
      <td>1.000000</td>
      <td>0.136209</td>
      <td>-0.001588</td>
      <td>-0.001640</td>
      <td>-0.009768</td>
      <td>0.009695</td>
      <td>0.003219</td>
      <td>-0.042964</td>
      <td>-0.014471</td>
      <td>0.140717</td>
      <td>-0.004481</td>
      <td>-0.000993</td>
      <td>-0.022212</td>
      <td>0.005049</td>
      <td>-0.011326</td>
      <td>-0.036292</td>
    </tr>
    <tr>
      <th>avg_product_photos_qty</th>
      <td>0.007003</td>
      <td>-0.002197</td>
      <td>0.001773</td>
      <td>0.011901</td>
      <td>-0.014245</td>
      <td>-0.027373</td>
      <td>-0.037190</td>
      <td>0.054911</td>
      <td>0.024497</td>
      <td>0.042173</td>
      <td>0.013858</td>
      <td>0.032262</td>
      <td>0.020257</td>
      <td>0.136209</td>
      <td>1.000000</td>
      <td>-0.001452</td>
      <td>-0.040051</td>
      <td>-0.025306</td>
      <td>0.007356</td>
      <td>-0.005378</td>
      <td>-0.005932</td>
      <td>-0.014684</td>
      <td>0.009017</td>
      <td>-0.004855</td>
      <td>-0.007617</td>
      <td>-0.028629</td>
      <td>-0.008149</td>
      <td>-0.006230</td>
      <td>-0.005733</td>
    </tr>
    <tr>
      <th>avg_estimated_delivery_delta</th>
      <td>-0.032680</td>
      <td>0.004670</td>
      <td>0.041189</td>
      <td>-0.035767</td>
      <td>-0.580020</td>
      <td>-0.603802</td>
      <td>0.026610</td>
      <td>0.012659</td>
      <td>0.048896</td>
      <td>0.025072</td>
      <td>0.271097</td>
      <td>-0.009151</td>
      <td>-0.009625</td>
      <td>-0.001588</td>
      <td>-0.001452</td>
      <td>1.000000</td>
      <td>-0.183002</td>
      <td>0.302516</td>
      <td>-0.037561</td>
      <td>0.015037</td>
      <td>0.098540</td>
      <td>0.013036</td>
      <td>0.038340</td>
      <td>0.014327</td>
      <td>-0.027307</td>
      <td>0.049049</td>
      <td>-0.004530</td>
      <td>0.003856</td>
      <td>-0.046693</td>
    </tr>
    <tr>
      <th>avg_del_carrier_approved_delta</th>
      <td>-0.088100</td>
      <td>0.003606</td>
      <td>0.076881</td>
      <td>-0.031655</td>
      <td>0.021791</td>
      <td>0.379526</td>
      <td>0.013847</td>
      <td>0.065832</td>
      <td>0.080225</td>
      <td>0.074237</td>
      <td>-0.156958</td>
      <td>0.136897</td>
      <td>0.134332</td>
      <td>-0.001640</td>
      <td>-0.040051</td>
      <td>-0.183002</td>
      <td>1.000000</td>
      <td>-0.567675</td>
      <td>-0.052603</td>
      <td>0.005700</td>
      <td>0.088735</td>
      <td>0.004458</td>
      <td>0.069066</td>
      <td>-0.000250</td>
      <td>-0.002298</td>
      <td>0.015100</td>
      <td>-0.005907</td>
      <td>0.004257</td>
      <td>0.087591</td>
    </tr>
    <tr>
      <th>avg_shipping_limit_carrier_delta</th>
      <td>-0.044541</td>
      <td>0.001501</td>
      <td>-0.014285</td>
      <td>-0.034617</td>
      <td>0.012819</td>
      <td>-0.192919</td>
      <td>0.002544</td>
      <td>-0.013742</td>
      <td>-0.015136</td>
      <td>-0.015972</td>
      <td>0.102075</td>
      <td>-0.025602</td>
      <td>-0.027655</td>
      <td>-0.009768</td>
      <td>-0.025306</td>
      <td>0.302516</td>
      <td>-0.567675</td>
      <td>1.000000</td>
      <td>0.024130</td>
      <td>0.001354</td>
      <td>0.039171</td>
      <td>0.015068</td>
      <td>-0.012529</td>
      <td>0.001251</td>
      <td>0.032799</td>
      <td>-0.022369</td>
      <td>-0.008706</td>
      <td>0.001807</td>
      <td>0.052526</td>
    </tr>
    <tr>
      <th>avg_approved_purchase_delta</th>
      <td>0.009681</td>
      <td>-0.004572</td>
      <td>-0.012025</td>
      <td>0.013610</td>
      <td>0.010365</td>
      <td>0.079950</td>
      <td>-0.004661</td>
      <td>0.002059</td>
      <td>0.023730</td>
      <td>0.008151</td>
      <td>-0.013312</td>
      <td>0.005777</td>
      <td>0.006186</td>
      <td>0.009695</td>
      <td>0.007356</td>
      <td>-0.037561</td>
      <td>-0.052603</td>
      <td>0.024130</td>
      <td>1.000000</td>
      <td>0.000090</td>
      <td>-0.009188</td>
      <td>-0.004717</td>
      <td>0.009214</td>
      <td>-0.009333</td>
      <td>0.499391</td>
      <td>-0.385434</td>
      <td>-0.006120</td>
      <td>-0.011437</td>
      <td>0.001352</td>
    </tr>
    <tr>
      <th>avg_review_ans_delta</th>
      <td>-0.036256</td>
      <td>0.001378</td>
      <td>0.002654</td>
      <td>-0.020632</td>
      <td>0.007426</td>
      <td>0.008823</td>
      <td>-0.000917</td>
      <td>0.002331</td>
      <td>0.003004</td>
      <td>0.002815</td>
      <td>0.007025</td>
      <td>0.003813</td>
      <td>0.003767</td>
      <td>0.003219</td>
      <td>-0.005378</td>
      <td>0.015037</td>
      <td>0.005700</td>
      <td>0.001354</td>
      <td>0.000090</td>
      <td>1.000000</td>
      <td>0.042503</td>
      <td>-0.003588</td>
      <td>0.001618</td>
      <td>-0.001145</td>
      <td>-0.000703</td>
      <td>-0.001956</td>
      <td>-0.004197</td>
      <td>0.002884</td>
      <td>0.022021</td>
    </tr>
    <tr>
      <th>Recency</th>
      <td>-0.960682</td>
      <td>-0.005948</td>
      <td>-0.014156</td>
      <td>-0.589858</td>
      <td>0.078330</td>
      <td>0.096672</td>
      <td>0.010146</td>
      <td>0.002266</td>
      <td>-0.046349</td>
      <td>-0.005269</td>
      <td>-0.008316</td>
      <td>0.038564</td>
      <td>0.062262</td>
      <td>-0.042964</td>
      <td>-0.005932</td>
      <td>0.098540</td>
      <td>0.088735</td>
      <td>0.039171</td>
      <td>-0.009188</td>
      <td>0.042503</td>
      <td>1.000000</td>
      <td>-0.020980</td>
      <td>-0.006787</td>
      <td>-0.060717</td>
      <td>0.025625</td>
      <td>-0.014275</td>
      <td>-0.053417</td>
      <td>0.021114</td>
      <td>0.627818</td>
    </tr>
    <tr>
      <th>Frequency</th>
      <td>0.019143</td>
      <td>0.224248</td>
      <td>0.149792</td>
      <td>-0.021154</td>
      <td>-0.008264</td>
      <td>-0.006382</td>
      <td>0.385998</td>
      <td>-0.022411</td>
      <td>-0.013579</td>
      <td>-0.016995</td>
      <td>0.009950</td>
      <td>-0.007416</td>
      <td>-0.006902</td>
      <td>-0.014471</td>
      <td>-0.014684</td>
      <td>0.013036</td>
      <td>0.004458</td>
      <td>0.015068</td>
      <td>-0.004717</td>
      <td>-0.003588</td>
      <td>-0.020980</td>
      <td>1.000000</td>
      <td>0.158520</td>
      <td>0.602516</td>
      <td>0.096422</td>
      <td>0.314286</td>
      <td>0.014807</td>
      <td>0.047352</td>
      <td>-0.011831</td>
    </tr>
    <tr>
      <th>Monetary</th>
      <td>0.009265</td>
      <td>0.040385</td>
      <td>0.690590</td>
      <td>0.470604</td>
      <td>0.035847</td>
      <td>0.058806</td>
      <td>0.361052</td>
      <td>0.723013</td>
      <td>0.365687</td>
      <td>0.848251</td>
      <td>-0.074322</td>
      <td>0.321175</td>
      <td>0.293368</td>
      <td>0.140717</td>
      <td>0.009017</td>
      <td>0.038340</td>
      <td>0.069066</td>
      <td>-0.012529</td>
      <td>0.009214</td>
      <td>0.001618</td>
      <td>-0.006787</td>
      <td>0.158520</td>
      <td>1.000000</td>
      <td>0.094160</td>
      <td>0.075357</td>
      <td>0.331911</td>
      <td>0.014802</td>
      <td>0.012990</td>
      <td>-0.004758</td>
    </tr>
    <tr>
      <th>trans_age</th>
      <td>0.061330</td>
      <td>0.146628</td>
      <td>0.099123</td>
      <td>-0.013832</td>
      <td>-0.009455</td>
      <td>-0.009574</td>
      <td>0.209277</td>
      <td>-0.011101</td>
      <td>-0.007631</td>
      <td>-0.007940</td>
      <td>0.014182</td>
      <td>-0.005605</td>
      <td>-0.007426</td>
      <td>-0.004481</td>
      <td>-0.004855</td>
      <td>0.014327</td>
      <td>-0.000250</td>
      <td>0.001251</td>
      <td>-0.009333</td>
      <td>-0.001145</td>
      <td>-0.060717</td>
      <td>0.602516</td>
      <td>0.094160</td>
      <td>1.000000</td>
      <td>0.039033</td>
      <td>0.182140</td>
      <td>0.009048</td>
      <td>0.023786</td>
      <td>-0.046932</td>
    </tr>
    <tr>
      <th>payment_boleto</th>
      <td>-0.025382</td>
      <td>0.015177</td>
      <td>0.021817</td>
      <td>0.013067</td>
      <td>-0.005804</td>
      <td>0.040324</td>
      <td>0.121036</td>
      <td>-0.066539</td>
      <td>-0.021889</td>
      <td>-0.024200</td>
      <td>-0.016550</td>
      <td>-0.020253</td>
      <td>-0.018610</td>
      <td>-0.000993</td>
      <td>-0.007617</td>
      <td>-0.027307</td>
      <td>-0.002298</td>
      <td>0.032799</td>
      <td>0.499391</td>
      <td>-0.000703</td>
      <td>0.025625</td>
      <td>0.096422</td>
      <td>0.075357</td>
      <td>0.039033</td>
      <td>1.000000</td>
      <td>-0.594103</td>
      <td>-0.048622</td>
      <td>-0.049977</td>
      <td>0.017216</td>
    </tr>
    <tr>
      <th>payment_credit_card</th>
      <td>0.011016</td>
      <td>0.080064</td>
      <td>0.270956</td>
      <td>0.144564</td>
      <td>-0.017214</td>
      <td>-0.046290</td>
      <td>0.429371</td>
      <td>-0.007743</td>
      <td>-0.014680</td>
      <td>0.080037</td>
      <td>-0.058981</td>
      <td>0.000677</td>
      <td>0.005311</td>
      <td>-0.022212</td>
      <td>-0.028629</td>
      <td>0.049049</td>
      <td>0.015100</td>
      <td>-0.022369</td>
      <td>-0.385434</td>
      <td>-0.001956</td>
      <td>-0.014275</td>
      <td>0.314286</td>
      <td>0.331911</td>
      <td>0.182140</td>
      <td>-0.594103</td>
      <td>1.000000</td>
      <td>-0.154574</td>
      <td>-0.019791</td>
      <td>0.002962</td>
    </tr>
    <tr>
      <th>payment_debit_card</th>
      <td>0.058630</td>
      <td>0.009411</td>
      <td>-0.002478</td>
      <td>0.030211</td>
      <td>-0.020799</td>
      <td>-0.021895</td>
      <td>0.023641</td>
      <td>-0.015683</td>
      <td>-0.012281</td>
      <td>-0.007260</td>
      <td>0.003880</td>
      <td>-0.015097</td>
      <td>-0.015865</td>
      <td>0.005049</td>
      <td>-0.008149</td>
      <td>-0.004530</td>
      <td>-0.005907</td>
      <td>-0.008706</td>
      <td>-0.006120</td>
      <td>-0.004197</td>
      <td>-0.053417</td>
      <td>0.014807</td>
      <td>0.014802</td>
      <td>0.009048</td>
      <td>-0.048622</td>
      <td>-0.154574</td>
      <td>1.000000</td>
      <td>-0.013239</td>
      <td>-0.077862</td>
    </tr>
    <tr>
      <th>payment_voucher</th>
      <td>-0.019905</td>
      <td>0.011238</td>
      <td>0.003646</td>
      <td>-0.008600</td>
      <td>0.000561</td>
      <td>0.000681</td>
      <td>0.699728</td>
      <td>-0.016073</td>
      <td>-0.003123</td>
      <td>-0.066136</td>
      <td>-0.008725</td>
      <td>0.004133</td>
      <td>0.008009</td>
      <td>-0.011326</td>
      <td>-0.006230</td>
      <td>0.003856</td>
      <td>0.004257</td>
      <td>0.001807</td>
      <td>-0.011437</td>
      <td>0.002884</td>
      <td>0.021114</td>
      <td>0.047352</td>
      <td>0.012990</td>
      <td>0.023786</td>
      <td>-0.049977</td>
      <td>-0.019791</td>
      <td>-0.013239</td>
      <td>1.000000</td>
      <td>0.010017</td>
    </tr>
    <tr>
      <th>is_churn</th>
      <td>-0.700647</td>
      <td>-0.003971</td>
      <td>-0.006686</td>
      <td>-0.389959</td>
      <td>0.192269</td>
      <td>0.201753</td>
      <td>0.006235</td>
      <td>0.000715</td>
      <td>-0.065214</td>
      <td>-0.006259</td>
      <td>-0.060184</td>
      <td>0.037025</td>
      <td>0.048317</td>
      <td>-0.036292</td>
      <td>-0.005733</td>
      <td>-0.046693</td>
      <td>0.087591</td>
      <td>0.052526</td>
      <td>0.001352</td>
      <td>0.022021</td>
      <td>0.627818</td>
      <td>-0.011831</td>
      <td>-0.004758</td>
      <td>-0.046932</td>
      <td>0.017216</td>
      <td>0.002962</td>
      <td>-0.077862</td>
      <td>0.010017</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d3ac2c18-d043-4bb9-81bc-c85ca956da6e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-d3ac2c18-d043-4bb9-81bc-c85ca956da6e button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-d3ac2c18-d043-4bb9-81bc-c85ca956da6e');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<p>Hubungan antar fitur bisa dilihat dari heatmap dibawah ini, jika nilai korelasi semakin mendekati 1.00, maka antar fitur memiliki korelasi positif. Sebaliknya, jika semakin mendekati -1 maka korelasi akan semakin negatif.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">12</span>))
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>heatmap(ready<span style="color:#f92672">.</span>corr())
</span></span></code></pre></div><pre><code>&lt;AxesSubplot:&gt;
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_360_1.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ready <span style="color:#f92672">=</span> ready<span style="color:#f92672">.</span>reset_index(drop<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ready<span style="color:#f92672">.</span>duplicated()<span style="color:#f92672">.</span>any()
</span></span></code></pre></div><pre><code>False
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ready<span style="color:#f92672">.</span>isna()<span style="color:#f92672">.</span>sum()<span style="color:#f92672">.</span>sum()
</span></span></code></pre></div><pre><code>0
</code></pre>
<h3 id="binary-classification">Binary Classification</h3>
<p>Metode lain untuk menentukan probabilitas churn adalah memakai Modeling Binary Classification. Modeling ini menggunakan supervised algorithm, dimana harus memiliki fitur target (dalam hal ini adalah <code>is_churn</code>), kemudian displit menjadi fitur training dan testing.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cross_validation</span>(model,xtrain,ytrain, scoretype, folds):
</span></span><span style="display:flex;"><span>    scores <span style="color:#f92672">=</span> cross_val_score(estimator <span style="color:#f92672">=</span> model,X<span style="color:#f92672">=</span> xtrain, y <span style="color:#f92672">=</span> ytrain,scoring <span style="color:#f92672">=</span> scoretype,cv <span style="color:#f92672">=</span> folds)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">: </span><span style="color:#e6db74">%0.3f</span><span style="color:#e6db74"> (+/- </span><span style="color:#e6db74">%0.2f</span><span style="color:#e6db74">)&#34;</span> <span style="color:#f92672">%</span> (<span style="color:#e6db74">&#34;roc-auc&#34;</span>,scores<span style="color:#f92672">.</span>mean(),scores<span style="color:#f92672">.</span>std()))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">roc_curve</span>(X_test, y_test, model, model_name):
</span></span><span style="display:flex;"><span>  y_pred_proba <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict_proba(X_test)[::,<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>  fpr, tpr, _ <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>roc_curve(y_test,  y_pred_proba)
</span></span><span style="display:flex;"><span>  auc <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>roc_auc_score(y_test, y_pred_proba)
</span></span><span style="display:flex;"><span>  plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>  plt<span style="color:#f92672">.</span>title(model_name, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>  plt<span style="color:#f92672">.</span>plot(fpr,tpr,label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Model:&#34;</span> <span style="color:#f92672">+</span> model_name<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;(AUC=&#34;</span><span style="color:#f92672">+</span>str(auc)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;)&#34;</span>)
</span></span><span style="display:flex;"><span>  plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;True Positive Rate&#39;</span>)
</span></span><span style="display:flex;"><span>  plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;False Positive Rate&#39;</span>)
</span></span><span style="display:flex;"><span>  plt<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>  plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p>Pisahkan fitur dan target, fitur <code>Recency</code> saya drop, karena terlalu influential untuk training.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y <span style="color:#f92672">=</span> ready[<span style="color:#e6db74">&#39;is_churn&#39;</span>]<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> ready<span style="color:#f92672">.</span>drop(columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Recency&#39;</span>,<span style="color:#e6db74">&#39;is_churn&#39;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> MinMaxScaler
</span></span><span style="display:flex;"><span>features <span style="color:#f92672">=</span> X<span style="color:#f92672">.</span>columns<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span>scaler <span style="color:#f92672">=</span> MinMaxScaler(feature_range <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>scaler<span style="color:#f92672">.</span>fit(X)
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(scaler<span style="color:#f92672">.</span>transform(X))
</span></span><span style="display:flex;"><span>X<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> features
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
</span></span><span style="display:flex;"><span>X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">101</span>)
</span></span></code></pre></div><h5 id="oversampling">Oversampling</h5>
<p>Jelas bahwa perbedaan antara customer churn dan tidak churn, tidak seimbang (imbalance). Salah satu cara menanggulangi ini adalah dengan melakukan oversampling. Oversampling akan menyamaratakan proporsi data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>Series(y_train)<span style="color:#f92672">.</span>value_counts()
</span></span></code></pre></div><pre><code>1    51491
0    12702
dtype: int64
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> imblearn.over_sampling <span style="color:#f92672">import</span> SMOTE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>oversample <span style="color:#f92672">=</span> SMOTE()
</span></span><span style="display:flex;"><span>X_train_over, y_train_over <span style="color:#f92672">=</span> oversample<span style="color:#f92672">.</span>fit_resample(X_train, y_train)
</span></span><span style="display:flex;"><span>pd<span style="color:#f92672">.</span>Series(y_train_over)<span style="color:#f92672">.</span>value_counts()
</span></span></code></pre></div><pre><code>1    51491
0    51491
dtype: int64
</code></pre>
<h4 id="baseline-model-comparison-matrix">Baseline Model Comparison Matrix</h4>
<p>Menguji beberapa algortima sebagai baseline model</p>
<h5 id="logistic-regression">Logistic Regression</h5>
<p>Imbalanced Data</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>logreg <span style="color:#f92672">=</span> LogisticRegression()
</span></span><span style="display:flex;"><span>logreg<span style="color:#f92672">.</span>fit(X_train, y_train)
</span></span></code></pre></div><pre><code>LogisticRegression()
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y_predict <span style="color:#f92672">=</span> logreg<span style="color:#f92672">.</span>predict(X_test)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(classification_report(y_test, y_predict))
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.99      1.00      0.99      5405
           1       1.00      1.00      1.00     22107

    accuracy                           1.00     27512
   macro avg       0.99      1.00      1.00     27512
weighted avg       1.00      1.00      1.00     27512
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>imb_logreg <span style="color:#f92672">=</span> roc_auc_score(y_test, y_predict)
</span></span><span style="display:flex;"><span>imb_logreg
</span></span></code></pre></div><pre><code>0.9983941737911068
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cross_validation(logreg,X_train,y_train,scoretype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;roc_auc&#34;</span>,folds <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>roc_curve(X_test,y_test,logreg,<span style="color:#e6db74">&#34;Logistic Regression&#34;</span>)
</span></span></code></pre></div><pre><code>roc-auc: 0.999 (+/- 0.00)
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_382_1.png" alt="png"></p>
<p>Oversampled Data</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>logreg_over <span style="color:#f92672">=</span> LogisticRegression()
</span></span><span style="display:flex;"><span>logreg_over<span style="color:#f92672">.</span>fit(X_train_over, y_train_over)
</span></span></code></pre></div><pre><code>LogisticRegression()
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y_predict <span style="color:#f92672">=</span> logreg_over<span style="color:#f92672">.</span>predict(X_test)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(classification_report(y_test, y_predict))
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.99      1.00      0.99      5405
           1       1.00      1.00      1.00     22107

    accuracy                           1.00     27512
   macro avg       0.99      1.00      1.00     27512
weighted avg       1.00      1.00      1.00     27512
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>os_logreg <span style="color:#f92672">=</span> roc_auc_score(y_test, y_predict)
</span></span><span style="display:flex;"><span>os_logreg
</span></span></code></pre></div><pre><code>0.9983941737911068
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cross_validation(logreg_over,X_train_over,y_train_over,scoretype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;roc_auc&#34;</span>,folds <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>roc_curve(X_test,y_test,logreg_over,<span style="color:#e6db74">&#34;Logistic Regression Oversampled&#34;</span>)
</span></span></code></pre></div><pre><code>roc-auc: 0.999 (+/- 0.00)
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_388_1.png" alt="png"></p>
<h5 id="random-forest">Random Forest</h5>
<p>Imbalanced Data</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rf <span style="color:#f92672">=</span> RandomForestClassifier(random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>rf<span style="color:#f92672">.</span>fit(X_train,y_train)
</span></span></code></pre></div><pre><code>RandomForestClassifier(random_state=42)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y_predict <span style="color:#f92672">=</span> rf<span style="color:#f92672">.</span>predict(X_test)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(classification_report(y_test, y_predict))
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.99      1.00      0.99      5405
           1       1.00      1.00      1.00     22107

    accuracy                           1.00     27512
   macro avg       0.99      1.00      1.00     27512
weighted avg       1.00      1.00      1.00     27512
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>imb_rf <span style="color:#f92672">=</span> roc_auc_score(y_test, y_predict)
</span></span><span style="display:flex;"><span>imb_rf
</span></span></code></pre></div><pre><code>0.9983941737911068
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cross_validation(rf,X_train,y_train,scoretype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;roc_auc&#34;</span>,folds <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>roc_curve(X_test,y_test,rf,<span style="color:#e6db74">&#34;Random Forest&#34;</span>)
</span></span></code></pre></div><pre><code>roc-auc: 1.000 (+/- 0.00)
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_395_1.png" alt="png"></p>
<p>Oversampled Data</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rf_over <span style="color:#f92672">=</span> RandomForestClassifier(random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>rf_over<span style="color:#f92672">.</span>fit(X_train_over,y_train_over)
</span></span></code></pre></div><pre><code>RandomForestClassifier(random_state=42)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y_predict <span style="color:#f92672">=</span> rf_over<span style="color:#f92672">.</span>predict(X_test)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(classification_report(y_test, y_predict))
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.99      1.00      0.99      5405
           1       1.00      1.00      1.00     22107

    accuracy                           1.00     27512
   macro avg       0.99      1.00      1.00     27512
weighted avg       1.00      1.00      1.00     27512
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>os_rf <span style="color:#f92672">=</span> roc_auc_score(y_test, y_predict)
</span></span><span style="display:flex;"><span>os_rf
</span></span></code></pre></div><pre><code>0.9983941737911068
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cross_validation(rf_over,X_train_over,y_train_over,scoretype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;roc_auc&#34;</span>,folds <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>roc_curve(X_test,y_test,rf_over,<span style="color:#e6db74">&#34;Random Forest&#34;</span>)
</span></span></code></pre></div><pre><code>roc-auc: 1.000 (+/- 0.00)
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_401_1.png" alt="png"></p>
<h5 id="decision-tree">Decision Tree</h5>
<p>Imbalanced Data</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dtree <span style="color:#f92672">=</span> DecisionTreeClassifier(random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>dtree<span style="color:#f92672">.</span>fit(X_train,y_train)
</span></span></code></pre></div><pre><code>DecisionTreeClassifier(random_state=42)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y_predict <span style="color:#f92672">=</span> dtree<span style="color:#f92672">.</span>predict(X_test)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(classification_report(y_test, y_predict))
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.99      0.99      0.99      5405
           1       1.00      1.00      1.00     22107

    accuracy                           1.00     27512
   macro avg       0.99      0.99      0.99     27512
weighted avg       1.00      1.00      1.00     27512
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>imb_dtree <span style="color:#f92672">=</span> roc_auc_score(y_test, y_predict)
</span></span><span style="display:flex;"><span>imb_dtree
</span></span></code></pre></div><pre><code>0.9920975884382353
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cross_validation(dtree,X_train,y_train,scoretype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;roc_auc&#34;</span>,folds <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>roc_curve(X_test,y_test,dtree,<span style="color:#e6db74">&#34;Decision Tree&#34;</span>)
</span></span></code></pre></div><pre><code>roc-auc: 0.991 (+/- 0.00)
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_408_1.png" alt="png"></p>
<p>Oversampled Data</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dtree_over <span style="color:#f92672">=</span> DecisionTreeClassifier(random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>dtree_over<span style="color:#f92672">.</span>fit(X_train_over,y_train_over)
</span></span></code></pre></div><pre><code>DecisionTreeClassifier(random_state=42)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y_predict <span style="color:#f92672">=</span> dtree_over<span style="color:#f92672">.</span>predict(X_test)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(classification_report(y_test, y_predict))
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.99      0.99      0.99      5405
           1       1.00      1.00      1.00     22107

    accuracy                           1.00     27512
   macro avg       0.99      0.99      0.99     27512
weighted avg       1.00      1.00      1.00     27512
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>os_dtree <span style="color:#f92672">=</span> roc_auc_score(y_test, y_predict)
</span></span><span style="display:flex;"><span>os_dtree
</span></span></code></pre></div><pre><code>0.9930000405478911
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cross_validation(dtree_over,X_train_over,y_train_over,scoretype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;roc_auc&#34;</span>,folds <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>roc_curve(X_test,y_test,dtree_over,<span style="color:#e6db74">&#34;Decision Tree&#34;</span>)
</span></span></code></pre></div><pre><code>roc-auc: 0.996 (+/- 0.00)
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_414_1.png" alt="png"></p>
<h5 id="gradient-boosting">Gradient Boosting</h5>
<p>Imbalanced Data</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>gbm <span style="color:#f92672">=</span> ensemble<span style="color:#f92672">.</span>GradientBoostingClassifier(random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>)
</span></span><span style="display:flex;"><span>gbm<span style="color:#f92672">.</span>fit(X_train,y_train)
</span></span></code></pre></div><pre><code>GradientBoostingClassifier(random_state=30)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y_predict <span style="color:#f92672">=</span> gbm<span style="color:#f92672">.</span>predict(X_test)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(classification_report(y_test, y_predict))
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.99      1.00      0.99      5405
           1       1.00      1.00      1.00     22107

    accuracy                           1.00     27512
   macro avg       0.99      1.00      1.00     27512
weighted avg       1.00      1.00      1.00     27512
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>imb_gbm <span style="color:#f92672">=</span> roc_auc_score(y_test, y_predict)
</span></span><span style="display:flex;"><span>imb_gbm
</span></span></code></pre></div><pre><code>0.9983941737911068
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cross_validation(gbm,X_train,y_train,scoretype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;roc_auc&#34;</span>,folds <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>roc_curve(X_test,y_test,gbm,<span style="color:#e6db74">&#34;Gradient Boosting Classifier&#34;</span>)
</span></span></code></pre></div><pre><code>roc-auc: 1.000 (+/- 0.00)
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_421_1.png" alt="png"></p>
<p>Oversampled Data</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>gbm_over <span style="color:#f92672">=</span> ensemble<span style="color:#f92672">.</span>GradientBoostingClassifier(random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>)
</span></span><span style="display:flex;"><span>gbm_over<span style="color:#f92672">.</span>fit(X_train_over,y_train_over)
</span></span></code></pre></div><pre><code>GradientBoostingClassifier(random_state=30)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y_predict <span style="color:#f92672">=</span> gbm_over<span style="color:#f92672">.</span>predict(X_test)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(classification_report(y_test, y_predict))
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.99      1.00      0.99      5405
           1       1.00      1.00      1.00     22107

    accuracy                           1.00     27512
   macro avg       0.99      1.00      1.00     27512
weighted avg       1.00      1.00      1.00     27512
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>os_gbm <span style="color:#f92672">=</span> roc_auc_score(y_test, y_predict)
</span></span><span style="display:flex;"><span>os_gbm
</span></span></code></pre></div><pre><code>0.9984167910616547
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cross_validation(gbm_over,X_train_over,y_train_over,scoretype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;roc_auc&#34;</span>,folds <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>roc_curve(X_test,y_test,gbm_over,<span style="color:#e6db74">&#34;Gradient Boosting Classifier&#34;</span>)
</span></span></code></pre></div><pre><code>roc-auc: 1.000 (+/- 0.00)
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_427_1.png" alt="png"></p>
<h5 id="ada-boost">Ada Boost</h5>
<p>Imbalanced Data</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ab <span style="color:#f92672">=</span> ensemble<span style="color:#f92672">.</span>AdaBoostClassifier(random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>)
</span></span><span style="display:flex;"><span>ab<span style="color:#f92672">.</span>fit(X_train,y_train)
</span></span></code></pre></div><pre><code>AdaBoostClassifier(random_state=30)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y_predict <span style="color:#f92672">=</span> ab<span style="color:#f92672">.</span>predict(X_test)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(classification_report(y_test, y_predict))
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.99      1.00      0.99      5405
           1       1.00      1.00      1.00     22107

    accuracy                           1.00     27512
   macro avg       0.99      1.00      1.00     27512
weighted avg       1.00      1.00      1.00     27512
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>imb_ab <span style="color:#f92672">=</span> roc_auc_score(y_test, y_predict)
</span></span><span style="display:flex;"><span>imb_ab
</span></span></code></pre></div><pre><code>0.9973971768876015
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cross_validation(ab,X_train,y_train,scoretype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;roc_auc&#34;</span>,folds <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>roc_curve(X_test,y_test,ab,<span style="color:#e6db74">&#34;Ada Boost Classifier&#34;</span>)
</span></span></code></pre></div><pre><code>roc-auc: 1.000 (+/- 0.00)
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_434_1.png" alt="png"></p>
<p>Oversampled Data</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ab_over <span style="color:#f92672">=</span> ensemble<span style="color:#f92672">.</span>AdaBoostClassifier(random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span>)
</span></span><span style="display:flex;"><span>ab_over<span style="color:#f92672">.</span>fit(X_train_over,y_train_over)
</span></span></code></pre></div><pre><code>AdaBoostClassifier(random_state=30)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y_predict <span style="color:#f92672">=</span> ab_over<span style="color:#f92672">.</span>predict(X_test)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(classification_report(y_test, y_predict))
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.99      1.00      0.99      5405
           1       1.00      1.00      1.00     22107

    accuracy                           1.00     27512
   macro avg       0.99      1.00      1.00     27512
weighted avg       1.00      1.00      1.00     27512
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>os_ab <span style="color:#f92672">=</span> roc_auc_score(y_test, y_predict)
</span></span><span style="display:flex;"><span>os_ab
</span></span></code></pre></div><pre><code>0.9971648906146361
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cross_validation(ab_over,X_train,y_train,scoretype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;roc_auc&#34;</span>,folds <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>roc_curve(X_test,y_test,ab_over,<span style="color:#e6db74">&#34;Ada Boost Classifier&#34;</span>)
</span></span></code></pre></div><pre><code>roc-auc: 1.000 (+/- 0.00)
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_440_1.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize <span style="color:#f92672">=</span> (<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">7</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Model for Oversampled&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>y_pred_proba <span style="color:#f92672">=</span> logreg_over<span style="color:#f92672">.</span>predict_proba(X_test)[::,<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>fpr, tpr, _ <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>roc_curve(y_test,  y_pred_proba)
</span></span><span style="display:flex;"><span>auc <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>roc_auc_score(y_test, y_pred_proba)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(fpr,tpr,label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Model:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;Logistic Regression&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;(AUC=&#34;</span><span style="color:#f92672">+</span>str(auc)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;)&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>y_pred_proba <span style="color:#f92672">=</span> dtree_over<span style="color:#f92672">.</span>predict_proba(X_test)[::,<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>fpr, tpr, _ <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>roc_curve(y_test,  y_pred_proba)
</span></span><span style="display:flex;"><span>auc <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>roc_auc_score(y_test, y_pred_proba)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(fpr,tpr,label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Model:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;Decison Tree Oversampled&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;(AUC=&#34;</span><span style="color:#f92672">+</span>str(auc)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;)&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>y_pred_proba <span style="color:#f92672">=</span> rf_over<span style="color:#f92672">.</span>predict_proba(X_test)[::,<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>fpr, tpr, _ <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>roc_curve(y_test,  y_pred_proba)
</span></span><span style="display:flex;"><span>auc <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>roc_auc_score(y_test, y_pred_proba)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(fpr,tpr,label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Model:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;Random Forest Oversampled&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;(AUC=&#34;</span><span style="color:#f92672">+</span>str(auc)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;)&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>y_pred_proba <span style="color:#f92672">=</span> gbm_over<span style="color:#f92672">.</span>predict_proba(X_test)[::,<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>fpr, tpr, _ <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>roc_curve(y_test,  y_pred_proba)
</span></span><span style="display:flex;"><span>auc <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>roc_auc_score(y_test, y_pred_proba)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(fpr,tpr,label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Model:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;Gradient Boosting Oversampled&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;(AUC=&#34;</span><span style="color:#f92672">+</span>str(auc)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;)&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>y_pred_proba <span style="color:#f92672">=</span> ab_over<span style="color:#f92672">.</span>predict_proba(X_test)[::,<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>fpr, tpr, _ <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>roc_curve(y_test,  y_pred_proba)
</span></span><span style="display:flex;"><span>auc <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>roc_auc_score(y_test, y_pred_proba)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(fpr,tpr,label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Model:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;Ada Boost Oversampled&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;(AUC=&#34;</span><span style="color:#f92672">+</span>str(auc)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;)&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;True Positive Rate&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;False Positive Rate&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_441_0.png" alt="png"></p>
<h5 id="confusion-matrix">Confusion Matrix</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> confusion_matrix
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> classification_report
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> precision_score
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> recall_score
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cal_evaluation</span>(classifier, cm):
</span></span><span style="display:flex;"><span>    tn <span style="color:#f92672">=</span> cm[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    fp <span style="color:#f92672">=</span> cm[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    fn <span style="color:#f92672">=</span> cm[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    tp <span style="color:#f92672">=</span> cm[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    accuracy  <span style="color:#f92672">=</span> (tp <span style="color:#f92672">+</span> tn) <span style="color:#f92672">/</span> (tp <span style="color:#f92672">+</span> fp <span style="color:#f92672">+</span> fn <span style="color:#f92672">+</span> tn <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.0</span>)
</span></span><span style="display:flex;"><span>    precision <span style="color:#f92672">=</span> tp <span style="color:#f92672">/</span> (tp <span style="color:#f92672">+</span> fp <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.0</span>)
</span></span><span style="display:flex;"><span>    recall <span style="color:#f92672">=</span> tp <span style="color:#f92672">/</span> (tp <span style="color:#f92672">+</span> fn <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.0</span>)
</span></span><span style="display:flex;"><span>    print (classifier)
</span></span><span style="display:flex;"><span>    print (<span style="color:#e6db74">&#34;Accuracy is: </span><span style="color:#e6db74">%0.3f</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> accuracy)
</span></span><span style="display:flex;"><span>    print (<span style="color:#e6db74">&#34;precision is: </span><span style="color:#e6db74">%0.3f</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> precision)
</span></span><span style="display:flex;"><span>    print (<span style="color:#e6db74">&#34;recall is: </span><span style="color:#e6db74">%0.3f</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> recall)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">draw_confusion_matrices</span>(confusion_matricies):
</span></span><span style="display:flex;"><span>    class_names <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Not&#39;</span>,<span style="color:#e6db74">&#39;Churn&#39;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> cm <span style="color:#f92672">in</span> confusion_matrices:
</span></span><span style="display:flex;"><span>        classifier, cm <span style="color:#f92672">=</span> cm[<span style="color:#ae81ff">0</span>], cm[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        cal_evaluation(classifier, cm)
</span></span><span style="display:flex;"><span>        fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure()
</span></span><span style="display:flex;"><span>        ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>add_subplot(<span style="color:#ae81ff">111</span>)
</span></span><span style="display:flex;"><span>        cax <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>matshow(cm, interpolation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;nearest&#39;</span>,cmap<span style="color:#f92672">=</span>plt<span style="color:#f92672">.</span>get_cmap(<span style="color:#e6db74">&#39;Reds&#39;</span>))
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Confusion matrix for </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> classifier)
</span></span><span style="display:flex;"><span>        fig<span style="color:#f92672">.</span>colorbar(cax)
</span></span><span style="display:flex;"><span>        ax<span style="color:#f92672">.</span>set_xticklabels([<span style="color:#e6db74">&#39;&#39;</span>] <span style="color:#f92672">+</span> class_names)
</span></span><span style="display:flex;"><span>        ax<span style="color:#f92672">.</span>set_yticklabels([<span style="color:#e6db74">&#39;&#39;</span>] <span style="color:#f92672">+</span> class_names)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Predicted&#39;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;True&#39;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline
</span></span><span style="display:flex;"><span>confusion_matrices <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;Logistic Regression&#34;</span>, confusion_matrix(y_test,logreg_over<span style="color:#f92672">.</span>predict(X_test))),
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;Random Forest&#34;</span>, confusion_matrix(y_test,rf_over<span style="color:#f92672">.</span>predict(X_test))),
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;Decision Tree&#34;</span>, confusion_matrix(y_test,dtree_over<span style="color:#f92672">.</span>predict(X_test))),
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;Gradient Boosting&#34;</span>, confusion_matrix(y_test,gbm_over<span style="color:#f92672">.</span>predict(X_test))),
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;Ada Boost&#34;</span>, confusion_matrix(y_test,ab_over<span style="color:#f92672">.</span>predict(X_test))),
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>draw_confusion_matrices(confusion_matrices)
</span></span></code></pre></div><pre><code>Logistic Regression
Accuracy is: 0.997
precision is: 1.000
recall is: 0.997
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_444_1.png" alt="png"></p>
<pre><code>Random Forest
Accuracy is: 0.997
precision is: 1.000
recall is: 0.997
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_444_3.png" alt="png"></p>
<pre><code>Decision Tree
Accuracy is: 0.996
precision is: 0.997
recall is: 0.997
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_444_5.png" alt="png"></p>
<pre><code>Gradient Boosting
Accuracy is: 0.997
precision is: 1.000
recall is: 0.997
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_444_7.png" alt="png"></p>
<pre><code>Ada Boost
Accuracy is: 0.997
precision is: 0.999
recall is: 0.997
</code></pre>
<p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_444_9.png" alt="png"></p>
<h4 id="model-selection">Model Selection</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>mod <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#34;Model&#34;</span>:[<span style="color:#e6db74">&#39;Logistic Regression Imbalance&#39;</span>,<span style="color:#e6db74">&#39;Logistic Regression Oversampled&#39;</span>, 
</span></span><span style="display:flex;"><span>                             <span style="color:#e6db74">&#39;Decision Tree Imbalance&#39;</span>, <span style="color:#e6db74">&#39;Decision Tree Oversampled&#39;</span>, 
</span></span><span style="display:flex;"><span>                             <span style="color:#e6db74">&#39;Random Forest Imbalance&#39;</span>, <span style="color:#e6db74">&#39;Random Forest Oversampled&#39;</span>,
</span></span><span style="display:flex;"><span>                             <span style="color:#e6db74">&#39;Gradient Boosting Imbalance&#39;</span>, <span style="color:#e6db74">&#39;Gradient Boosting Oversampled&#39;</span>,
</span></span><span style="display:flex;"><span>                             <span style="color:#e6db74">&#39;Ada Boost Imbalance&#39;</span>, <span style="color:#e6db74">&#39;Ada Boost Oversampled&#39;</span>],
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#34;Accuracy&#34;</span>:[imb_logreg, os_logreg, imb_rf, os_rf,
</span></span><span style="display:flex;"><span>                                     imb_dtree, os_dtree, imb_gbm, os_gbm,
</span></span><span style="display:flex;"><span>                                     imb_ab, os_ab]
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                   )
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>mod
</span></span></code></pre></div>  <div id="df-626f5ca0-fd01-4aa5-8db9-2de81bc7c913">
    <div class="colab-df-container">
      <div style="overflow-x:auto;">
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Logistic Regression Imbalance</td>
      <td>0.998394</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Logistic Regression Oversampled</td>
      <td>0.998394</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Decision Tree Imbalance</td>
      <td>0.998394</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Decision Tree Oversampled</td>
      <td>0.998394</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Random Forest Imbalance</td>
      <td>0.992098</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Random Forest Oversampled</td>
      <td>0.993000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Gradient Boosting Imbalance</td>
      <td>0.998394</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Gradient Boosting Oversampled</td>
      <td>0.998417</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Ada Boost Imbalance</td>
      <td>0.997397</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Ada Boost Oversampled</td>
      <td>0.997165</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-626f5ca0-fd01-4aa5-8db9-2de81bc7c913')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
<p>&lt;svg xmlns=&ldquo;<a href="http://www.w3.org/2000/svg%22">http://www.w3.org/2000/svg&quot;</a> height=&ldquo;24px&quot;viewBox=&ldquo;0 0 24 24&rdquo;
width=&ldquo;24px&rdquo;&gt;
<path d="M0 0h24v24H0V0z" fill="none"/>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
</svg>
</button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector('#df-626f5ca0-fd01-4aa5-8db9-2de81bc7c913 button.colab-df-convert');
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? 'block' : 'none';

    async function convertToInteractive(key) {
      const element = document.querySelector('#df-626f5ca0-fd01-4aa5-8db9-2de81bc7c913');
      const dataTable =
        await google.colab.kernel.invokeFunction('convertToInteractive',
                                                 [key], {});
      if (!dataTable) return;

      const docLinkHtml = 'Like what you see? Visit the ' +
        '&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;'
        + ' to learn more about interactive tables.';
      element.innerHTML = '';
      dataTable['output_type'] = 'display_data';
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement('div');
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    }
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>barplot(data<span style="color:#f92672">=</span>mod<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Accuracy&#39;</span>, ascending<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>), x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Accuracy&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Model&#34;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>bar_label(ax<span style="color:#f92672">.</span>containers[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_448_0.png" alt="png"></p>
<p>Berdasarkan nilai akurasi, akan say pilih 2 algoritma dengan kurasi teratas, yakni Logistic Regression dan Decision Tree.</p>
<h4 id="hyper-tuning-parameters">Hyper-tuning parameters</h4>
<p>There are two ways to hyper tune parameters:</p>
<ol>
<li>Grid Search (takes too much time - will try every combination of parameters provided)</li>
<li>Random Search (takes less time - will try random combinations)</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>param_grid <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;max_features&#39;</span>: [<span style="color:#e6db74">&#39;auto&#39;</span>, <span style="color:#e6db74">&#39;sqrt&#39;</span>, <span style="color:#e6db74">&#39;log2&#39;</span>],
</span></span><span style="display:flex;"><span>              <span style="color:#e6db74">&#39;ccp_alpha&#39;</span>: [<span style="color:#ae81ff">0.1</span>, <span style="color:#ae81ff">.01</span>, <span style="color:#ae81ff">.001</span>],
</span></span><span style="display:flex;"><span>              <span style="color:#e6db74">&#39;max_depth&#39;</span> : [<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>],
</span></span><span style="display:flex;"><span>              <span style="color:#e6db74">&#39;criterion&#39;</span> :[<span style="color:#e6db74">&#39;gini&#39;</span>, <span style="color:#e6db74">&#39;entropy&#39;</span>]
</span></span><span style="display:flex;"><span>             }
</span></span><span style="display:flex;"><span>tree_clas <span style="color:#f92672">=</span> DecisionTreeClassifier(random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>grid_search <span style="color:#f92672">=</span> GridSearchCV(estimator<span style="color:#f92672">=</span>tree_clas, param_grid<span style="color:#f92672">=</span>param_grid, cv<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, verbose<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>grid_search<span style="color:#f92672">.</span>fit(X_train_over,y_train_over)
</span></span></code></pre></div><pre><code>Fitting 5 folds for each of 90 candidates, totalling 450 fits





GridSearchCV(cv=5, estimator=DecisionTreeClassifier(random_state=1024),
             param_grid={'ccp_alpha': [0.1, 0.01, 0.001],
                         'criterion': ['gini', 'entropy'],
                         'max_depth': [5, 6, 7, 8, 9],
                         'max_features': ['auto', 'sqrt', 'log2']},
             verbose=True)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(grid_search<span style="color:#f92672">.</span>best_params_, grid_search<span style="color:#f92672">.</span>best_score_)
</span></span></code></pre></div><pre><code>{'ccp_alpha': 0.001, 'criterion': 'entropy', 'max_depth': 7, 'max_features': 'log2'} 0.9742969689210923
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>final_model <span style="color:#f92672">=</span> grid_search<span style="color:#f92672">.</span>best_estimator_
</span></span><span style="display:flex;"><span>final_model
</span></span></code></pre></div><pre><code>DecisionTreeClassifier(ccp_alpha=0.001, criterion='entropy', max_depth=7,
                       max_features='log2', random_state=1024)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>tuned_tree <span style="color:#f92672">=</span> DecisionTreeClassifier(ccp_alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.001</span>, criterion<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;entropy&#39;</span>, max_depth<span style="color:#f92672">=</span><span style="color:#ae81ff">9</span>,
</span></span><span style="display:flex;"><span>                       max_features<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;auto&#39;</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>tuned_tree<span style="color:#f92672">.</span>fit(X_train_over, y_train_over)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># y_predict = tuned_tree.predict(X_test)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># roc_curve(X_test,y_test,tuned_tree,&#34;Tuned Decision Tree Classifier&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># cross_validation(ab,X_train,y_train,scoretype = &#34;roc_auc&#34;,folds = 10)</span>
</span></span><span style="display:flex;"><span>roc_curve(X_test,y_test,tuned_tree,<span style="color:#e6db74">&#34;Tuned Decision Tree&#34;</span>)
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_454_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dtree <span style="color:#f92672">=</span> DecisionTreeClassifier(random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>dtree<span style="color:#f92672">.</span>fit(X, y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>importances <span style="color:#f92672">=</span> dtree<span style="color:#f92672">.</span>feature_importances_
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Print the feature ranking</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Feature importance ranking by Decision tree Model:&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> k,v <span style="color:#f92672">in</span> sorted(zip(map(<span style="color:#66d9ef">lambda</span> x: round(x, <span style="color:#ae81ff">4</span>), importances), ready<span style="color:#f92672">.</span>columns), reverse<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>):
</span></span><span style="display:flex;"><span>    print(v <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;: &#34;</span> <span style="color:#f92672">+</span> str(k))
</span></span></code></pre></div><pre><code>Feature importance ranking by Decision tree Model:
R: 0.9823
avg_freight_value: 0.0022
avg_estimated_delivery_delta: 0.0017
avg_approved_purchase_delta: 0.0015
avg_review_ans_delta: 0.0013
avg_product_weight_g: 0.0011
avg_product_volume: 0.0011
avg_shipping_length: 0.001
avg_product_desc_length: 0.001
avg_delivery_time: 0.001
Frequency: 0.001
avg_shipping_limit_carrier_delta: 0.0009
avg_payment_value: 0.0009
avg_del_carrier_approved_delta: 0.0008
avg_price: 0.0007
avg_product_photos_qty: 0.0006
avg_review_score: 0.0002
trans_age: 0.0001
payment_debit_card: 0.0001
payment_boleto: 0.0001
Monetary: 0.0001
M: 0.0001
F: 0.0001
product_quantity: 0.0
payment_credit_card: 0.0
Recency: 0.0
K_Cluster: 0.0
</code></pre>
<h4 id="result">Result</h4>
<p>Untuk memprediksi pada testing, saya akan menggunakan decision tree</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>predictions <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame()
</span></span><span style="display:flex;"><span>predictions[<span style="color:#e6db74">&#39;true&#39;</span>] <span style="color:#f92672">=</span> y_train
</span></span><span style="display:flex;"><span>predictions[<span style="color:#e6db74">&#39;preds&#39;</span>] <span style="color:#f92672">=</span> dtree<span style="color:#f92672">.</span>predict(X_train)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>predictions_test <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame()
</span></span><span style="display:flex;"><span>predictions_test[<span style="color:#e6db74">&#39;true&#39;</span>] <span style="color:#f92672">=</span> y_test
</span></span><span style="display:flex;"><span>predictions_test[<span style="color:#e6db74">&#39;preds&#39;</span>] <span style="color:#f92672">=</span> dtree<span style="color:#f92672">.</span>predict(X_test)
</span></span><span style="display:flex;"><span>predictions_test[<span style="color:#e6db74">&#39;preds_over&#39;</span>] <span style="color:#f92672">=</span> dtree_over<span style="color:#f92672">.</span>predict(X_test)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> classification_report, accuracy_score
</span></span><span style="display:flex;"><span>train_acc <span style="color:#f92672">=</span> accuracy_score(predictions<span style="color:#f92672">.</span>true, predictions<span style="color:#f92672">.</span>preds)
</span></span><span style="display:flex;"><span>test_acc <span style="color:#f92672">=</span> accuracy_score(predictions_test<span style="color:#f92672">.</span>true, predictions_test<span style="color:#f92672">.</span>preds)
</span></span><span style="display:flex;"><span>test_acc_over <span style="color:#f92672">=</span> accuracy_score(predictions_test<span style="color:#f92672">.</span>true, predictions_test<span style="color:#f92672">.</span>preds_over)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Train Acc: </span><span style="color:#e6db74">{</span>train_acc<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, Test Acc: </span><span style="color:#e6db74">{</span>test_acc<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, Test Acc Oversampled: </span><span style="color:#e6db74">{</span>test_acc_over<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><pre><code>Train Acc: 1.0000, Test Acc: 0.9953, Test Acc Oversampled: 0.9956
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(classification_report(predictions<span style="color:#f92672">.</span>true, predictions<span style="color:#f92672">.</span>preds))
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00     12702
           1       1.00      1.00      1.00     51491

    accuracy                           1.00     64193
   macro avg       1.00      1.00      1.00     64193
weighted avg       1.00      1.00      1.00     64193
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(classification_report(predictions_test<span style="color:#f92672">.</span>true, predictions_test<span style="color:#f92672">.</span>preds))
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.99      0.99      0.99      5405
           1       1.00      1.00      1.00     22107

    accuracy                           1.00     27512
   macro avg       0.99      0.99      0.99     27512
weighted avg       1.00      1.00      1.00     27512
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(classification_report(predictions_test<span style="color:#f92672">.</span>true, predictions_test<span style="color:#f92672">.</span>preds_over))
</span></span></code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.99      0.99      0.99      5405
           1       1.00      1.00      1.00     22107

    accuracy                           1.00     27512
   macro avg       0.99      0.99      0.99     27512
weighted avg       1.00      1.00      1.00     27512
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>probs <span style="color:#f92672">=</span> dtree_over<span style="color:#f92672">.</span>predict_proba(X_test)[:, <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>probs
</span></span></code></pre></div><pre><code>array([1., 0., 1., ..., 0., 0., 0.])
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> matplotlib.pyplot <span style="color:#f92672">import</span> figure
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hist(probs, bins <span style="color:#f92672">=</span> int(<span style="color:#ae81ff">180</span><span style="color:#f92672">/</span><span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>distplot(probs, hist<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, kde<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, 
</span></span><span style="display:flex;"><span>             bins<span style="color:#f92672">=</span>int(<span style="color:#ae81ff">180</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span>), color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;blue&#39;</span>,
</span></span><span style="display:flex;"><span>             hist_kws<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;edgecolor&#39;</span>:<span style="color:#e6db74">&#39;black&#39;</span>})
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Probability Distribution of Churn Risk&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Churn Risk&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;# Customers&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="_05_003_AdityaBagusPratama_files/_05_003_AdityaBagusPratama_465_0.png" alt="png"></p>
<p>Dapat kita ketahui bahwa probabilitas pelanggan churn jauh lebih tinggi daripada pelanggan yang tidak churn.</p>

    </div>
    <nav class="flex flex-row justify-end gap-4 items-center">
      <span
        class="inline-flex text-base italic p-1 justify-center items-center text-slate-600 dark:text-slate-100"
        >share to :
      </span>
      <a
        class="inline-flex p-1 justify-center items-center rounded-full text-slate-600 dark:text-slate-100 hover:bg-slate-200 dark:hover:bg-slate-50/25 active:scale-95 transition-all"
        aria-label="Share to Facebook"
        href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fbytadit.me%2fprojects%2folist-churn-prediction%2f"
        target="_blank"
        rel="noopener"
      >
        <svg
          class="h-6 w-6"
          viewBox="0 0 24 24"
          fill="currentcolor"
          xmlns="http://www.w3.org/2000/svg"
        >
          <title>Share to Facebook</title>
          <path
            d="M24 12C24 5.37187 18.6281.0 12 0 5.37187.0.0 5.37187.0 12c0 6.6281 5.37187 12 12 12C12.0703 24 12.1406 24 12.2109 23.9953V14.6578H9.63281V11.6531H12.2109V9.44063c0-2.56407 1.5657-3.96094 3.8532-3.96094 1.0968.0 2.039.0796900000000003 2.3109.11719V8.27812H16.8C15.5578 8.27812 15.3141 8.86875 15.3141 9.73594V11.6484h2.9765L17.9016 14.6531H15.3141v8.8828C20.3297 22.0969 24 17.4797 24 12z"
            fill="currentcolor"
          ></path>
        </svg>
      </a>
      <a
        class="inline-flex p-1 justify-center items-center rounded-full text-slate-600 dark:text-slate-100 hover:bg-slate-200 dark:hover:bg-slate-50/25 active:scale-95 transition-all"
        aria-label="Share to Twitter"
        href="http://twitter.com/intent/tweet?text=Olist%20Churn%20Prediction&url=https%3a%2f%2fbytadit.me%2fprojects%2folist-churn-prediction%2f"
        target="_blank"
        rel="noopener"
      >
        <svg
          class="h-6 w-6"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <title>Share to Twitter</title>
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M0 12C0 5.3736 5.3736.0 12 0S24 5.3736 24 12 18.6264 24 12 24 0 18.6264.0 12zM17.4869 9.71228C17.4869 9.59308 17.4844 9.47443 17.4791 9.35632 18.0168 8.96759 18.4843 8.48236 18.8529 7.92993 18.3594 8.14929 17.8284 8.29706 17.2712 8.36371 17.84 8.02258 18.2765 7.48315 18.4825 6.84027 17.9502 7.15576 17.361 7.38501 16.7335 7.50879 16.2308 6.97339 15.5153 6.63849 14.723 6.63849c-1.5211.0-2.7547 1.23358-2.7547 2.75409C11.9683 9.60864 11.9927 9.81885 12.0399 10.0206 9.75073 9.90546 7.72083 8.80939 6.36255 7.14276c-.23657.40704-.37299.87982-.37299 1.38446C5.98956 9.48285 6.47571 10.3264 7.21527 10.8199 6.76337 10.806 6.33893 10.6818 5.96777 10.4755 5.96741 10.487 5.96741 10.4982 5.96741 10.5106c0 1.3338.9494 2.4476 2.20971 2.6999C7.94568 13.2737 7.70215 13.3076 7.45074 13.3076 7.27368 13.3076 7.10101 13.29 6.93311 13.2578c.35083 1.0944 1.36743 1.8907 2.57318 1.913C8.56348 15.9097 7.37585 16.3499 6.08533 16.3499 5.86322 16.3499 5.64386 16.3372 5.42834 16.3118 6.64728 17.0931 8.09473 17.549 9.65021 17.549 14.7166 17.5488 17.4869 13.3519 17.4869 9.71228z"
            fill="currentcolor"
          ></path>
        </svg>
      </a>
      <a
        class="inline-flex p-1 justify-center items-center rounded-full text-slate-600 dark:text-slate-100 hover:bg-slate-200 dark:hover:bg-slate-50/25 active:scale-95 transition-all"
        aria-label="Share to LinkedIn"
        href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fbytadit.me%2fprojects%2folist-churn-prediction%2f&title=&summary=&source="
        target="_blank"
        rel="noopener"
      >
        <svg
          class="h-6 w-6"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <title>Share to Linkedin</title>
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M0 12C0 5.3736 5.3736.0 12 0S24 5.3736 24 12 18.6264 24 12 24 0 18.6264.0 12zm5.59039 6.1406H8.51294V9.34808H5.59039V18.1406zM7.05176 8.14746H7.03271C6.052 8.14746 5.41772 7.47235 5.41772 6.6286c0-.86279.65369-1.51922 1.65345-1.51922C8.07092 5.10938 8.68616 5.76581 8.7052 6.6286c0 .84375-.63428 1.51886-1.65344 1.51886zM16.1288 18.1406H19.051V13.099c0-2.7006-1.4417-3.95728-3.3645-3.95728C14.1359 9.14172 13.441 9.9939 13.0527 10.593V9.34808H10.1303C10.1686 10.173 10.1303 18.1406 10.1303 18.1406h2.9224V13.2305C13.0527 12.9677 13.0715 12.7051 13.1488 12.5173c.2113-.525.6921-1.0688 1.4995-1.0688 1.0574.0 1.4805.806200000000001 1.4805 1.9883v4.7038z"
            fill="currentcolor"
          ></path>
        </svg>
      </a>
    </nav>
  </article>
</div>

  </main><footer class="p-4 bg-white md:px-6 md:py-6 mt-4 dark:bg-stone-800">
  <div class="items-center justify-between">
    <div class="flex mt-4 space-x-6 justify-center sm:mt-0">
      <a
        href="https://github.com/bytadit/"
        target="_blank"
        class="text-gray-800 dark:text-gray-400 dark:hover:text-white"
      >
        <svg
          class="w-6 h-6"
          fill="currentColor"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path
            fill-rule="evenodd"
            d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"
            clip-rule="evenodd"
          />
        </svg>
      </a>
      <a
        href="https://id.linkedin.com/in/aditya-bagus-pratama"
        target="_blank"
        class="text-blue-700 dark:hover:text-white"
      >
        <svg
          class="w-6 h-6"
          fill="currentColor"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 448 512"
        >
          <path
            d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"
          ></path>
        </svg>
      </a>
      <a
        href="https://twitter.com/bytadit/"
        target="_blank"
        class="text-blue-500 dark:hover:text-white"
      >
        <svg
          class="w-6 h-6"
          fill="currentColor"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path
            d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"
          />
        </svg>
      </a>
      <a
        href="https://kaggle.com/bytadit/"
        target="_blank"
        class="text-blue-700 dark:hover:text-white"
      >
        <svg
          class="w-6 h-6"
          fill="currentColor"
          viewBox="0 62 320 512"
          aria-hidden="true"
        >
          
          <path
            d="M304.2 501.5L158.4 320.3 298.2 185c2.6-2.7 1.7-10.5-5.3-10.5h-69.2c-3.5 0-7 1.8-10.5 5.3L80.9 313.5V7.5q0-7.5-7.5-7.5H21.5Q14 0 14 7.5v497q0 7.5 7.5 7.5h51.9q7.5 0 7.5-7.5v-109l30.8-29.3 110.5 140.6c3 3.5 6.5 5.3 10.5 5.3h66.9q5.25 0 6-3z"
          ></path>
        </svg>
      </a>
    </div>
  </div>
  <span class="mt-6 block text-sm text-gray-500 text-center dark:text-gray-400"
    >© 2023
    <a href="https://bytadit.me/" class="hover:underline">Bytadit</a>
  </span>
</footer>
<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
  crossorigin="anonymous"
></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>


<script src="https://unpkg.com/flowbite@1.4.7/dist/flowbite.js"></script>

<script>
  var themeToggleDarkIcon = document.getElementById("theme-toggle-dark-icon");
  var themeToggleLightIcon = document.getElementById("theme-toggle-light-icon");
  
  if (
    localStorage.getItem("color-theme") === "dark" ||
    (!("color-theme" in localStorage) &&
      window.matchMedia("(prefers-color-scheme: dark)").matches)
  ) {
    themeToggleLightIcon.classList.remove("hidden");
  } else {
    themeToggleDarkIcon.classList.remove("hidden");
  }

  var themeToggleBtn = document.getElementById("theme-toggle");
  themeToggleBtn.addEventListener("click", function () {
    
    themeToggleDarkIcon.classList.toggle("hidden");
    themeToggleLightIcon.classList.toggle("hidden");

    
    if (localStorage.getItem("color-theme")) {
      if (localStorage.getItem("color-theme") === "light") {
        document.documentElement.classList.add("dark");
        localStorage.setItem("color-theme", "dark");
      } else {
        document.documentElement.classList.remove("dark");
        localStorage.setItem("color-theme", "light");
      }

      
    } else {
      if (document.documentElement.classList.contains("dark")) {
        document.documentElement.classList.remove("dark");
        localStorage.setItem("color-theme", "light");
      } else {
        document.documentElement.classList.add("dark");
        localStorage.setItem("color-theme", "dark");
      }
    }
  });
</script>

<script>
  window.onload = function () {
    var el = document.getElementById("g-recaptcha-response");
    if (el) {
      el.setAttribute("required", "required");
    }
  };
</script>

<script>
  

  

  (function () {
    
    var d = document,
      s = d.createElement("script");
    s.src = "https://bytadit.disqus.com/embed.js";
    s.setAttribute("data-timestamp", +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>

  </body>
</html>
